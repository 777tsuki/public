var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function l(){return Object.create(null)}function a(e){e.forEach(n)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let i;function c(e,t){return i||(i=document.createElement("a")),i.href=t,e===i.href}function d(t,n,l){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const l=t.subscribe(...n);return l.unsubscribe?()=>l.unsubscribe():l}(n,l))}function u(e){return null==e?"":e}function f(e,t,n){return e.set(n),t}const m="undefined"!=typeof window;let h=m?()=>window.performance.now():()=>Date.now(),p=m?e=>requestAnimationFrame(e):e;const g=new Set;function y(e){g.forEach((t=>{t.c(e)||(g.delete(t),t.f())})),0!==g.size&&p(y)}function v(e){let t;return 0===g.size&&p(y),{promise:new Promise((n=>{g.add(t={c:e,f:n})})),abort(){g.delete(t)}}}function b(e,t){e.appendChild(t)}function k(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function _(e){const t=j("style");return function(e,t){b(e.head||e,t),t.sheet}(k(e),t),t.sheet}function x(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode&&e.parentNode.removeChild(e)}function $(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function j(e){return document.createElement(e)}function O(e){return document.createTextNode(e)}function T(){return O(" ")}function M(){return O("")}function C(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function A(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function E(e,t){t=""+t,e.data!==t&&(e.data=t)}function H(e,t,n,l){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,l?"important":"")}function q(e,t){return new e(t)}const L=new Map;let z,S=0;function I(e,t,n,l,a,o,r,s=0){const i=16.666/l;let c="{\n";for(let e=0;e<=1;e+=i){const l=t+(n-t)*o(e);c+=100*e+`%{${r(l,1-l)}}\n`}const d=c+`100% {${r(n,1-n)}}\n}`,u=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(d)}_${s}`,f=k(e),{stylesheet:m,rules:h}=L.get(f)||function(e,t){const n={stylesheet:_(t),rules:{}};return L.set(e,n),n}(f,e);h[u]||(h[u]=!0,m.insertRule(`@keyframes ${u} ${d}`,m.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${u} ${l}ms linear ${a}ms 1 both`,S+=1,u}function R(e,t){const n=(e.style.animation||"").split(", "),l=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),a=n.length-l.length;a&&(e.style.animation=l.join(", "),S-=a,S||p((()=>{S||(L.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&w(t)})),L.clear())})))}function B(e){z=e}function P(){if(!z)throw new Error("Function called outside component initialization");return z}function N(e){P().$$.before_update.push(e)}function K(e){P().$$.on_mount.push(e)}function D(e){P().$$.after_update.push(e)}const F=[],Y=[];let X=[];const G=[],J=Promise.resolve();let W=!1;function Z(e){X.push(e)}const U=new Set;let Q,V=0;function ee(){if(0!==V)return;const e=z;do{try{for(;V<F.length;){const e=F[V];V++,B(e),te(e.$$)}}catch(e){throw F.length=0,V=0,e}for(B(null),F.length=0,V=0;Y.length;)Y.pop()();for(let e=0;e<X.length;e+=1){const t=X[e];U.has(t)||(U.add(t),t())}X.length=0}while(F.length);for(;G.length;)G.pop()();W=!1,U.clear(),B(e)}function te(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Z)}}function ne(){return Q||(Q=Promise.resolve(),Q.then((()=>{Q=null}))),Q}function le(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,n,l,t),a}(`${t?"intro":"outro"}${n}`))}const ae=new Set;let oe;function re(){oe={r:0,c:[],p:oe}}function se(){oe.r||a(oe.c),oe=oe.p}function ie(e,t){e&&e.i&&(ae.delete(e),e.i(t))}function ce(e,t,n,l){if(e&&e.o){if(ae.has(e))return;ae.add(e),oe.c.push((()=>{ae.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}else l&&l()}const de={duration:0};function ue(n,l,a){const r={direction:"in"};let s,i,c=l(n,a,r),d=!1,u=0;function f(){s&&R(n,s)}function m(){const{delay:l=0,duration:a=300,easing:o=t,tick:r=e,css:m}=c||de;m&&(s=I(n,0,1,a,l,o,m,u++)),r(0,1);const p=h()+l,g=p+a;i&&i.abort(),d=!0,Z((()=>le(n,!0,"start"))),i=v((e=>{if(d){if(e>=g)return r(1,0),le(n,!0,"end"),f(),d=!1;if(e>=p){const t=o((e-p)/a);r(t,1-t)}}return d}))}let p=!1;return{start(){p||(p=!0,R(n),o(c)?(c=c(r),ne().then(m)):m())},invalidate(){p=!1},end(){d&&(f(),d=!1)}}}function fe(n,l,r){const s={direction:"out"};let i,c=l(n,r,s),d=!0;const u=oe;function f(){const{delay:l=0,duration:o=300,easing:r=t,tick:s=e,css:f}=c||de;f&&(i=I(n,1,0,o,l,r,f));const m=h()+l,p=m+o;Z((()=>le(n,!1,"start"))),v((e=>{if(d){if(e>=p)return s(0,1),le(n,!1,"end"),--u.r||a(u.c),!1;if(e>=m){const t=r((e-m)/o);s(1-t,t)}}return d}))}return u.r+=1,o(c)?ne().then((()=>{c=c(s),f()})):f(),{end(e){e&&c.tick&&c.tick(1,0),d&&(i&&R(n,i),d=!1)}}}function me(e,t){e.d(1),t.delete(e.key)}function he(e,t){ce(e,1,1,(()=>{t.delete(e.key)}))}function pe(e,t,n,l,o,r,s,i,c,d,u,f){let m=e.length,h=r.length,p=m;const g={};for(;p--;)g[e[p].key]=p;const y=[],v=new Map,b=new Map,k=[];for(p=h;p--;){const e=f(o,r,p),a=n(e);let i=s.get(a);i?l&&k.push((()=>i.p(e,t))):(i=d(a,e),i.c()),v.set(a,y[p]=i),a in g&&b.set(a,Math.abs(p-g[a]))}const _=new Set,x=new Set;function w(e){ie(e,1),e.m(i,u),s.set(e.key,e),u=e.first,h--}for(;m&&h;){const t=y[h-1],n=e[m-1],l=t.key,a=n.key;t===n?(u=t.first,m--,h--):v.has(a)?!s.has(l)||_.has(l)?w(t):x.has(a)?m--:b.get(l)>b.get(a)?(x.add(l),w(t)):(_.add(a),m--):(c(n,s),m--)}for(;m--;){const t=e[m];v.has(t.key)||c(t,s)}for(;h;)w(y[h-1]);return a(k),y}function ge(e){e&&e.c()}function ye(e,t,l,r){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,l),r||Z((()=>{const t=e.$$.on_mount.map(n).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):a(t),e.$$.on_mount=[]})),i.forEach(Z)}function ve(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];X.forEach((l=>-1===e.indexOf(l)?t.push(l):n.push(l))),n.forEach((e=>e())),X=t}(n.after_update),a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function be(e,t){-1===e.$$.dirty[0]&&(F.push(e),W||(W=!0,J.then(ee)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ke(t,n,o,r,s,i,c,d=[-1]){const u=z;B(t);const f=t.$$={fragment:null,ctx:[],props:i,update:e,not_equal:s,bound:l(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(u?u.$$.context:[])),callbacks:l(),dirty:d,skip_bound:!1,root:n.target||u.$$.root};c&&c(f.root);let m=!1;if(f.ctx=o?o(t,n.props||{},((e,n,...l)=>{const a=l.length?l[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=a)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](a),m&&be(t,e)),n})):[],f.update(),m=!0,a(f.before_update),f.fragment=!!r&&r(f.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);f.fragment&&f.fragment.l(e),e.forEach(w)}else f.fragment&&f.fragment.c();n.intro&&ie(t.$$.fragment),ye(t,n.target,n.anchor,n.customElement),ee()}B(u)}class _e{$destroy(){ve(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const e=l.indexOf(n);-1!==e&&l.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function xe(e){const t=e-1;return t*t*t+1}function we(e,{delay:n=0,duration:l=400,easing:a=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:l,easing:a,css:e=>"opacity: "+e*o}}function $e(e,{delay:t=0,duration:n=400,easing:l=xe,start:a=0,opacity:o=0}={}){const r=getComputedStyle(e),s=+r.opacity,i="none"===r.transform?"":r.transform,c=1-a,d=s*(1-o);return{delay:t,duration:n,easing:l,css:(e,t)=>`\n\t\t\ttransform: ${i} scale(${1-c*t});\n\t\t\topacity: ${s-d*t}\n\t\t`}}const je=[];function Oe(t,n=e){let l;const a=new Set;function o(e){if(s(t,e)&&(t=e,l)){const e=!je.length;for(const e of a)e[1](),je.push(e,t);if(e){for(let e=0;e<je.length;e+=2)je[e][0](je[e+1]);je.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(r,s=e){const i=[r,s];return a.add(i),1===a.size&&(l=n(o)||e),r(t),()=>{a.delete(i),0===a.size&&l&&(l(),l=null)}}}}const Te=Oe("Index"),Me=Oe(!1),Ce=Oe({unlocked:{role:["marisa","reimu"]},record:[]}),Ae=Oe({collection:{frozen_frog:10,fluorescent_zanthoxylum:20,conch_shell:5,false_hammer:10,ice_scale:10,sakura_tea:10,big_bugle:10,vampires_old_tooth:12,seal_needle:5,red_and_white_scarf:1,bottle_of_stars:1,shimenawa:40},equipment:"mini_bagua_stove",consumable:{banana:3,heart_fire_of_grace:2,good_corn:1},card:{r037:1,r029:1,reimu:1},souvenir:!1,role:"reimu",sugar:5,consumableLimit:3,chance:{name:"轻松",type:"red",amount:1},health:40,coin:6e3,scene:"town",stage:1,blackList:[],statistics:[],coin_reward_total:0}),Ee=Oe({resource:"dairi"}),He=Oe({enermy:["sunny"],cursor:[0,0,0],offsetY:[1,0,0],event:[{key:"diaochuang",cache:{finish:!0},id:0,style:"transform:rotate(6.341882895824243deg)translate(1.3071317727794085px,-4.794430534179739px);",detail:"看起来摇摇晃晃的，想必是非常新奇的体验。",type:"reward"},{key:"xijian",cache:{},id:1,style:"transform:rotate(6.341882895824243deg)translate(1.3071317727794085px,-4.794430534179739px);",detail:"看起来摇摇晃晃的，想必是非常新奇的体验。",type:"reward"}],eventList:[[{key:"diaochuang",cache:{finish:!0},id:0,style:"transform:rotate(6.341882895824243deg)translate(1.3071317727794085px,-4.794430534179739px);",detail:"看起来摇摇晃晃的，想必是非常新奇的体验。",type:"reward"},{key:"xijian",cache:{},id:1,style:"transform:rotate(6.341882895824243deg)translate(1.3071317727794085px,-4.794430534179739px);",detail:"看起来摇摇晃晃的，想必是非常新奇的体验。",type:"reward"}],[],[]],eventSummoned:!1,eventLeft:[],target:[!0,!0,!0,!0,!1,!1],enermyLimit:4,lv:20,pricelv:1,dragon:0,boss:["kanako","medicine","mokou"]}),qe=Oe({}),Le=Oe({}),ze=Oe({event:{}});function Se(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Ie(e,t){let n,l,a,o,r,s,i,d,u,f,m,h,p,g,y,v,k,_,$=(t[4].title?t[4].title:"提示")+"",M=t[4].content+"";function q(...e){return t[1](t[6],...e)}return{key:e,first:null,c(){n=j("div"),l=j("img"),o=T(),r=j("div"),s=j("txt"),i=O($),d=T(),u=j("txt"),f=O(M),m=T(),h=j("div"),p=T(),c(l.src,a="/logo.svg")||A(l,"src","/logo.svg"),A(l,"class","svelte-1pr8won"),A(s,"class","title svelte-1pr8won"),A(u,"class","content svelte-1pr8won"),H(r,"margin-bottom","4px"),A(h,"class","tie svelte-1pr8won"),A(n,"class","svelte-1pr8won"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),b(n,r),b(r,s),b(s,i),b(r,d),b(r,u),b(u,f),b(n,m),b(n,h),b(n,p),v=!0,k||(_=C(n,"click",q),k=!0)},p(e,n){t=e,(!v||1&n)&&$!==($=(t[4].title?t[4].title:"提示")+"")&&E(i,$),(!v||1&n)&&M!==(M=t[4].content+"")&&E(f,M)},i(e){v||(Z((()=>{v&&(y&&y.end(1),g=ue(n,$e,{duration:300}),g.start())})),v=!0)},o(e){g&&g.invalidate(),y=fe(n,we,{duration:300}),v=!1},d(e){e&&w(n),e&&y&&y.end(),k=!1,_()}}}function Re(e){let t,n,l=[],a=new Map,o=e[0];const r=e=>e[4].key;for(let t=0;t<o.length;t+=1){let n=Se(e,o,t),s=r(n);a.set(s,l[t]=Ie(s,n))}return{c(){t=j("div");for(let e=0;e<l.length;e+=1)l[e].c();A(t,"class","msg svelte-1pr8won")},m(e,a){x(e,t,a);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);n=!0},p(e,[n]){1&n&&(o=e[0],re(),l=pe(l,n,r,1,e,o,a,t,he,Ie,null,Se),se())},i(e){if(!n){for(let e=0;e<o.length;e+=1)ie(l[e]);n=!0}},o(e){for(let e=0;e<l.length;e+=1)ce(l[e]);n=!1},d(e){e&&w(t);for(let e=0;e<l.length;e+=1)l[e].d()}}}function Be(e,t,n){let l;d(e,Le,(e=>n(2,l=e)));let a=[];window.msg=function(e){e.time=(new Date).getTime(),e.key=Math.random(),a.push(e),n(0,a=a.filter((t=>e.time-t.time<3e3)))},K((function(){l.add("msg",(e=>n(0,a=a.filter((e=>(new Date).getTime()-e.time<3e3)))),1)}));return[a,(e,t)=>n(0,a=a.filter(((t,n)=>e!=n)))]}class Pe extends _e{constructor(e){super(),ke(this,e,Be,Re,s,{})}}var Ne={portable_money_box:{name:"便携式赛钱箱",detail:"每持有250硬币，对敌人造成伤害提高5%(每层+5%)。",type:"blue"},bronze_mirror:{name:"铜镜",detail:"对敌人造成伤害时，25%概率额外对随机其它敌人造成伤害30%(每层+30%)的间接伤害。无法循环触发。",type:"blue"},mimosa:{name:"三片叶子的含羞草",detail:"受到的伤害不会超过最大生命值的70%(每层*95%)。",type:"blue"},compass_cat:{name:"罗盘猫",detail:"对速度低于自己的敌人造成伤害+10%(每层+10%)。",type:"blue"},bird_wine:{name:"雀酒",detail:"击败敌人时对全体敌人附加燃烧*2(每层+2)。",type:"blue"},frozen_frog:{name:"冻青蛙",detail:"战斗开始时速度+0.25(每层+0.25)，回合结束时-0.25，直至该增益为0。",type:"blue"},fluorescent_zanthoxylum:{name:"荧光花椒",detail:"暴击率+5%(每层+5%)。",type:"blue"},corvis_feathers:{name:"鸦天狗羽毛",detail:"处于两个及以上效果下时，速度+0.1(每层+0.1)。",type:"blue"},sundial:{name:"日晷",detail:"间接伤害提高10%(每层+10%)。",type:"blue"},pickled_radish:{name:"腌萝卜",detail:"生命值高于90%时符卡对敌人造成的伤害+10%(每层+10%)。",type:"blue"},conch_shell:{name:"海螺壳",detail:"每次受到的伤害固定减少1(每层+1)。",type:"blue"},cursed_wind_chimes:{name:"被诅咒的风铃",detail:"造成50(每层-1)及以上的最终伤害时，驱散目标的所有正面效果。",type:"blue"},false_hammer:{name:"万宝槌（仿制品）",detail:"对杂鱼造成的伤害+10%(每层+10%)。",type:"blue"},shy_rabbit:{name:"害羞兔",detail:"每第三张牌造成的伤害+10%(每层+10%)。",type:"blue"},crown_of_thorns:{name:"荆棘礼冠",detail:"在敌人的回合，受到伤害的敌人获得易伤*1(每层+1)，持续一回合。",type:"blue"},midnight_cloak:{name:"午夜斗篷",detail:"对生命值低于50%的敌人造成的伤害增加10%(每层+10%)。",type:"blue"},ice_scale:{name:"冰之鳞",detail:"直接伤害10%(每层+10%)概率附加迟缓*1。",type:"blue"},sakura_tea:{name:"樱茶",detail:"受到的治疗效果+10%(每层+10%)。",type:"blue"},big_bugle:{name:"大喇叭",detail:"回合结束时对全体目标造成2(每层+2)穿透间接伤害。",type:"blue"},carnyx:{name:"助眠的卡尼克斯号",detail:"商店打折95%(每层*95%)。",type:"blue"},rune_sword:{name:"符文之刃",detail:"造成的穿透伤害+5%(每层+5%)，受到的穿透伤害-5%(每层-5%)。",type:"blue"},ghost_lantern:{name:"鬼行提灯",detail:"回合结束时，每剩余1点灵力，获得临时防御结界*1(每层+1)。",type:"green"},vampires_old_tooth:{name:"吸血鬼的旧牙",detail:"伤害命中处于正面效果下的敌人时回复1(每层+1)生命值。",type:"green"},large_roll_of_bandages:{name:"一大卷绷带",detail:"受到伤害的下一回合回复5%(每层+5%)当前生命值。",type:"green"},burning_seashore_flower:{name:"燃烧的彼岸花",detail:"每损失1%生命值，获得0.2%(每层+0.2%)暴击率和0.01(每层+0.01)速度。",type:"green"},skyrocket:{name:"窜天猴",detail:"普通攻击30%概率额外造成50%间接伤害并获得1(每层+1)灵力。",type:"green"},magic_dart:{name:"魔力魔力飞镖",detail:"受到伤害时反击，造成伤害20%(每层+20%)的间接伤害。",type:"green"},sport_shoes:{name:"竹林棉棉鞋",detail:"受到超过20(每层-1)的伤害时，抽一张牌，获得1额外灵力。",type:"green"},sticking_plaster:{name:"冰冰凉凉的创可贴",detail:"过量治疗时，获得20%(每层+20%)过量治疗量的临时防御结界。",type:"green"},earthy_spider_wine:{name:"土蜘蛛酒",detail:"普通攻击后符卡造成的伤害提高20%(每层+20%)，回合初清除。",type:"green"},amulet_of_full_moon:{name:"圆月护符",detail:"处于两种及以上负面效果下时，受到的伤害*90%(每层*90%)。",type:"green"},seal_needle:{name:"封魔针",detail:"累计造成八次伤害后，下次攻击对目标附加流血*1(每层+1)。",type:"green"},trolley:{name:"手推车",detail:"击败敌人时获得1(每层+1)额外灵力。",type:"green"},dimensional_pocket:{name:"隙间纸袋",detail:"消耗品上限+1(每层+1)。",type:"green?"},terrible_ring:{name:"可爱小戒指",detail:"每经过一回合，暴击率+4%(每层+4%)。",type:"green"},toolbox:{name:"应急道具箱",detail:"使用主动装备或消耗品时，20%(每层+20%)概率触发一次击败事件。",type:"green"},light_bulb:{name:"电灯泡",detail:"灵力低于1(每层+1)时抽一张牌。",type:"green"},patchoulis_ribbon:{name:"帕秋莉的缎带",detail:"牌库中灵力消耗最高的一张牌灵力消耗-1(每层-1)。",type:"green"},free_eagle:{name:"自由之鹰",detail:"连续暴击时清除自身随机1(每层+1)层负面效果。",type:"green"},red_and_white_scarf:{name:"红白围巾",detail:"生命值高于30%(每层*85%)时，受到致命伤会保留1生命值。",type:"red"},bottle_of_stars:{name:"装星星的瓶子",detail:"造成40及以上的伤害时附加1(每层+1)颗星星，在下回合爆炸造成最终伤害40%的额外伤害。",type:"red"},blade_of_yellow_spring:{name:"黄泉之刃",detail:"回合初获得1(每层+1)张额外普通攻击，回合结束时移除。",type:"red"},human_soul_lamp:{name:"人魂灯",detail:"暴击伤害+60%(每层+60%)。",type:"red"},paper_windmill:{name:"式神·风力发电机",detail:"自然灵力和额外灵力上限+1(每层+1)，回合初获得1(每层+1)额外灵力。",type:"red"},fish_stone:{name:"鱼石",detail:"自身负面效果结算时所取层数减1(每层+1)。",type:"red"},JupiterACL300:{name:"木星ACL300",detail:"所有直接伤害都会爆炸，对目标左右两边第一个对象造成伤害25%(每层+25%)的间接伤害。",type:"red"},shimenawa:{name:"注连绳",detail:"抽牌时25%(每层+25%)概率增加1次主动装备可使用次数。",type:"red"},flip_flops:{name:"旧都人字拖",detail:"每拥有1额外灵力，速度+0.2(每层+0.2)。",type:"red"},ace:{name:"Ace",detail:"概率事件额外判定1(每层+1)次，取更好的一次。",type:"red"}};const Ke={gongonier:{name:"血之矢",detail:"被动。造成的伤害暴击时，回复伤害20%的生命值。",passive:!0},sword_of_feixiang:{name:"绯想之剑",detail:"被动。对处于负面效果下的敌人造成的伤害+40%。",passive:!0},sunshade:{name:"阳伞",detail:"主动。将30%生命值转化为200%防御结界。",handle:(e,t)=>{let n=e.role.state.of(0).get().Health;e.role.state.of(0).set("Health",.7*n),e.role.buff.of(0).add("barrier",Math.ceil(.3*n*2))}},mirror_of_pear:{name:"净颇梨之镜",detail:"被动。普通攻击不消耗灵力。",passive:!0},mini_bagua_stove:{name:"迷你八卦炉",detail:"主动。造成30群体伤害。",handle:(e,t)=>{e.enermy.damage.targetAll().source("equipment").by({type:"static",value:30})}},louguanjian:{name:"楼观剑",detail:"主动。扣除目标20%当前生命值。",aim:!0,handle:(e,t)=>{let n=e.enermy.state.of(t).get().Health;e.enermy.state.of(t).set("Health",.8*n)}},hd_camera:{name:"高清相机",detail:"主动。指定目标一回合受到的伤害均为穿透伤害。",aim:!0,handle:(e,t)=>{e.enermy.buff.of(t).add("exposure")}},repentance_rod:{name:"悔悟之棒",detail:"被动。抽空牌库时，获得等于此次抽牌数的额外灵力。",passive:!0},circular_fan:{name:"团扇",detail:"被动。每打出1张符卡获得1张临时普通攻击。",passive:!0},devil_tied_scroll:{name:"魔人经卷",detail:"主动。驱散目标身上的正面效果。",aim:!0,handle:(e,t)=>{e.enermy.buff.of(t).clearAll(!0)}}};for(let e in Ke)Ke[e].type="gold";var De={nodas_hat:{name:"野田的帽子",detail:"生命值高于50%时受到伤害增加20%，低于50%时则减少30%。"},aokis_fish:{name:"苍姬的鱼",detail:"受到伤害时70%概率获得随机负面效果(迟缓、疲倦、易伤、虚弱、恍惚)*1，30%概率阻挡本次伤害。"},ahabs_opinion:{name:"亚哈的意见",detail:"生命上限变为70%，战斗开始时回复全部生命值。"},mimicry_cat_pendant:{name:"拟态的猫挂件",detail:"打出手牌时，每有1灵力需求，扣除10%当前生命值，不消耗灵力。"},wanderlust:{name:"清泧的遨游术",detail:"手牌上限变为4，不受速度影响，每拥有1速度，回合初获得1额外灵力。"},cerallins_bottle:{name:"Cerallin的酒",detail:"回合结束时丢弃所有手牌，并获得等量额外灵力。"}},Fe={doubtful_potion:{name:"可疑的药水",detail:"生命值随机变动-50%至50%。",source:"event"},heart_fire_of_grace:{name:"恩惠的心之火",detail:"本场战斗中第一次受到致命伤害时，免疫所有伤害，持续一回合。",source:"shop"},gift_from_ergen:{name:"厄神的小礼物",detail:"对方全体攻击降低20%，持续三回合。",source:"event"},good_corn:{name:"上好的玉米",detail:"驱散自身所有负面效果。",source:"shop"},banana:{name:"香蕉",detail:"回复17生命值。",source:"event"}},Ye={marisa:{name:"雾雨魔理沙",detail:"最华丽的弹幕，需要最朴实无华的启动。",talent:"每回合初获得4额外灵力。\n击败敌人时回复8生命。\n商店打9折。",unlock:"造成一次超过1000的伤害",WIP:{shion:{name:"依神紫苑",detail:"失去的财产，还有运气究竟去了哪里呢。"},aya:{name:"射命丸文",detail:"来吧，我会手下留情的。"}}},reimu:{name:"博丽灵梦",detail:"天生灵力，超乎常人的幸运，不过……",talent:"灵力用尽时消耗2生命上限代替1灵力使用。\n清欢: 回合开始时对全体目标造成1(每层+1)穿透伤害。每受到1伤害失去清欢*2。\n概率事件额外判定两次，取更好的那次。",unlock:"回合内所有概率事件判定均为正面"},youmu:{name:"魂魄妖梦",detail:"半人半灵的半吊子。但是剑有两把。",talent:"效果-通灵：10%(每层+10%)几率闪避下一次攻击。每回合初清空。\n所有暴击率转化为暴击伤害。\n每消耗一点灵力，获得通灵*1。\n每触发一次闪避减少通灵*3，并反击一次必定暴击的普攻。",unlock:"一场战斗内所有攻击全部暴击"},pachi:{name:"帕秋莉",detail:"居住在大图书馆中的魔女，非常擅长魔法。",talent:"类型-精灵魔法：可选择咏唱2/3/4回合，时间越长威力越大。",unlock:"在敌人的回合击败最终boss"},alice:{name:"爱丽丝",detail:"魔法森林中的，七色的奴隶主。",talent:"类型-人偶：按刷新顺序阻挡伤害，耐久归零时清除，重复放置刷新耐久和结算顺序。",unlock:"只依靠间接伤害击败一个boss"},reisen:{name:"铃仙",detail:"菜，就多练，输不起，就别玩。",detail2:"狂气的月兔！天不怕地不怕，迷途竹林我最大！",talent:"效果-狂气：命中率*95%(每层*95%)。\n效果-虚幻：受到伤害+5%(每层+5%)\n效果-疯狂：受到1(每层+1)穿透间接伤害。\n符卡可以施加狂气和虚幻效果，两种效果会互相抵消并产生相应层数的疯狂效果。\n为敌人施加狂气和虚幻中一种效果时，自身获得另一种效果*1。\n在受狂气影响和受虚幻影响之间切换时，结算疯狂效果。",unlock:"血量100%时被单次伤害击败"},kokoro:{name:"秦心",detail:"表情丰富的扑克脸，跳起舞来很可爱。",talent:"面具:佩戴条件;佩戴效果\n面具打出后登记到效果栏，触发任一佩戴条件即可获得持续的触发效果。\n同时只能佩戴一个面具，默认佩戴登记的第一个面具。\n重复打出已登记的面具可叠加佩戴效果的层数，切换面具时清除。",unlock:"在不使用通式的情况下完成一个场景"}},Xe={role:{marisa:{health:42,attack:7,speed:2,power:1},reimu:{health:42,attack:7,speed:2,power:8},renko:{health:42,attack:7,speed:2,power:6},youmu:{health:48,attack:8,speed:2,power:8},pachi:{health:42,attack:7,speed:2,power:7},alice:{health:54,attack:9,speed:2,power:5},reisen:{health:48,attack:8,speed:2,power:6},kokoro:{health:54,attack:9,speed:2,power:8}},enermy:{cirno:e=>Ge(e,1,1,1),piece:e=>Ge(e,1,1,1),lilywhite:e=>Ge(e,1,1,1),sunny:e=>Ge(e,1,1,1),lunar:e=>Ge(e,1,1,1),star:e=>Ge(e,1,1,1),eternity:e=>Ge(e,1,1,1)},amount:e=>{let t=4.2-1/Math.pow(2,e/32-2),n=t-parseInt(t),l=Number(Math.random()<n);return Math.max(parseInt(t)+l,1)}};function Ge(e,t,n,l){return{health:We(Je(e)*t),attack:We(Je(e)*n/8),speed:1+.02*(e-1)*l}}function Je(e){return e=retain(.8*e,0)+2,parseInt(Math.pow(Math.E,e/(Math.log(e+1)+Math.sqrt(e)))+e+10)}function We(e){return.95*e+Math.random().toFixed(2)*e*.1}const Ze={marisa:{name:"魔法弹",detail:"造成10伤害",cost:1,aim:!0,type:"normal_attack",handle:function(e,t){e.enermy.damage.target(t).source("normal_attack").by({type:"static",value:10})}},m001:{name:"开放宇宙",detail:"本回合灵力消耗-1\n下回合无法获得灵力",cost:2,handle:function(e,t){e.role.buff.of(0).add("throttle",1),e.cache.open_universe=!0}},m002:{name:"洒星封印",detail:"锁定灵力数值\n持续一回合",cost:3,handle:function(e,t){e.role.buff.of(0).add("throttle",99),e.role.buff.of(0).add("insulation")}},m003:{name:"超级英仙座",detail:"每使用1张符卡\n下回合伤害+10%\n持续一回合",cost:2,handle:function(e,t){e.cache.super_perseids=1}},m004:{name:"太阳仪",detail:"本回合所有伤害\n转移到下回合初结算\n造成120%间接伤害",cost:2,handle:function(e,t){e.role.buff.of(0).add("orrerys_sun",1)}},m005:{name:"极限火花",detail:"造成36群体伤害\n下回合无法行动",cost:3,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:36}),e.role.buff.of(0).add("hypodynamic",1)}},m006:{name:"究极火花",detail:"造成40群体伤害\n每有1灵力伤害+5%\n下回合无法行动",cost:5,handle:function(e,t){let n=e.role.power.of(0).get();e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:40*(1+.05*n)}),e.role.buff.of(0).add("hypodynamic",1)}},m007:{name:"卫星幻觉",detail:"从牌库中抽2张牌",cost:2,handle:function(e,t){e.handcard.draw.amount(2).fromAll()}},m008:{name:"魔理沙时间",detail:"暴击率+30%\n持续一回合",cost:1,handle:function(e,t){e.role.buff.of(0).add("marisa_time")}},m009:{name:"小行星带",detail:"造成4*5群体伤害",cost:3,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:5,amount:4})}},m010:{name:"大坍缩",detail:"将60伤害平摊给所有敌人",cost:3,handle:function(e,t){e.enermy.damage.average().source("spellcard").by({type:"static",value:60})}},m011:{name:"星尘幻想",detail:"对目标和其余敌人分别造成40、8伤害",cost:3,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:40}),e.enermy.damage.targetAll().except(t).source("spellcard").by({type:"static",value:8})}},m012:{name:"掠日彗星",detail:"造成16伤害\n获得8防御结界",cost:2,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:16}),e.role.buff.of(0).add("barrier",8)}},m013:{name:"光学迷彩",detail:"锁定生命值\n造成的伤害-50%\n持续一回合",cost:3,handle:function(e,t){e.role.buff.of(0).add("iron_skin",10),e.role.buff.of(0).add("weak",5)}},m014:{name:"星光台风",detail:"造成27群体穿透伤害\n命中率70%",cost:3,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:27,penetrate:!0,precision:.7})}},m015:{name:"大十字",detail:"接下来三次伤害\n暴击伤害+100%",cost:3,handle:function(e,t){e.role.buff.of(0).add("grand_cross",3)}},m016:{name:"非定向光线",detail:"造成28穿透伤害\n立即击败生命值25%以下的敌人",cost:2,aim:!0,handle:function(e,t){let n=e.enermy.state.of(t).get();e.enermy.damage.target(t).source("spellcard").by({type:"static",value:28,penetrate:!0,fatal:n.Health/n.health<.25})}},m017:{name:"龙陨石",detail:"造成12+20的必定暴击伤害，击败目标获得临时力量*5",cost:3,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:12,critical:!0,dragon_meteor:1}),e.enermy.damage.target(t).source("spellcard").by({type:"static",value:20,critical:!0,dragon_meteor:2})}},m018:{name:"增幅",detail:"获得力量*2",cost:2,handle:function(e,t){e.role.buff.of(0).add("strength",1)}},m019:{name:"过载",detail:"获得临时力量*4",cost:3,handle:function(e,t){e.role.buff.of(0).add("interim_strength",3)}},m020:{name:"超载",detail:"获得临时力量*6",cost:3,interim:!0,handle:function(e,t){e.role.buff.of(0).add("interim_strength",5)}},m021:{name:"唯一的北极星",detail:"造成36伤害\n若目标生命值100%\n伤害翻倍",cost:3,aim:!0,handle:function(e,t){let n=e.enermy.state.of(t).get();e.enermy.damage.target(t).source("spellcard").by({type:"static",value:n.Health/n.health==1?72:36})}},m022:{name:"试验用使魔",detail:"本回合所有伤害截走25%，在回合末合并结算为群体伤害",cost:2,handle:function(e,t){e.role.buff.of(0).add("test_slave")}},m023:{name:"逃逸速度",detail:"每过一回合速度+0.6",cost:2,interim:!0,handle:function(e,t){e.cache.escape_velocity=!0}},m024:{name:"光之冲击",detail:"造成24伤害\n目标命中率-50%\n持续一回合",cost:2,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:24}),e.enermy.buff.of(t).add("trance",5)}},m025:{name:"超短波",detail:"造成16伤害\n第一回合伤害翻倍",cost:0,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:1==e.role.event.round.count?32:16})}},m026:{name:"脉冲星",detail:"复制下一张符卡\n作为一次性牌\n加入手牌",cost:1,handle:function(e,t){e.cache.pulsar_star=2}},m027:{name:"魔法瓶",detail:"附加燃烧*3\n抽一张牌",cost:0,interim:!0,aim:!0,handle:function(e,t){e.enermy.buff.of(t).add("burning",3),e.handcard.draw.amount(1).fromLeft()}},m028:{name:"魔鬼火炬",detail:"牌库洗入魔法瓶*4",cost:2,interim:!0,handle:function(e,t){for(let t of Array(4))e.handcard.insert.toLeft("m027")}},m029:{name:"流星雨",detail:"造成4*3伤害\n抽一张牌",cost:0,interim:!0,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:3,amount:4}),e.handcard.draw.amount(1).fromLeft()}},m030:{name:"流星共鸣",detail:"牌库洗入流星雨*4",cost:2,interim:!0,handle:function(e,t){for(let t of Array(4))e.handcard.insert.toLeft("m029")}},m031:{name:"地球光",detail:"造成12穿透伤害\n抽一张牌",cost:0,interim:!0,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:12,penetrate:!0}),e.handcard.draw.amount(1).fromLeft()}},m032:{name:"射向幼月",detail:"牌库洗入地球光*4",cost:2,interim:!0,handle:function(e,t){for(let t of Array(4))e.handcard.insert.toLeft("m031")}},m033:{name:"掩星",detail:"从已消耗的牌中\n抽一张牌",cost:2,handle:function(e,t){e.handcard.draw.amount(1).fromExpend()}},m034:{name:"毫秒脉冲星",detail:"本回合每消耗1张牌\n此牌造成3*2伤害",cost:3,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:2,amount:3*e.cache.round_expend_count})}},m035:{name:"奥尔特云",detail:"造成等同于本回合造成伤害次数的伤害",cost:4,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:e.cache.round_damage_frequency})}},m036:{name:"银河",detail:"本回合造成的伤害+1",cost:1,handle:function(e,t){e.role.buff.of(0).add("milky_way")}},m037:{name:"最终魔法瓶",detail:"对全场所有对象\n造成100伤害",cost:0,interim:!0,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:100}),e.role.damage.target(0).source("spellcard").by({type:"static",value:100})}}};for(let e in Ze)Ze[e].role="marisa";const Ue={reimu:{name:"阴阳印",detail:"造成6伤害\n获得清欢*3",cost:1,handle:function(e,t){e.enermy.damage.target(t).source("normal_attack").by({type:"static",value:6}),e.role.buff.of(0).add("pure_happy",3)},aim:!0,type:"normal_attack"},r001:{name:"梦想封印",detail:"重复6次对随机目标造成6伤害，未命中时获得清欢*5",cost:3,handle:function(e,t){[1,2,3,4,5,6].forEach((t=>{e.enermy.damage.random().source("spellcard").by({type:"static",value:6,dream_seal:!0})}))}},r002:{name:"前方安全札",detail:"本回合造成伤害时\n回复5生命值\n获得恍惚*2",cost:2,handle:function(e,t){e.role.buff.of(0).set("font_safe",1)}},r004:{name:"阴阳玉将",detail:"削减所有目标\n20%当前生命值\n命中获得清欢*4",cost:3,handle:function(e,t){e.enermy.survival().forEach((t=>{let n=e.enermy.state.of(t).get().Health;e.enermy.state.of(t).set("Health",.8*n),e.role.buff.of(0).add("pure_happy",4)}))}},r005:{name:"二重结界",detail:"所有目标受到的伤害\n变为穿透伤害\n持续一回合",cost:2,handle:function(e,t){e.enermy.buff.addAll("exposure",1)}},r006:{name:"博丽幻影",detail:"40%概率闪避伤害\n闪避时获得清欢*4\n持续一回合",cost:2,handle:function(e,t){e.role.buff.of(0).add("hakurei_phantom")}},r007:{name:"阴阳散华",detail:"抽两张牌\n获得清欢*8",cost:3,handle:function(e,t){e.handcard.draw.amount(2).fromLeft(),e.role.buff.of(0).add("pure_happy",8)}},r008:{name:"魔净闪结",detail:"回复8生命值\n获得清欢*6\n下张牌造成同样效果",cost:3,handle:function(e,t){e.role.heal.target(0).by({type:"static",value:8}),e.role.buff.of(0).add("pure_happy",6),e.cache.magic_link=!0}},r009:{name:"八方鬼缚阵",detail:"免疫2次伤害",cost:2,interim:!0,handle:function(e,t){e.role.buff.of(0).add("foresee",2)}},r010:{name:"妖怪拘禁符",detail:"附加易伤*4，若目标生命值100%，下次行动变为附加恍惚*3",cost:3,handle:function(e,t){e.enermy.buff.of(t).add("fragile",4);let n=e.enermy.state.of(t).get();n.Health==n.health&&e.enermy.buff.of(t).add("trance_cage",1)},aim:!0},r011:{name:"无差别降伏",detail:"造成24伤害\n若未暴击\n获得清欢*8",cost:3,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:24,undifferentiated_subduction:!0})},aim:!0},r012:{name:"妖怪破坏者",detail:"造成16伤害\n若未命中\n获得防御结界*12",cost:2,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:16,ghost_breaker:!0})},aim:!0},r013:{name:"退魔符乱舞",detail:"3穿透群伤，消耗清欢*1，打出后回到手牌，消耗清欢+1",cost:1,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:3,penetrate:!0}),e.handcard.insert.interim(!0).toHolds("r013"),e.role.buff.of(0).clear("pure_happy",e.cache.pure_happy_cost),"pure_happy_cost".increaseOf(e.cache)},interim:!0},r014:{name:"梦想亚空穴",detail:"获得2额外灵力，生命-2，打出后回到手牌，生命消耗+2",cost:0,handle:function(e,t){e.cache.reimu_health_cost||(e.cache.reimu_health_cost=2);let n=e.role.state.of(0).get();e.role.power.of(0).add(3),e.role.state.of(0).set("Health",n.Health-e.cache.reimu_health_cost),e.cache.reimu_health_cost+=2,e.handcard.insert.interim(!0).toHolds("r014")},interim:!0},r015:{name:"常置阵",detail:"受到伤害为穿透伤害\n受到的伤害-30%\n持续一回合",cost:2,handle:function(e,t){e.role.buff.of(0).add("exposure",1),e.role.buff.of(0).add("iron_skin",3)}},r016:{name:"明珠暗投",detail:"下回合初\n获得清欢*12\n抽两张牌",cost:2,handle:function(e,t){e.role.buff.of(0).add("waiting_pearl")}},r017:{name:"阴阳玉乱舞",detail:"造成32伤害\n击败目标时抽两张牌",cost:3,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:32,jade_dance:!0})},aim:!0},r018:{name:"神灵宝珠",detail:"生命-9\n抽两张牌",cost:0,handle:function(e,t){e.role.state.of(0).add("Health",-9),e.handcard.draw.amount(2).fromLeft()}},r019:{name:"无情驱魔棒",detail:"灵力消耗-1\n受到伤害+30%\n持续一回合",cost:0,handle:function(e,t){e.role.buff.of(0).add("throttle",1),e.role.buff.of(0).add("weak",3)}},r020:{name:"信仰之针",detail:"造成8伤害\n未命中时抽两张牌",cost:1,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:32,faith_needle:!0})},aim:!0},r021:{name:"扩散灵符",detail:"获得清欢*6\n不在第一回合使用时\n再获得恍惚*3",cost:2,handle:function(e,t){e.role.buff.of(0).add("pure_happy",6),1!=e.role.event.round.count&&e.role.buff.of(0).add("trance",3)}},r022:{name:"犯规结界",detail:"丢弃全部手牌，获得临时防御结界*16",cost:2,handle:function(e,t){let n=e.handcard.getHolds().length;e.handcard.abandon.amount(n-1).fromHolds(),e.role.buff.of(0).add("interim_barrier",16)}},r023:{name:"阴阳飞鸟井",detail:"本回合打出符卡时\n30%概率额外灵力+2\n并获得清欢*3",cost:3,interim:!0,handle:function(e,t){e.role.buff.of(0).add("yinyang_bird")}},r024:{name:"阴阳宝玉",detail:"抽两张符卡\n获得清欢*3\n获得恍惚*3",cost:2,handle:function(e,t){e.role.buff.of(0).add("pure_happy",3),e.role.buff.of(0).add("trance",3),e.handcard.draw.amount(2).type("spellcard").fromLeft()}},r025:{name:"阴阳鬼神玉",detail:"造成等同于自身生命上限的伤害，获得清欢*6",cost:4,handle:function(e,t){let n=e.role.state.of(0).get();e.enermy.damage.target(t).source("spellcard").by({type:"static",value:.8*n.health}),e.role.buff.of(0).add("pure_happy",4)},aim:!0},r026:{name:"幻想一重",detail:"处于清欢效果下时\n清除所有清欢\n生命上限+5",cost:2,handle:function(e,t){e.role.buff.of(0).clear("pure_happy"),e.role.state.of(0).add("health",5)}},r027:{name:"亚空穴",detail:"丢弃一张牌\n生命上限+4\n打出后回到牌库",cost:1,handle:function(e,t){e.handcard.abandon.amount(1).fromHolds(),e.role.state.of(0).add("health",4),e.handcard.insert.interim(!0).toLeft("r014")},interim:!0},r028:{name:"八方龙杀阵",detail:"本场战斗\n受到伤害-30%\n速度-1",cost:1,handle:function(e,t){e.role.buff.of(0).set("eight_dragon_kill",1)},interim:!0},r029:{name:"高速祈愿札",detail:"生命上限+12\n回复8生命",cost:3,interim:!0,handle:function(e,t){e.role.state.of(0).add("health",12),e.role.heal.target(0).by({type:"static",value:8})}},r030:{name:"大祸津日",detail:"造成伤害-90%\n治疗效果+100%\n持续一回合",cost:1,handle:function(e,t){e.role.buff.of(0).set("big_bad_sun",1)}},r031:{name:"梦想妙珠连",detail:"牌库洗入梦想妙珠*4",cost:3,handle:function(e,t){e.handcard.insert.amount(4).toLeft("r031")}},r032:{name:"梦想妙珠",detail:"生命上限+3\n抽一张牌",cost:0,interim:!0,handle:function(e,t){e.role.state.of(0).add("health",3),e.handcard.draw.amount(1).fromLeft()}},r033:{name:"扩散结界",detail:"清除目标和自身\n所有正面效果\n抽两张牌",cost:3,handle:function(e,t){e.role.buff.of(0).clearAll(!0),e.enermy.buff.of(t).clearAll(!0),e.handcard.draw.amount(2).fromLeft()}},r034:{name:"幻想之月",detail:"处于清欢效果下时\n清除所有清欢\n获得5额外灵力",cost:0,handle:function(e,t){e.role.buff.of(0).clear("pure_happy"),e.role.power.of(0).add(5)}},r035:{name:"即妙神域札",detail:"清除自身所有效果\n回复10生命",cost:2,handle:function(e,t){e.role.buff.of(0).clearAll(),e.role.heal.target(0).by({type:"static",value:10})}},r036:{name:"折跃阴阳玉",detail:"造成20群体伤害\n命中时回复4生命\n反之生命上限+4",cost:3,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:20,jump_jade:!0})}},r037:{name:"封魔阵",detail:"造成16穿透伤害\n附加易伤*3\n暴击时生命上限+8",cost:3,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:16,penetrate:!0,seal_array:!0}),e.enermy.buff.of(t).add("fragile",3)},aim:!0}};for(let e in Ue)Ue[e].role="reimu";const Qe={youmu:{name:"剑气",detail:"造成2*4伤害",role:"youmu",cost:1,handle:function(e,t){e.enermy.damage.target(t).source("normal_attack").by({type:"static",value:4,amount:2})}},bright_bitter_wheel:{name:"幽明的苦轮",detail:"接下来三次攻击\n额外60%间接伤害\n并获得1额外灵力",role:"youmu",allAim:!0,cost:3,handle:function(e,t){e.role.buff.of(0).add("Bright_Bitter_Wheel",3)}},six_roots_clean:{name:"六根清净斩",detail:"下次受到攻击时闪避\n并造成15群体伤害",role:"youmu",allAim:!0,cost:3,handle:function(e,t){e.role.buff.of(0).add("six_roots_clean",1)}},centered_flow:{name:"圆心流转斩",detail:"造成3*4群体伤害\n下次普通攻击伤害提高80%",role:"youmu",allAim:!0,cost:3,handle:function(e,t){e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:4,amount:3}),e.role.buff.of(0).add("flow",1)}},future_never_survive:{name:"未来永劫斩",detail:"造成28伤害\n接下来三次普攻\n变为4*3",role:"youmu",cost:3,handle:function(e,t){e.enermy.damage.target(t).source("spellcard").by({type:"static",value:28}),e.role.buff.of(0).add("yanfan",3)}},graciousness_maze:{name:"迷津慈航斩",detail:"普攻消耗灵力+1\n伤害提高200%\n持续一回合",role:"youmu",allAim:!0,cost:3,handle:function(e,t){e.role.buff.of(0).set("meditation_slash",1)}},pachi:{name:"魔力光束",detail:"造成7伤害\n必定命中",role:"pachi",cost:1},royal_lare:{name:"皇家圣焰",detail:"精灵魔法:12/20/30群体伤害\n附加燃烧*1/2/3",role:"pachi",cost:3},philosophers_stone:{name:"贤者之石",detail:"精灵魔法缩短一回合\n抽取一张符卡",role:"pachi",cost:3},silent_selene:{name:"沉静的月神",detail:"清除全体敌人正面效果，下一回合无法行动，不受到任何伤害",role:"pachi",cost:3},silver_dragon:{name:"银龙",detail:"12伤害\n精灵魔法:14/24/34伤害",role:"pachi",cost:3},bury_in_lake:{name:"湖葬",detail:"每回合造成6间接伤害，回复等量生命，持续3回合",role:"pachi",cost:3},jellyfish_princess:{name:"水母公主",detail:"每回合回复10%最大生命值并获得1额外灵力，持续3回合",role:"pachi",cost:3},sylphy_horn:{name:"风灵的角笛",detail:"精灵魔法:回复12/20/30生命值",role:"pachi",cost:3},emerald_megalopolis:{name:"翡翠巨城",detail:"下一回合伤害提高\n20%，每造成一次伤害额外提高20%",role:"pachi",cost:3},alice:{name:"人偶千枪",detail:"造成9伤害\n对于负面效果下的目标必定暴击",role:"alice",cost:1},artful_sacrifice:{name:"狡猾的献祭",detail:"清除随机人偶\n造成36伤害",role:"alice",cost:3},return_inanimateness:{name:"回归虚无",detail:"清除所有人偶\n每清除1人偶\n造成6群体伤害",role:"alice",cost:3},little_legion:{name:"小小军势",detail:"人偶造成两倍伤害\n持续一回合",role:"alice",cost:3},shanghai_doll:{name:"上海人偶",detail:"人偶:攻击15\n耐久25\n",role:"alice",cost:3},penglai_doll:{name:"蓬莱人偶",detail:"人偶:耐久1\n损坏时造成45伤害",role:"alice",cost:3},kyoto_doll:{name:"京都人偶",detail:"人偶:攻击4,耐久12\n每回合获得\n2额外灵力",role:"alice",cost:3},xizang_doll:{name:"西藏人偶",detail:"人偶:攻击4,耐久36",role:"alice",cost:3},london_doll:{name:"伦敦人偶",detail:"人偶:耐久20\n攻击等同于耐久",role:"alice",cost:3},russia_doll:{name:"俄罗斯人偶",detail:"人偶:攻击4,耐久12\n造成群体伤害",role:"alice",cost:3},holland_doll:{name:"荷兰人偶",detail:"人偶:攻击4,耐久12\n在场时所有攻击\n附加流血*1",role:"alice",cost:3},orleans_doll:{name:"奥尔良人偶",detail:"人偶:攻击4,耐久12\n每回合回复7生命值",role:"alice",cost:3},kokoro:{name:"心之舞",detail:"造成9伤害\n回复3生命",role:"kokoro",cost:1},kokoro_roulette:{name:"心的轮盘",detail:"佩戴随机其它面具",role:"kokoro",cost:3},masked_heart_dance:{name:"假面丧心舞",detail:"佩戴所有面具\n灵力消耗+1\n直到下次佩戴面具",role:"kokoro",cost:3},taboo_wolf_face:{name:"忌狼之面",detail:"佩戴两次当前佩戴的面具",role:"kokoro",cost:3},demon_fox_face:{name:"妖狐面",detail:"面具:额外灵力大于1;灵力消耗-1(+1)",role:"kokoro",cost:3},big_spider_face:{name:"大蜘蛛面",detail:"面具:回合内进行超过3次攻击;造成的伤害+30%(+30%)",role:"kokoro",cost:3},ghost_face:{name:"鬼婆面",detail:"面具:生命值在40%以下;回复效果+30%(+30%)",role:"kokoro",cost:3},long_wall_face:{name:"长壁面",detail:"面具:单次受伤15以上;回复造成伤害30%(+30%)的生命",role:"kokoro",cost:3},Hot_man_face:{name:"火男面",detail:"面具:新增正面效果;治疗时造成100%(+100%)额外群伤",role:"kokoro",cost:3},lion_face:{name:"狮子面",detail:"面具:手牌数超过5;抽牌数+1(+1)",role:"kokoro",cost:3},worryingly:{name:"杞人忧地",detail:"清除随机面具\n造成15群体伤害",role:"kokoro",cost:3},reisen:{name:"Lunatic Gun",detail:"造成8伤害\n附加疯狂*4",role:"reisen",cost:1},lunatic_red_eyes:{name:"幻胧月睨",detail:"所有疯狂翻倍",role:"reisen",cost:3},invisible_full_moon:{name:"真实之月",detail:"造成12穿透伤害\n附加疯狂*16",role:"reisen",cost:3},visionary_tuning:{name:"幻视调律",detail:"造成12伤害\n附加虚幻*12",role:"reisen",cost:3},illusion_seeker:{name:"狂视调律",detail:"造成12伤害\n附加狂气*12",role:"reisen",cost:3},mind_stopper:{name:"生神停止",detail:"回复10生命值\n获得虚幻*2",role:"reisen",cost:3},rocket_in_mist:{name:"胧月花栞",detail:"造成8群体伤害\n获得狂气*2",role:"reisen",cost:3},luna_wave:{name:"月面波纹",detail:"所有目标一半的狂气或虚幻施加给随机目标",role:"reisen",cost:3},luna_megalopolis:{name:"荣华之梦",detail:"清除所有狂气和虚幻\n清除自身疯狂",role:"reisen",cost:3},infrared_moon:{name:"赤月下",detail:"造成伤害时\n附加狂气*伤害50%\n持续一回合",role:"reisen",cost:3},invisible_half_moon:{name:"幻之月",detail:"造成伤害时\n附加虚幻*伤害50%\n持续一回合",role:"reisen",cost:3}};Object.assign(Qe,Ze),Object.assign(Qe,Ue);for(let e in Qe)"normal_attack"!=Qe[e].type&&(Qe[e].type="spellcard");const Ve={a001:{name:"森罗万象",detail:"抽牌至上限",cost:2,interim:!0,handle:function(e,t){let n=4+Math.round(e.role.state.of(0).get().speed),l=e.handcard.getHolds().length;e.handcard.draw.amount(n-l).fromLeft()}},a002:{name:"小憩",detail:"回复8%最大生命",cost:1,handle:function(e,t){e.role.heal.target(0).by({type:"static",value:.08*e.role.state.of(0).get().health})}},a003:{name:"圣骑士",detail:"造成10伤害\n获得15%最大生命\n防御结界",cost:2,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("basecard").by({type:"static",value:10}),e.role.buff.of(0).add("barrier",Math.ceil(.15*e.role.state.of(0).get().health))}},a004:{name:"灵力冲天炮",detail:"消耗全部灵力\n每消耗1灵力\n造成8伤害",cost:1,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("basecard").by({type:"static",value:8,amount:e.role.power.of(0).get()}),e.role.power.of(0).clear()}},a006:{name:"虚空",detail:"免疫一次伤害\n抽一张牌",cost:1,handle:function(e,t){e.role.buff.of(0).add("foresee",1),e.handcard.draw.amount(1).fromLeft()}},a007:{name:"抛硬币",detail:"损失10硬币\n概率判定均为正面\n持续一回合",cost:2,handle:function(e,t){e.data.coin>=10?(e.data.coin-=10,e.role.buff.of(0).add("strong_luck")):msg({content:"硬币不够了"})}},a008:{name:"千里炽云",detail:"附加燃烧*4\n附加流血*4",cost:2,aim:!0,handle:function(e,t){e.enermy.buff.of(t).add("burning",4),e.enermy.buff.of(t).add("bleed",4)}},a009:{name:"不干净之手",detail:"造成9伤害\n获得27硬币",cost:1,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("basecard").by({type:"static",value:9}),e.data.coin+=9}},a017:{name:"圣光",detail:"回复8生命\n将临时防御结界*16\n给予场上全体目标",cost:2,handle:function(e,t){e.role.heal.target(0).by({type:"static",value:8}),e.enermy.buff.addAll("interim_barrier",16),e.role.buff.of(0).add("interim_barrier",16)}},a021:{name:"制裁",detail:"丢弃一张手牌\n造成10群体伤害",cost:2,handle:function(e,t){e.handcard.getHolds().length>1?(e.enermy.damage.targetAll().source("basecard").by({type:"static",value:10}),e.handcard.abandon.amount(1).fromHolds()):msg({content:"手牌不足"})}},a022:{name:"大憩",detail:"回复12生命值",cost:2,handle:function(e,t){e.role.heal.target(0).by({type:"static",value:12})}},a023:{name:"深渊之殇",detail:"造成等同于自身当前生命50%的伤害",cost:2,aim:!0,handle:function(e,t){e.enermy.damage.target(t).source("basecard").by({type:"static",value:.5*e.role.state.of(0).get().Health})}},a024:{name:"节奏感",detail:"本场战斗中\n每使用一张通式\n回复5生命值",cost:3,interim:!0,handle:function(e,t){e.role.buff.of(0).add("rhythm")}},a025:{name:"魔豆",detail:"每回合回复4生命\n获得2额外灵力\n持续3回合",cost:1,interim:!0,handle:function(e,t){e.role.buff.of(0).add("magic_bean",3)}},a026:{name:"以血为刃",detail:"造成伤害时\n伤害+8，生命值-4\n持续一回合",cost:2,handle:function(e,t){e.role.buff.of(0).add("blood_blade",1)}},a012:{name:"傲慢",detail:"抽一张随机通式\n获得2额外灵力",cost:0,handle:function(e,t){e.handcard.insert.toHolds(Object.keys(Ve).rd()[0]),e.role.power.of(0).add(2)}},a013:{name:"强欲",detail:"抽两张牌",cost:2,handle:function(e,t){e.handcard.draw.amount(2).fromLeft()}},a014:{name:"暴怒",detail:"丢弃一张符卡\n普攻伤害+30%\n持续一回合",cost:2,handle:function(e,t){e.handcard.getHolds().filter((e=>"spellcard"==e.type)).length>0?(e.handcard.abandon.type("spellcard").amount(1).fromHolds(),e.role.buff.of(0).add("wrath")):msg({content:"符卡数量不足"})}},a015:{name:"暴食",detail:"获得额外灵力至上限\n最高20点",cost:2,interim:!0,handle:function(e,t){e.role.power.of(0).add(20)}},a016:{name:"色欲",detail:"指定目标下次行动为造成15%最大生命值的伤害",cost:2,aim:!0,handle:function(e,t){e.enermy.buff.of(t).add("lust")}},a018:{name:"怠惰",detail:"造成和上一张打出的牌同样的效果，对自身无效",cost:2,handle:function(e,t){let n=e.cache.last_card;n?n in Ve?Ve[n].handle(e,e.cache.last_target):Qe[n].handle(e,e.cache.last_target):msg({content:"你还一张牌都没打过"})}},a019:{name:"嫉妒",detail:"丢弃所有手牌\n抽取等量手牌",cost:2,handle:function(e,t){let n=e.handcard.getHolds().length;e.handcard.abandon.amount(n-1).fromHolds(),e.handcard.draw.amount(n).fromLeft()}},a000:{name:"谦逊",detail:"通式灵力消耗-1\n持续一回合",cost:1,handle:function(e,t){e.role.buff.of(0).add("humility")}},a005:{name:"贞洁",detail:"驱散自身随机负面效果\n回复8生命",cost:2,handle:function(e,t){let n=e.role.buff.of(0).getAll(),l=Object.keys(n).filter((e=>!n[e].positive)).rd()[0];e.role.buff.of(0).clear(l),e.role.heal.target(0).by({type:"static",value:8})}},a010:{name:"慷慨",detail:"丢弃一张牌\n抽两张牌",cost:0,handle:function(e,t){e.handcard.abandon.amount(1).fromHolds(),e.handcard.draw.amount(2).fromLeft()}},a011:{name:"耐心",detail:"每使用一张通式\n符卡伤害+20%\n持续一回合",cost:2,handle:function(e,t){e.cache.patience=!0}},a020:{name:"宽容",detail:"从弃牌堆中抽两张牌\n获得2额外灵力",cost:3,handle:function(e,t){e.handcard.draw.amount(2).fromUsed(),e.role.power.of(0).add(2)}},a027:{name:"节制",detail:"失去所有灵力\n下回合获得双倍\n额外灵力",cost:0,interim:!0,handle:function(e,t){let n=e.role.power.of(0).get();e.role.power.of(0).clear(),e.role.buff.of(0).add("charging",2*n)}},a028:{name:"勤奋",detail:"手牌灵力消耗+2\n效果翻倍\n持续一回合",cost:1,handle:function(e,t){e.role.buff.of(0).set("diligence",1)}},a029:{name:"散华之箭",detail:"造成10穿透伤害\n目标每有1种负面效果，伤害次数+1",cost:2,aim:!0,handle:function(e,t){let n=e.enermy.buff.of(t).count(!1);e.enermy.damage.target(t).source("basecard").by({type:"static",value:10,penetrate:!0,amount:1+n})}}};for(let e in Ve)Ve[e].type="basecard",Ve[e].role="base";var et={battleOnload:(e,t)=>{e.role.collection.link("philosophers_stone").to((e=>{t.equipmentLimit+=e})),e.role.souvenir.link("ahabs_opinion").to((t=>{let n=e.role.state.of(0).get();e.role.state.of(0).set("health",.7*n.health),e.role.state.of(0).set("Health",.7*n.health)})),e.statistics.resetRoundData()},roleOnload:(e,t)=>{e.role.collection.link("paper_windmill").to((n=>{e.role.state.of(0).set("power",e.role.state.of(0).get().power+n),e.role.power.of(0).reset(),t.exPowerLimit+=n})),e.role.collection.link("seal_needle").to((t=>{e.role.buff.of(0).set("seal_needle",8)})),e.role.souvenir.link("ahab's_opinion").to((t=>{let n=Math.floor(.7*e.role.state.of(0).get().health);e.role.state.of(0).set("health",n),e.role.state.of(0).set("Health",n)})),e.role.collection.link("frozen_frog").to((t=>{e.role.buff.of(0).set("baka",t)}))},enermyOnload:(e,t)=>{},probability:(e,t)=>{"reimu"==e.data.role&&(t.probability=1-Math.pow(1-t.probability,2)),e.role.collection.link("ace").to((e=>{t.probability=1-Math.pow(1-t.probability,e+1)})),e.role.buff.of(0).link("strong_luck").to((e=>{t.probability=1}))},roleStateGet:(e,t)=>{e.role.buff.of(t.target).link("tardy").to((e=>{t.state.speed*=Math.pow(.95,e)})),e.role.collection.link("corvis_feathers").to((n=>{Object.keys(e.role.buff.of(0).getAll()).length>=2&&(t.state.speed+=.1*n)})),e.role.collection.link("burning_seashore_flower").to((e=>{t.state.speed+=.01*e*Math.floor(100*(1-t.state.Health/t.state.health))})),e.role.collection.link("flip_flops").to((n=>{let l=e.role.power.of(0).getExPower();t.state.speed+=.2*n*l})),e.role.buff.of(t.target).link("baka").to((e=>{t.state.speed+=.25*e})),e.role.buff.of(t.target).link("accelerate").to((e=>{t.state.speed+=.1*e})),e.role.buff.of(t.target).link("eight_dragon_kill").to((e=>{t.state.speed-=1}))},enermyStateGet:(e,t)=>{e.enermy.buff.of(t.target).link("tardy").to((e=>{t.state.speed*=Math.pow(.95,e)})),e.enermy.buff.of(t.target).link("accelerate").to((e=>{t.state.speed+=.1*e}))},roleBuffGet:(e,t)=>{e.role.collection.link("fish_stone").to((e=>{t.buff.positive||(t.amount-=e)}))},handcardOnload:(e,t)=>{e.role.souvenir.link("wanderlust").to((e=>t.limit=3)),e.role.collection.link("patchoulis_ribbon").to((t=>{let n=e.handcard.getAll(),l=n.map((e=>e.cost)),a=Math.max(...l),o=n.filter((e=>e.cost==a)),r=o.rd()[0].key;e.handcard.setCost.byKey(r,-Math.min(a,t))}))},roleRoundStart:(e,t)=>{let n=e.role.state.of(0).get();"marisa"==e.data.role&&e.role.power.of(0).add(4),e.cache.open_universe&&(e.role.buff.of(0).add("insulation"),delete e.cache.open_universe,t.powerReset=!1),e.cache.super_perseids&&(e.role.buff.of(0).add("strength",e.cache.super_perseids-1),delete e.cache.super_perseids),e.cache.escape_velocity&&e.role.buff.of(0).add("accelerate",6),delete e.cache.patience,e.role.collection.link("terrible_ring").to((t=>{e.role.buff.of(0).set("slow_power",e.role.event.round.count*t)})),e.role.buff.of(0).link("pure_happy").to((t=>{e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:t,penetrate:!0})})),e.role.buff.of(0).link("burning").to((t=>{e.role.state.of(0).set("Health",e.role.state.of(0).get().Health*(1-.03*t))})),e.role.buff.of(0).link("orrerys_sun").to((t=>{e.role.buff.of(0).clear("orrerys_sun"),e.cache.orrerys_sun.forEach((t=>{t.damage.value*=1.2,t.damage.amount=1,e.enermy.damage.target(t.target).source("spellcard").by(t.damage)})),delete e.cache.orrerys_sun})),e.role.buff.of(0).link("hypodynamic").to((n=>{t.powerReset=!1,e.role.power.of(0).clear()})),e.role.buff.of(0).link("in_treatment").to((t=>{e.role.heal.target(0).by({type:"static",value:e.role.state.of(0).get().Health*t*.05})})),e.role.buff.of(0).link("magic_bean").to((t=>{e.role.power.of(0).add(2),e.role.heal.target(0).by({type:"static",value:4})})),e.role.buff.of(0).link("charging").to((t=>{e.role.power.of(0).add(t)})),e.role.buff.of(0).link("tired").to((e=>{t.offset-=e})),e.role.buff.of(0).link("bleed").to((t=>{e.role.damage.target(0).by({type:"static",value:t,final:!0})})),e.role.buff.of(0).link("spirit_poison").to((t=>{e.role.damage.target(0).by({type:"static",value:.05*n.Health*t,final:!0}),e.role.buff.of(0).add("trance",t)})),e.role.buff.of(0).link("waiting_pearl").to((t=>{e.role.buff.of(0).add("pure_happy",12),e.handcard.draw.amount(2).fromLeft()})),e.role.event.round.count>1&&e.role.buff.of(0).clear("baka",1),e.role.souvenir.link("wanderlust").to((t=>{let n=e.role.state.of(0).get().speed;e.role.power.of(0).add(Math.ceil(n))})),e.statistics.saveRoundData(),e.statistics.resetRoundData()},handcardRefresh:(e,t)=>{e.role.souvenir.link("wanderlust").to((e=>t.holdLimit=4)),e.role.equipment.link("repentance_rod").to((n=>{t.drawAmount>=t.drawLimit&&e.role.power.of(0).add(t.drawAmount)})),e.role.collection.link("blade_of_yellow_spring").to((e=>{t.drawLimit+=e}))},handcardLeftReset:(e,t)=>{},afterRoleRoundStart:(e,t)=>{e.role.collection.link("blade_of_yellow_spring").to((t=>{e.handcard.insert.interim(!0).amount(t).toHolds(e.data.role)}))},beforePowerCost:(e,t)=>{if(e.role.buff.of(0).link("throttle").to((e=>{t.cost=Math.max(0,t.cost-e)})),e.role.buff.of(0).link("diligence").to((e=>{t.cost+=2})),e.role.buff.of(0).link("humility").to((e=>{"basecard"==t.card.type&&(t.cost-=e)})),e.role.equipment.link("mirror_of_pear").to((n=>{t.card.key==e.data.role&&(t.cost=0)})),e.role.souvenir.link("mimicry_cat_pendant").to((n=>{e.cache.mimicry_cat_pendant=t.cost,t.cost=0})),"reimu"==e.data.role&&e.role.power.of(0).get()<t.cost&&(e.cache.reimu_cost=t.cost-e.role.power.of(0).get(),t.cost=e.role.power.of(0).get()),"a021"==t.card.key&&e.handcard.getHolds().length<=1&&(t.valid=!1),"a014"==t.card.key){0==e.handcard.getHolds().filter((e=>"spellcard"==e.type)).length&&(t.valid=!1)}"a010"==t.card.key&&e.handcard.getHolds().length<=1&&(t.valid=!1),"a018"==t.card.key&&(e.cache.last_card&&"a018"!=e.cache.last_card||(t.valid=!1)),"r013"==t.card.key&&(e.cache.pure_happy_cost||(e.cache.pure_happy_cost=1),e.role.buff.of(0).get("pure_happy")<e.cache.pure_happy_cost&&(t.valid=!1)),"r026"!=t.card.key&&"r034"!=t.card.key||e.role.buff.of(0).get("pure_happy")||(t.valid=!1),"r027"==t.card.key&&e.handcard.getHolds().length<=1&&(t.valid=!1),e.cache.round_cost_total+=t.cost},punchCard:(e,t)=>{if("reimu"==e.data.role&&e.cache.reimu_cost){let t=e.role.state.of(0).get();e.role.state.of(0).set("health",t.health-2*e.cache.reimu_cost)}e.role.souvenir.link("mimicry_cat_pendant").to((t=>{e.role.state.of(0).set("Health",e.role.state.of(0).get().Health*(1-.1*e.cache.mimicry_cat_pendant))})),"youmu"==e.data.role&&e.role.buff.of(0).add("telepathism",t.cost),e.role.collection.link("shy_rabbit").to((t=>{e.cache.shy_rabbit?e.cache.shy_rabbit++:e.cache.shy_rabbit=1,2==e.cache.shy_rabbit&&e.role.buff.of(0).add("shy_rabbit",t),3==e.cache.shy_rabbit&&e.role.buff.of(0).clear("shy_rabbit"),4==e.cache.shy_rabbit&&(e.cache.shy_rabbit=1)})),e.role.collection.link("seal_needle").to((t=>{e.role.buff.of(0).get("seal_needle")||e.battle.effect.targetEnermy(0).by((t=>{e.role.buff.of(0).set("seal_needle",8)}))})),e.role.collection.link("light_bulb").to((n=>{let l=e.role.power.of(0).get();l<n&&l+t.cost>=n&&e.handcard.draw.amount(1).fromLeft()})),"spellcard"==t.type&&(e.cache.super_perseids&&e.cache.super_perseids++,e.role.equipment.link("circular_fan").to((t=>{e.handcard.insert.interim(!0).toHolds(e.data.role)})),e.role.buff.link("yinyang_bird").to((t=>{e.probability(.3)&&(e.role.power.of(0).add(2),e.role.buff.of(0).add("pure_happy",3))}))),"basecard"==t.type&&(e.role.buff.of(0).link("rhythm").to((t=>{e.role.heal.target(0).by({type:"static",value:5*t})})),e.cache.patience&&e.role.buff.of(0).add("focus",2)),e.cache.pulsar_star&&(2==e.cache.pulsar_star?e.cache.pulsar_star--:(e.handcard.insert.interim(!0).toHolds(t.card.key),delete e.cache.pulsar_star)),e.role.buff.of(0).link("diligence").to((n=>{t.card.handle(e,t.target)})),e.cache.magic_link&&(t.valid=!1,e.role.heal.target(0).by({type:"static",value:8}),e.role.buff.of(0).add("pure_happy",6)),e.cache.round_punch_count++,t.card.interim&&e.cache.round_expend_count++},rolePowerAdd:(e,t)=>{e.role.buff.of(0).link("insulation").to((e=>t.amount=0))},enermyDamagedProcess:(e,t)=>{if(!t.damage.final&&t.damage.value>0){if(t.source){e.role.buff.of(0).link("orrerys_sun").to((n=>{e.cache.orrerys_sun||(e.cache.orrerys_sun=[]),t.damage.indirect||(t.damage.indirect=!0,t.damage.orrerys_sun=!0)})),e.role.buff.of(0).link("milky_way").to((e=>{t.damage.value+=e})),e.role.buff.of(0).link("blood_blade").to((n=>{t.damage.value+=8,e.role.damage.target(0).source("basecard").by({type:"static",value:4})}));let n=.05,l=.5;e.role.collection.link("fluorescent_zanthoxylum").to((e=>{n+=.05*e})),e.role.collection.link("burning_seashore_flower").to((t=>{let l=e.role.state.of(0).get();n+=.002*t*Math.floor(100*(1-l.Health/l.health))})),e.role.collection.link("human_soul_lamp").to((e=>{l+=.6*e})),e.role.buff.of(0).link("slow_power").to((e=>{n+=.04*e})),e.role.buff.of(0).link("marisa_time").to((e=>{n+=.3})),e.role.buff.of(0).link("grand_cross").to((e=>{l+=1})),"youmu"==e.data.role&&(l+=n,n=0);let a=e.probability(n);t.damage.indirect&&(a=!1),a||t.damage.critical?(t.damage.critical=!0,t.damage.value*=1+l,e.role.collection.link("free_eagle").to((t=>{e.cache.free_eagle?(e.cache.free_eagle=!1,e.role.buff.of(0).clear(!1,t)):e.cache.free_eagle=!0})),t.damage.seal_array&&e.role.state.of(0).add("health",8)):t.damage.undifferentiated_subduction&&e.role.buff.of(0).add("pure_happy",8),e.role.collection.link("bronze_mirror").to((n=>{t.damage.bronze_mirror||e.probability(.25)&&e.enermy.damage.except(t.target).random().from(0).source("collection").by({type:"scale",value:.3*n*t.damage.value,indirect:!0,bronze_mirror:!0})})),e.role.collection.link("ice_scale").to((n=>{e.probability(.1*n)&&e.enermy.buff.of(t.target).add("tardy",1)})),e.role.collection.link("skyrocket").to((n=>{e.probability(.3)&&"normal_attack"==t.source&&(e.enermy.damage.target(t.target).source("collection").by({type:"static",value:.4*t.damage.value,indirect:!0}),e.role.power.of(0).add(n))})),e.role.collection.link("seal_needle").to((n=>{e.role.buff.of(0).get("seal_needle")||e.enermy.buff.of(t.target).add("bleed",n)})),e.role.collection.link("JupiterACL300").to((n=>{if(!t.damage.indirect){let l=e.enermy.survival(),a=l.indexOf(t.target),o=[a-1,a+1];if(a==l.length-1&&o.pop(),0==a&&o.shift(),o.length>0){let a=o.map((e=>l[e]));e.enermy.damage.targetMuti(a).source("collection").by({type:"static",value:t.damage.value*n*.25,indirect:!0})}}})),e.role.buff.of(0).link("test_slave").to((n=>{let l=.25*t.damage.value*n;e.cache.test_slave||(e.cache.test_slave=[]),e.cache.test_slave.push(l),t.damage.value-=l})),e.role.buff.of(0).link("font_safe").to((t=>{e.role.heal.target(0).by({type:"static",value:5}),e.role.buff.of(0).add("trance",2)})),e.cache.koakuma&&e.cache.koakuma[t.target]&&e.role.damage.target(0).from(t.target).by({type:"static",value:t.damage.value}),e.role.collection.link("portable_money_box").to((n=>{t.damage.value*=1+.05*n*Math.floor(e.data.coin/250)})),e.role.collection.link("compass_cat").to((n=>{e.enermy.state.of(t.target).get().speed<e.role.state.of(0).get().speed&&(t.damage.value*=1+.1*n)})),e.role.collection.link("sundial").to((e=>{t.damage.indirect&&(t.damage.value*=1+.1*e)})),e.role.collection.link("pickled_radish").to((n=>{let l=e.role.state.of(0).get();l.Health/l.health>.9&&(t.damage.value*=1+.1*n)})),e.role.collection.link("false_hammer").to((n=>{"normal"==e.enermy.info.of(t.target).get().type&&(t.damage.value*=1+.1*n)})),e.role.collection.link("shy_rabbit").to((n=>{3==e.cache.shy_rabbit&&(t.damage.value*=1+.1*n)})),e.role.collection.link("midnight_cloak").to((n=>{let l=e.enermy.state.of(t.target).get();l.Health/l.health<.5&&(t.damage.value*=1+.1*n)})),e.role.buff.of(0).link("focus").to((e=>{"spellcard"==t.source&&(t.damage.value*=1+.2*e)})),e.role.buff.of(0).link("weak").to((e=>{t.damage.value*=1-.1*e})),e.role.buff.of(0).link("strength").to((e=>{t.damage.value*=1+.1*e})),e.role.buff.of(0).link("interim_strength").to((e=>{t.damage.value*=1+.1*e})),e.role.buff.of(0).link("wrath").to((e=>{"normal_attack"==t.source&&(t.damage.value*=1+.3*e)})),e.role.buff.of(0).link("big_bad_sun").to((e=>{t.damage.value*=.1})),e.role.equipment.link("sword_of_feixiang").to((n=>{e.enermy.buff.of(t.target).count(!1)>0&&(t.damage.value*=1.4)}))}e.enermy.buff.of(t.target).link("fragile").to((e=>{t.damage.value*=1+.1*e})),e.enermy.buff.of(t.target).link("exposure").to((e=>{t.damage.penetrate=!0})),e.enermy.buff.of(t.target).link("iron_skin").to((e=>{t.damage.value*=1-.1*e})),t.damage.penetrate||(e.enermy.buff.of(t.target).link("natral_protect").to((n=>{t.damage.value=5,e.role.buff.of(0).add("bleed",2)})),e.enermy.buff.of(t.target).link("interim_barrier").to((n=>{n<t.damage.value?(t.damage.value-=n,e.enermy.buff.of(t.target).clear("interim_barrier")):(e.enermy.buff.of(t.target).clear("interim_barrier",Math.ceil(t.damage.value)),t.damage.value=0)})),e.enermy.buff.of(t.target).link("barrier").to((n=>{n<t.damage.value?(t.damage.value-=n,e.enermy.buff.of(0).clear("barrier")):(e.enermy.buff.of(0).clear("barrier",Math.ceil(t.damage.value)),t.damage.value=0)})),e.enermy.buff.of(t.target).link("qianzhidun").to((n=>{t.damage.value<n/2&&(t.damage.value/=2),n<t.damage.value?(t.damage.value-=n,e.enermy.buff.of(t.target).clear("qianzhidun")):(e.enermy.buff.of(t.target).clear("qianzhidun",Math.ceil(t.damage.value)),t.damage.value=0)})),e.enermy.buff.of(t.target).link("foresee").to((e=>{t.damage.miss=!0}))),t.damage.value<=0&&(t.damage.blocked=!0),t.damage.final=!0,t.damage.penetrate||(t.damage.precision||(t.damage.precision=1),e.role.buff.of(0).link("trance").to((e=>{t.damage.precision*=1-.1*e})),e.enermy.buff.of(t.target).link("cautious").to((e=>{t.damage.precision*=1-.1*e})),e.probability(t.damage.precision)?t.damage.jump_jade&&e.role.heal.target(0).by({type:"static",value:4}):(t.damage.miss=!0,t.damage.dream_seal&&e.role.buff.of(0).add("pure_happy",5),t.damage.ghost_breaker&&e.role.buff.of(0).add("interim_barrier",12),t.damage.faith_needle&&e.handcard.draw.amount(2).fromLeft(),t.damage.jump_jade&&e.role.state.of(0).add("health",4))),e.role.buff.of(0).link("orrerys_sun").to((n=>{if(t.damage.orrerys_sun){for(let l of Array(n))e.cache.orrerys_sun.push(deepCopy(t));t.damage.blocked=!0}})),t.damage.fatal&&(t.damage.value=e.enermy.state.of(t.target).get().Health,delete t.damage.miss,delete t.blocked)}if(e.cache.narumi&&e.cache.narumi[t.target]){let n=e.cache.narumi[t.target],l=e.enermy.state.of(t.target).get();if(l.health>l.Health&&t.damage.value>=l.Health){e.cache.narumi[t.target]++;let a=l.health*(1-.2*n);e.enermy.state.of(t.target).set("health",a),e.enermy.state.of(t.target).set("Health",a),t.damage.blocked=!0,e.enermy.buff.of(t.target).set("magic_life",n)}}if(tt(t.damage)){let n=e.enermy.state.of(t.target).get();t.source&&(e.role.collection.link("cursed_wind_chimes").to((n=>{t.damage.value>50-n&&e.enermy.buff.of(t.target).clearAll()})),e.role.equipment.link("gongonier").to((n=>{t.damage.critical&&e.role.heal.target(0).from(0).by({type:"static",value:.2*t.damage.value})})),e.role.buff.of(0).clear("seal_needle",1),e.role.collection.link("vampires_old_tooth").to((n=>{e.enermy.buff.of(t.target).count(!0)>0&&e.role.heal.target(0).by({type:"static",value:n})})),e.role.collection.link("earthy_spider_wine").to((n=>{"normal_attack"==t.source&&e.role.buff.of(0).set("focus",n)})),e.role.collection.link("bottle_of_stars").to((n=>{if(t.damage.value>40){e.enermy.buff.of(t.target).add("star",n),e.cache.bottle_of_stars||(e.cache.bottle_of_stars=[]);for(let l=0;l<n;l++)e.cache.bottle_of_stars.push({target:t.target,damage:.4*t.damage.value})}})),t.damage.dragon_meteor&&(1==t.damage.dragon_meteor&&n.Health<=t.damage.value&&(e.cache.dragon_meteor=!0,e.role.buff.of(0).add("interim_strength",5)),2==t.damage.dragon_meteor&&(e.cache.dragon_meteor?delete e.cache.dragon_meteor:n.Health<=t.damage.value&&e.role.buff.of(0).add("interim_strength",5))),t.damage.jade_dance&&n.Health<=t.damage.value&&e.handcard.draw.amount(2).fromLeft(),e.enermy.buff.of(t.target).link("poison_body").to((t=>{e.role.buff.of(0).add("spirit_poison",1)})),e.cache.round_damage_frequency++,e.cache.round_damage_total+=t.damage.value,e.cache.round_max_damage=Math.max(t.damage.value,e.cache.round_max_damage)),e.role.collection.link("crown_of_thorns").to((n=>{0==e.battle.round.get()&&e.enermy.buff.of(t.target).add("fragile",n)}))}},roleHealProcess:(e,t)=>{e.role.collection.link("sakura_tea").to((e=>{t.heal.value*=1+.1*e})),e.role.collection.link("water_joke").to((n=>{let l=t.heal.value;e.role.damage.target(0).by({type:"static",value:l}),t.heal.value=0})),e.role.buff.of(0).link("big_bad_sun").to((e=>{t.heal.value*=2}));let n=e.role.state.of(0).get(),l=t.heal.value+n.Health-n.health;e.role.collection.link("sticking_plaster").to((t=>{if(l>0){let n=Math.floor(.2*t*l);e.role.buff.of(0).add("interim_barrier",n)}}))},useEquipment:function(e,t){e.role.collection.link("toolbox").to((t=>{e.probability(.2*t)&&this.defeatEnermy(e)}))},useSouvenir:function(e,t){e.role.collection.link("toolbox").to((t=>{e.probability(.2*t)&&this.defeatEnermy(e)}))},drawCard:(e,t)=>{e.role.collection.link("shimenawa").to((t=>{e.probability(.25*t)&&e.battle.equipment.left.add(1)})),e.role.equipment.link("repentance_rod").to((n=>{t.amount>=t.drawLimit&&e.role.power.of(0).add(t.amount)}))},defeatEnermy:(e,t)=>{e.role.collection.link("bird_wine").to((t=>{e.enermy.buff.addAll("burning",2*t)})),e.role.collection.link("trolley").to((t=>{e.role.power.of(0).add(t)})),"marisa"==e.data.role&&e.role.heal.target(0).by({type:"static",value:8})},roleRoundEnd:(e,t)=>{e.role.collection.link("big_bugle").to((t=>{e.enermy.damage.targetAll().source("collection").by({type:"static",value:2*t,penetrate:!0,indirect:!0})})),e.role.collection.link("ghost_lantern").to((t=>{let n=e.role.power.of(0).get();n>0&&e.role.buff.of(0).add("interim_barrier",t*n)})),e.role.buff.of(0).link("test_slave").to((t=>{e.cache.test_slave||(e.cache.test_slave=[]),e.enermy.damage.targetAll().source("spellcard").by({type:"static",value:e.cache.test_slave.sum()}),delete e.cache.test_slave,e.role.buff.of(0).clear("test_slave")})),e.role.buff.of(0).link("blue_poison").to((t=>{e.role.damage.target(0).by({type:"static",value:t,indirect:!0})})),e.role.souvenir.link("cerallins_bottle").to((t=>{let n=e.handcard.getHolds().length;e.handcard.abandon.amount(n).fromHolds(),e.role.power.of(0).add(n)}))},enermyRoundStart:(e,t)=>{let n=e.enermy.state.of(t.target).get();e.cache.koakuma&&e.cache.koakuma[t.target]&&e.enermy.buff.of(t.target).clear("iron_skin"),e.enermy.buff.of(t.target).link("burning").to((l=>{e.enermy.damage.target(t.target).by({type:"static",value:.03*n.health*l,final:!0})})),e.enermy.buff.of(t.target).link("star").to((n=>{let l=e.cache.bottle_of_stars.filter((e=>e.target==t.target));for(let n of l)e.enermy.damage.target(t.target).source("collection").by({type:"static",value:n.damage,indirect:!0,final:!0});e.enermy.buff.of(t.target).clear("star"),e.cache.bottle_of_stars=e.cache.bottle_of_stars.filter((e=>e.target!=t.target))})),e.enermy.buff.of(t.target).link("bleed").to((n=>{e.enermy.damage.target(t.target).by({type:"static",value:n,final:!0})})),e.enermy.buff.of(t.target).clear("tardy",1),e.enermy.buff.of(t.target).clear("fragile")},enermyAction:(e,t)=>{e.enermy.buff.of(t.index).link("lust").to((n=>{t.valid=!1,e.role.damage.target(0).from(t.index).by({type:"static",value:.2*e.enermy.state.of(t.index).get().health})})),e.enermy.buff.of(t.index).link("trance_cage").to((n=>{t.valid=!1,e.role.buff.of(0).add("trance",3)}))},roleDamagedProcess:(e,t)=>{if(e.role.buff.of(0).link("exposure").to((e=>{t.damage.penetrate=!0})),e.role.collection.link("mimosa").to((n=>{let l=.7*e.role.state.of(0).get().health*Math.pow(.95,n-1);t.damage.value=Math.min(t.damage.value,l)})),e.role.collection.link("amulet_of_full_moon").to((n=>{e.role.buff.of(0).count(!1)>=2&&(t.damage.value*=Math.pow(.9,n))})),e.role.buff.of(0).link("iron_skin").to((e=>{t.damage.value*=1-.1*e})),e.role.buff.of(0).link("fragile").to((e=>{t.damage.value*=1+.1*e})),e.role.buff.of(0).link("eight_dragon_kill").to((e=>{t.damage*=.7})),e.role.souvenir.link("nodas_hat").to((n=>{let l=e.role.state.of(0).get();l.Health/l.health>.5&&(t.damage.value*=1.2),l.Health/l.health<.5&&(t.damage.value*=.7)})),"number"==typeof t.from&&(e.enermy.buff.of(t.from).link("strength").to((e=>{t.damage.value*=1+.1*e})),e.enermy.buff.of(t.from).link("interim_strength").to((e=>{t.damage.value*=1+.1*e}))),e.role.collection.link("conch_shell").to((e=>{t.damage.value-=e})),t.damage.penetrate||(e.role.buff.of(0).link("interim_barrier").to((n=>{n<t.damage.value?(t.damage.value-=n,e.role.buff.of(0).clear("interim_barrier")):(e.role.buff.of(0).clear("interim_barrier",Math.ceil(t.damage.value)),t.damage.value=0)})),e.role.buff.of(0).link("barrier").to((n=>{n<t.damage.value?(t.damage.value-=n,e.role.buff.of(0).clear("barrier")):(e.role.buff.of(0).clear("barrier",Math.ceil(t.damage.value)),t.damage.value=0)})),e.role.souvenir.link("aokis_fish").to((n=>{e.probability(.3)?t.damage.blocked=!0:e.role.buff.of(0).add(["tired","tardy","fragile","weak","trance"].rd()[0])})),e.role.buff.of(0).link("foresee").to((e=>{t.damage.miss=!0})),e.role.buff.of(0).link("prophesy").to((e=>{t.damage.miss=!0}))),t.damage.value<=0&&(t.damage.blocked=!0),t.damage.final=!0,"number"==typeof t.from&&!t.damage.penetrate){let n=1;e.role.buff.of(0).link("hakurei_phantom").to((e=>{n*=.6})),e.enermy.buff.of(t.from).link("trance").to((e=>{n*=1-.1*e})),e.probability(1-n)&&(t.damage.miss=!0,e.role.buff.of(0).link("hakurei_phantom").to((t=>{e.role.buff.of(0).add("pure_happy",4)})))}tt(t.damage)&&(e.role.collection.link("large_roll_of_bandages").to((t=>{e.role.buff.of(0).add("in_treatment",t)})),e.role.collection.link("sport_shoes").to((n=>{t.damage.value>20-n&&(e.handcard.draw.amount(1).fromLeft(),e.role.power.of(0).add(1))})),e.role.collection.link("red_and_white_scarf").to((n=>{let l=e.role.state.of(0).get();l.Health<t.damage.value&&l.Health/l.health>.3*Math.pow(.9,n-1)&&(t.damage.blocked=!0,e.role.state.of(0).set("Health",1))})),"number"==typeof t.from&&e.role.collection.link("magic_dart").to((n=>{e.enermy.damage.target(t.from).source("collection").by({type:"static",value:.2*n*t.damage.value,indirect:!0})})),e.role.buff.of(0).link("pure_happy").to((n=>{e.role.buff.of(0).clear("pure_happy",retain(t.damage.value-2,0))})),e.cache.round_max_hurt=Math.max(t.damage.value,e.cache.round_max_hurt),e.cache.round_hurt_total+=t.damage.value,e.cache.round_hurt_frequency++)}};function tt(e){return!e.blocked&&!e.miss&&e.value>0}function nt(t){let n,l,a,o,r,s,i,d,f,m,h,p,g,y,v,k,_,$,M,C,H,q,L=(t[5]?t[5].name:t[15][t[1]].name)+"",z=(t[5]?0:t[13])+"",S=(t[5]?t[5].detail:t[15][t[1]].detail)+"";return{c(){n=j("div"),l=j("img"),o=T(),r=j("div"),s=j("icon"),d=T(),f=j("txt"),m=O(L),h=T(),p=j("div"),g=j("txt"),y=O(z),k=T(),_=j("div"),$=j("txt"),M=O(S),c(l.src,a="/img/lotr_hobbit_stamp.svg")||A(l,"src","/img/lotr_hobbit_stamp.svg"),A(l,"class","svelte-1qwug6b"),A(s,"class",i="icon-"+(t[5]?"logo":"base"==t[14]?"base":t[1])+" svelte-1qwug6b"),A(f,"class","name svelte-1qwug6b"),A(g,"class","svelte-1qwug6b"),A(p,"class",v="cost "+(!t[5]&&t[3]&&"interim")+" svelte-1qwug6b"),A(r,"class","content svelte-1qwug6b"),A($,"class","svelte-1qwug6b"),A(_,"class","detail svelte-1qwug6b"),A(n,"class",C=u(`card ${t[5]?"cover":t[14]} ${t[6]&&"used"} ${t[10]&&"ready"} ${!t[2]&&"animateOff"} ${t[11]&&"drag"} ${t[4]&&"abandoned"}`)+" svelte-1qwug6b"),A(n,"style",H="transform:"+("rotate"in t[0]?`rotate(${t[0].rotate}deg)`:"")+"translate("+t[0].x+"px, "+t[0].y+"px)"+("scale"in t[0]?`scale(${t[0].scale})`:"")+";transition:"+(t[2]?t[9]:"none")+";"+t[7]+";")},m(e,a){x(e,n,a),b(n,l),b(n,o),b(n,r),b(r,s),b(r,d),b(r,f),b(f,m),b(r,h),b(r,p),b(p,g),b(g,y),t[19](p),b(n,k),b(n,_),b(_,$),b($,M),t[20](n)},p(e,[t]){16418&t&&i!==(i="icon-"+(e[5]?"logo":"base"==e[14]?"base":e[1])+" svelte-1qwug6b")&&A(s,"class",i),34&t&&L!==(L=(e[5]?e[5].name:e[15][e[1]].name)+"")&&E(m,L),8224&t&&z!==(z=(e[5]?0:e[13])+"")&&E(y,z),40&t&&v!==(v="cost "+(!e[5]&&e[3]&&"interim")+" svelte-1qwug6b")&&A(p,"class",v),34&t&&S!==(S=(e[5]?e[5].detail:e[15][e[1]].detail)+"")&&E(M,S),19572&t&&C!==(C=u(`card ${e[5]?"cover":e[14]} ${e[6]&&"used"} ${e[10]&&"ready"} ${!e[2]&&"animateOff"} ${e[11]&&"drag"} ${e[4]&&"abandoned"}`)+" svelte-1qwug6b")&&A(n,"class",C),645&t&&H!==(H="transform:"+("rotate"in e[0]?`rotate(${e[0].rotate}deg)`:"")+"translate("+e[0].x+"px, "+e[0].y+"px)"+("scale"in e[0]?`scale(${e[0].scale})`:"")+";transition:"+(e[2]?e[9]:"none")+";"+e[7]+";")&&A(n,"style",H)},i(e){q||Z((()=>{q=ue(n,$e,{duration:250}),q.start()}))},o:e,d(e){e&&w(n),t[19](null),t[20](null)}}}function lt(e,t,n){let l,a,o,r;d(e,Me,(e=>n(21,o=e))),d(e,ze,(e=>n(22,r=e)));let s,i,c,u=Object.assign(deepCopy(Qe),deepCopy(Ve)),{key:f}=t,{action:m=(e=>null)}=t,{select:h=(e=>null)}=t,{cost:p=!1}=t,{transform:g={}}=t,{animate:y=!0}=t,{interim:v=u[f].interim}=t,{abandoned:b=!1}=t,{cover:k=!1}=t,_=!1,x="0.3s",w=!1,$=!1;return K((e=>{n(8,i.onmouseenter=e=>{n(0,g.scale=1.1,g);let t=e=>{n(0,g.scale=1,g)};n(8,i.onmouseleave=t,i),n(8,i.ontouchend=t,i)},i);let t=e=>{n(11,$=!0),h(!0);const l=deepCopy(g);e.x||(e.x=e.touches[0].pageX),e.y||(e.y=e.touches[0].pageY);const a=e.x,o=e.y;n(0,g.rotate=0,g),n(0,g.y+=Math.sin(l.rotate/180*Math.PI)*l.x,g),n(0,g.x-=Math.tan(l.rotate/180*Math.PI)*l.y,g),n(0,g.scale=1.1,g),n(7,s="z-index:100;");let c=e=>{e.x||(e.x=e.touches[0].pageX),e.y||(e.y=e.touches[0].pageY),n(10,w="number"==typeof r.enermy.checkForPosition(e));let t=e.x-a,l=e.y-o;n(9,x="transform 0.3s"),r.battle.round.get()&&(r.mobile?n(7,s=`left:${235+l/r.mobile}px;top:${-t/r.mobile}px;z-index:100;`):n(7,s=`left:${235+t}px;top:${l}px;z-index:100;`))};n(8,i.onmousemove=c,i),n(8,i.ontouchmove=c,i);const d=e=>{n(10,w=!1),n(11,$=!1),i&&(n(8,i.onmousedown=t,i),n(8,i.onmousemove=null,i),n(8,i.onmouseup=null,i),n(8,i.onmouseleave=null,i),n(8,i.ontouchstart=t,i),n(8,i.ontouchmove=null,i),n(8,i.ontouchend=null,i)),h(!1),n(0,g=l),n(0,g.scale=1,g),n(9,x="0.3s"),n(7,s="left:235px;top:0px;")};let u=e=>{e.x||(e.x=e.changedTouches[0].pageX),e.y||(e.y=e.changedTouches[0].pageY);let t=r.handcard.Cost();if(!1===t)d(),msg({content:"条件不足"});else if(r.role.power.of(0).get()>=t){let t=r.enermy.checkForPosition(e);"number"==typeof t?(n(8,i.onmousedown=null,i),n(8,i.onmousemove=null,i),n(8,i.onmouseleave=null,i),n(6,_=!0),m(t),setTimeout((e=>{n(6,_=!1),d()}),500)):d()}else d(),msg({content:"灵力不足"})};n(8,i.onmouseup=u,i),n(8,i.ontouchend=u,i),n(8,i.onmouseleave=d,i)};0==Object.keys(g).length&&(t=e=>null),n(8,i.onmousedown=t,i),n(8,i.ontouchstart=e=>{n(0,g.scale=1.1,g),t(e)},i)})),N((e=>{_&&(n(0,g.scale=1.1,g),n(10,w=!0)),v&&c&&o(c).with({name:"一次性",detail:"这张牌是消耗品，打出后不会再抽到。"})})),e.$$set=e=>{"key"in e&&n(1,f=e.key),"action"in e&&n(16,m=e.action),"select"in e&&n(17,h=e.select),"cost"in e&&n(18,p=e.cost),"transform"in e&&n(0,g=e.transform),"animate"in e&&n(2,y=e.animate),"interim"in e&&n(3,v=e.interim),"abandoned"in e&&n(4,b=e.abandoned),"cover"in e&&n(5,k=e.cover)},e.$$.update=()=>{2&e.$$.dirty&&n(14,l=Object.keys(Qe).includes(f)?Qe[f].role:"base"),262146&e.$$.dirty&&n(13,a="number"==typeof p?p:u[f].cost)},[g,f,y,v,b,k,_,s,i,x,w,$,c,a,l,u,m,h,p,function(e){Y[e?"unshift":"push"]((()=>{c=e,n(12,c)}))},function(e){Y[e?"unshift":"push"]((()=>{i=e,n(8,i)}))}]}class at extends _e{constructor(e){super(),ke(this,e,lt,nt,s,{key:1,action:16,select:17,cost:18,transform:0,animate:2,interim:3,abandoned:4,cover:5})}}var ot=[{name:"核心机制",detail:"没有任何直接提升面板的手段，生命值且不说，攻击力这样的属性完全见不到是吧，不过消耗品就另当别论了，毕竟是消耗品。\n不过，敌人变强的方式就是单纯的堆面板了，自身的机制不会有啥变化。\n角色要变强只能拿道具，探索出路了，简单粗暴的固定减伤海螺壳，一直堆叠的性价比是越来越低的哦，可想而知敌人的面板是怎样在增长。"},{name:"普攻、符卡和通式",detail:"战斗开始时有好多张的就是普攻，统一灵力消耗是1，伤害是血量的六分之一左右，附带一些特殊效果。\n通式就是卡面千篇一律的那些，并非角色特有，一些在任何场合都能出现，一些只在某个场景出现，一些则只在某些事件中出现。\n其他的就是符卡了。"},{name:"自然灵力和额外灵力",detail:"统称叫灵力，唯一的区别是自然灵力在回合开始时会回复到上限，而额外灵力用掉了就没有了，以及额外灵力是优先消耗的。\n只有在必要的时候才会将“自然灵力”区分出来。"},{name:"装备和纪念品",detail:"装备有主动和被动之分，主动装备一场战斗中默认只能用一次。\n纪念品一定是有一个广义上的正面效果和一个广义上的负面效果，只能在某些事件中获得。\n两者的共同特点是只能携带一个、携带一种，拿了新的就替换旧的。"},{name:"抽牌数和手牌上限",detail:"抽牌数就是每回合开始时从牌库抽的牌数，抽牌数=基础抽牌数+(速度-敌人平均速度)，小数点后面部分就是多抽一张的概率，顺带一提基础抽牌数是2。\n一旦手中牌的数量达到了上限，抽牌就会没有啥反应，手牌上限=抽牌数+速度四舍五入。"},{name:"攻击和造成伤害",detail:"打出卡只能回血肯定就不是攻击了嘛，打出卡引起的一系列输出中包含造成伤害，就叫攻击，但是目标可能有盾什么的，不一定要受到伤害。\n如果一张卡造成了群体伤害，那么“造成伤害”的次数就会多于“攻击”的次数。\n对自己造成伤害也算造成伤害哦。"},{name:"穿透伤害",detail:"伤害的一种类型，跳过防御结界等阻挡伤害的机制直接对目标造成伤害，不受自身命中率和目标闪避率的影响，但受减伤环节影响。"},{name:"直接伤害和间接伤害",detail:"角色造成的伤害由二者构成，主要区别为是否由角色直接造成，间接伤害没法暴击的。\n“造成n伤害”若非特别说明，就是指造成n点直接伤害。\n一般情况下，卡造成的伤害和主动装备造成的伤害都是直接伤害，其它的则是间接伤害。"},{name:"最终伤害和额外伤害",detail:"伤害结算的过程中有诸多的烹饪环节，如日晷、腌萝卜、害羞兔的增伤啊，暴击判定啊，或者对伤害本身没有影响的封魔针充能、挂星星之类的，最后得到的就是最终伤害了。\n额外伤害是间接伤害的一种，但与最终伤害性质相同，都不会再触发任何的烹饪环节，是一个最终值了。"},{name:"角色造成的伤害和敌人受到的伤害",detail:"首先二者肯定是不等同的，例如，各类buff的伤害类型是额外伤害，没法被角色的增伤效果增幅，但是可以被“敌人受到伤害增加”的效果增幅。\n因为这两种增伤效果是不同的，所以在结算伤害时可以乘算。\n笑了，这破游戏里哪个乘区不是独立乘区。"},{name:"受到伤害与生命值削减",detail:"显然，先有受到伤害，再有生命值削减，是一个因果关系，所以诸如“削减敌人20%生命值”是不会触发“造成伤害”或“受到伤害”的效果的。"},{name:"生命值与过量治疗",detail:"最大生命值和当前生命值的变动是分开的，最大生命值-2并不会连带当前生命值一起-2，当前生命值的30%和最大生命值的30%大多数情况下也不是同一个数目。\n当前生命值不可能超过最大生命值，如果发生溢出，溢出部分会被消去，不过并不会形成过量治疗哟，过量治疗起码得是真的治疗吧，有绿色数字冒出来的那种。"},{name:"生命值的变动",detail:"“减少30%生命值”是指将当前生命值扣除最大生命值的30%，“减少30%最大生命值”是真的扣最大生命值，而“减少30%当前生命值”就是基于现有血量扣除了。\n是吧，因为第二第三种表达方式都是其它意思，只能用第一种表达方式了。"},{name:"XXX造成的伤害",detail:"普通攻击要是触发了窜天猴的50%附加伤害，那这伤害算在通式暴怒的效果“普攻造成的伤害+30%”里吗？\n是算的，简单来说，打出一张卡后出现的所有伤害数字都算在这一次攻击里。\n"}];function rt(e,t,n){const l=e.slice();return l[36]=t[n],l[38]=n,l}function st(e,t,n){const l=e.slice();return l[39]=t[n],l[40]=t,l[38]=n,l}function it(e,t,n){const l=e.slice();return l[39]=t[n],l[38]=n,l}function ct(e,t,n){const l=e.slice();return l[39]=t[n],l[42]=t,l[38]=n,l}function dt(e,t,n){const l=e.slice();return l[43]=t[n],l[44]=t,l[38]=n,l}function ut(e){let t,n,l,a,o,r=e[0]&&ft(e);return{c(){t=j("div"),r&&r.c(),A(t,"class",n="body "+(e[0]&&"menu")+" "+e[12].role+" svelte-2yotwx")},m(e,n){x(e,t,n),r&&r.m(t,null),o=!0},p(e,l){e[0]?r?(r.p(e,l),1&l[0]&&ie(r,1)):(r=ft(e),r.c(),ie(r,1),r.m(t,null)):r&&(re(),ce(r,1,1,(()=>{r=null})),se()),(!o||4097&l[0]&&n!==(n="body "+(e[0]&&"menu")+" "+e[12].role+" svelte-2yotwx"))&&A(t,"class",n)},i(e){o||(ie(r),Z((()=>{o&&(a&&a.end(1),l=ue(t,we,{duration:250}),l.start())})),o=!0)},o(e){ce(r),l&&l.invalidate(),a=fe(t,we,{duration:250}),o=!1},d(e){e&&w(t),r&&r.d(),e&&a&&a.end()}}}function ft(e){let t,n,l,o,r,s,i,d,f,m,h,p,g,y,v,k,_,$,M,q,L,z,S,I,R,B,P,N,K,D,F,Y,X,G,J,W,U,Q,V,ee,te,ne,le,ae,oe,de,he,ge,ye,ve,be,ke,_e,xe,we,je=[],Oe=new Map,Te=e[12].coin+"",Me=e[2];const Ce=e=>e[38];for(let t=0;t<Me.length;t+=1){let n=dt(e,Me,t),l=Ce(n);Oe.set(l,je[t]=mt(l,n))}let Ae="collection"==e[1]&&ht(e),Ee="spellcards"==e[1]&&yt(e),He="consumable"==e[1]&&bt(e),qe="annotation"==e[1]&&xt(e),Le=e[12].equipment&&$t(e),ze=e[12].souvenir&&jt(e);return{c(){t=j("div"),t.innerHTML='<div class="title svelte-2yotwx"><icon class="icon-data svelte-2yotwx"></icon> \n          <txt class="svelte-2yotwx">思与想的境界</txt></div>',n=T(),l=j("div"),l.textContent="可在任何地方右键打开或关闭角色面板",o=T(),r=j("div"),s=j("div"),i=j("txt"),i.textContent="(=￣ ρ￣=) ..zzZZ",d=T(),f=j("div");for(let e=0;e<je.length;e+=1)je[e].c();m=T(),h=j("img"),g=T(),y=j("div"),v=j("icon"),k=T(),_=j("txt"),$=O(Te),M=T(),q=j("div"),q.textContent="保存并回到标题界面",L=T(),z=j("div"),S=j("div"),I=j("div"),R=j("txt"),B=O("牌库"),N=T(),K=j("txt"),D=O("收藏品"),Y=T(),X=j("txt"),G=O("消耗品"),W=T(),U=j("txt"),Q=O("碎碎念"),ee=T(),te=j("div"),ne=T(),le=j("div"),ae=T(),Ae&&Ae.c(),oe=T(),Ee&&Ee.c(),de=T(),He&&He.c(),he=T(),qe&&qe.c(),ge=T(),ye=j("div"),Le&&Le.c(),ve=T(),ze&&ze.c(),A(t,"class","info svelte-2yotwx"),A(t,"id","info"),A(l,"class","remind svelte-2yotwx"),A(i,"class","svelte-2yotwx"),c(h.src,p="/img/role/"+e[13].resource+"/"+e[12].role+".webp")||A(h,"src",p),A(h,"class","svelte-2yotwx"),A(f,"class","state svelte-2yotwx"),A(v,"class","coin icon-coin svelte-2yotwx"),A(_,"class","svelte-2yotwx"),A(y,"class","tip svelte-2yotwx"),H(y,"--width","200px"),A(q,"class","tip action svelte-2yotwx"),H(q,"--width","250px"),A(s,"class","left svelte-2yotwx"),A(R,"class",P=u("spellcards"==e[1]&&"selected")+" svelte-2yotwx"),A(K,"class",F=u("collection"==e[1]&&"selected")+" svelte-2yotwx"),A(X,"class",J=u("consumable"==e[1]&&"selected")+" svelte-2yotwx"),A(U,"class",V=u("annotation"==e[1]&&"selected")+" svelte-2yotwx"),A(I,"class","index svelte-2yotwx"),A(te,"class","bookmark svelte-2yotwx"),A(le,"class","bg svelte-2yotwx"),A(S,"class","item svelte-2yotwx"),A(ye,"class","other svelte-2yotwx"),A(z,"class","right svelte-2yotwx"),A(r,"class","main svelte-2yotwx")},m(a,c){x(a,t,c),x(a,n,c),x(a,l,c),x(a,o,c),x(a,r,c),b(r,s),b(s,i),b(s,d),b(s,f);for(let e=0;e<je.length;e+=1)je[e]&&je[e].m(f,null);b(f,m),b(f,h),e[17](h),b(s,g),b(s,y),b(y,v),b(y,k),b(y,_),b(_,$),e[18](y),b(s,M),b(s,q),b(r,L),b(r,z),b(z,S),b(S,I),b(I,R),b(R,B),b(I,N),b(I,K),b(K,D),b(I,Y),b(I,X),b(X,G),b(I,W),b(I,U),b(U,Q),b(S,ee),b(S,te),b(S,ne),b(S,le),b(S,ae),Ae&&Ae.m(S,null),b(S,oe),Ee&&Ee.m(S,null),b(S,de),He&&He.m(S,null),b(S,he),qe&&qe.m(S,null),b(z,ge),b(z,ye),Le&&Le.m(ye,null),b(ye,ve),ze&&ze.m(ye,null),_e=!0,xe||(we=[C(q,"click",e[19]),C(R,"click",e[20]),C(K,"click",e[21]),C(X,"click",e[22]),C(U,"click",e[23])],xe=!0)},p(e,t){16396&t[0]&&(Me=e[2],je=pe(je,t,Ce,1,e,Me,Oe,f,me,mt,m,dt)),(!_e||12288&t[0]&&!c(h.src,p="/img/role/"+e[13].resource+"/"+e[12].role+".webp"))&&A(h,"src",p),(!_e||4096&t[0])&&Te!==(Te=e[12].coin+"")&&E($,Te),(!_e||2&t[0]&&P!==(P=u("spellcards"==e[1]&&"selected")+" svelte-2yotwx"))&&A(R,"class",P),(!_e||2&t[0]&&F!==(F=u("collection"==e[1]&&"selected")+" svelte-2yotwx"))&&A(K,"class",F),(!_e||2&t[0]&&J!==(J=u("consumable"==e[1]&&"selected")+" svelte-2yotwx"))&&A(X,"class",J),(!_e||2&t[0]&&V!==(V=u("annotation"==e[1]&&"selected")+" svelte-2yotwx"))&&A(U,"class",V),"collection"==e[1]?Ae?(Ae.p(e,t),2&t[0]&&ie(Ae,1)):(Ae=ht(e),Ae.c(),ie(Ae,1),Ae.m(S,oe)):Ae&&(re(),ce(Ae,1,1,(()=>{Ae=null})),se()),"spellcards"==e[1]?Ee?(Ee.p(e,t),2&t[0]&&ie(Ee,1)):(Ee=yt(e),Ee.c(),ie(Ee,1),Ee.m(S,de)):Ee&&(re(),ce(Ee,1,1,(()=>{Ee=null})),se()),"consumable"==e[1]?He?(He.p(e,t),2&t[0]&&ie(He,1)):(He=bt(e),He.c(),ie(He,1),He.m(S,he)):He&&(re(),ce(He,1,1,(()=>{He=null})),se()),"annotation"==e[1]?qe?(qe.p(e,t),2&t[0]&&ie(qe,1)):(qe=xt(e),qe.c(),ie(qe,1),qe.m(S,null)):qe&&(re(),ce(qe,1,1,(()=>{qe=null})),se()),e[12].equipment?Le?Le.p(e,t):(Le=$t(e),Le.c(),Le.m(ye,ve)):Le&&(Le.d(1),Le=null),e[12].souvenir?ze?ze.p(e,t):(ze=jt(e),ze.c(),ze.m(ye,null)):ze&&(ze.d(1),ze=null)},i(e){_e||(ie(Ae),ie(Ee),ie(He),ie(qe),Z((()=>{_e&&(ke&&ke.end(1),be=ue(r,$e,{duration:250}),be.start())})),_e=!0)},o(e){ce(Ae),ce(Ee),ce(He),ce(qe),be&&be.invalidate(),ke=fe(r,$e,{duration:250}),_e=!1},d(s){s&&w(t),s&&w(n),s&&w(l),s&&w(o),s&&w(r);for(let e=0;e<je.length;e+=1)je[e].d();e[17](null),e[18](null),Ae&&Ae.d(),Ee&&Ee.d(),He&&He.d(),qe&&qe.d(),Le&&Le.d(),ze&&ze.d(),s&&ke&&ke.end(),xe=!1,a(we)}}}function mt(e,t){let n,l,a,o,r,s,i=t[43].data+"",c=t[38];const d=()=>t[16](n,c),u=()=>t[16](null,c);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),r=j("txt"),s=O(i),H(l,"left",150+1.5*t[14][t[38]].x-16+"px"),H(l,"top",150+1.5*t[14][t[38]].y-16+"px"),A(l,"class",a="icon-"+t[43].type+" svelte-2yotwx"),H(r,"left",150+2.3*t[14][t[38]].x-25+"px"),H(r,"top",150+2.3*t[14][t[38]].y-16+"px"),A(r,"class","svelte-2yotwx"),A(n,"class","svelte-2yotwx"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),b(n,r),b(r,s),d()},p(e,n){t=e,4&n[0]&&H(l,"left",150+1.5*t[14][t[38]].x-16+"px"),4&n[0]&&H(l,"top",150+1.5*t[14][t[38]].y-16+"px"),4&n[0]&&a!==(a="icon-"+t[43].type+" svelte-2yotwx")&&A(l,"class",a),4&n[0]&&i!==(i=t[43].data+"")&&E(s,i),4&n[0]&&H(r,"left",150+2.3*t[14][t[38]].x-25+"px"),4&n[0]&&H(r,"top",150+2.3*t[14][t[38]].y-16+"px"),c!==t[38]&&(u(),c=t[38],d())},d(e){e&&w(n),u()}}}function ht(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(e[12].collection);const i=e=>e[38];for(let t=0;t<s.length;t+=1){let n=ct(e,s,t),l=i(n);r.set(l,o[t]=gt(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","collection container svelte-2yotwx")},m(n,l){x(n,t,l);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);e[25](t),a=!0},p(e,n){4112&n[0]&&(s=Object.keys(e[12].collection),o=pe(o,n,i,1,e,s,r,t,me,gt,null,ct))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(n){n&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e[25](null),n&&l&&l.end()}}}function pt(e){let t,n,l=Object.values(e[12].collection)[e[38]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-2yotwx")},m(e,l){x(e,t,l),b(t,n)},p(e,t){4096&t[0]&&l!==(l=Object.values(e[12].collection)[e[38]]+"")&&E(n,l)},d(e){e&&w(t)}}}function gt(e,t){let n,l,a,o,r,s=Object.values(t[12].collection)[t[38]]>1,i=t[38],c=s&&pt(t);const d=()=>t[24](n,i),u=()=>t[24](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),c&&c.c(),r=T(),A(l,"class",a="icon-"+t[39]+" svelte-2yotwx"),H(n,"background-color","var(--"+Ne[t[39]].type+")"),A(n,"class","svelte-2yotwx"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),c&&c.m(n,null),b(n,r),d()},p(e,o){t=e,4096&o[0]&&a!==(a="icon-"+t[39]+" svelte-2yotwx")&&A(l,"class",a),4096&o[0]&&(s=Object.values(t[12].collection)[t[38]]>1),s?c?c.p(t,o):(c=pt(t),c.c(),c.m(n,r)):c&&(c.d(1),c=null),4096&o[0]&&H(n,"background-color","var(--"+Ne[t[39]].type+")"),i!==t[38]&&(u(),i=t[38],d())},d(e){e&&w(n),c&&c.d(),u()}}}function yt(e){let t,n,l,a,o=[],r=new Map,s=Object.unCount(e[12].card);const i=e=>e[38];for(let t=0;t<s.length;t+=1){let n=it(e,s,t),l=i(n);r.set(l,o[t]=vt(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","spellcards container svelte-2yotwx")},m(n,l){x(n,t,l);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);e[26](t),a=!0},p(e,n){4096&n[0]&&(s=Object.unCount(e[12].card),re(),o=pe(o,n,i,1,e,s,r,t,he,vt,null,it),se())},i(e){if(!a){for(let e=0;e<s.length;e+=1)ie(o[e]);Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0}},o(e){for(let e=0;e<o.length;e+=1)ce(o[e]);n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(n){n&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e[26](null),n&&l&&l.end()}}}function vt(e,t){let n,l,a;return l=new at({props:{key:t[39]}}),{key:e,first:null,c(){n=M(),ge(l.$$.fragment),this.first=n},m(e,t){x(e,n,t),ye(l,e,t),a=!0},p(e,n){t=e;const a={};4096&n[0]&&(a.key=t[39]),l.$set(a)},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l,e)}}}function bt(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(e[12].consumable);const i=e=>e[38];for(let t=0;t<s.length;t+=1){let n=st(e,s,t),l=i(n);r.set(l,o[t]=_t(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","collection container svelte-2yotwx")},m(n,l){x(n,t,l);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);e[28](t),a=!0},p(e,n){4128&n[0]&&(s=Object.keys(e[12].consumable),o=pe(o,n,i,1,e,s,r,t,me,_t,null,st))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(n){n&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e[28](null),n&&l&&l.end()}}}function kt(e){let t,n,l=Object.values(e[12].consumable)[e[38]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-2yotwx")},m(e,l){x(e,t,l),b(t,n)},p(e,t){4096&t[0]&&l!==(l=Object.values(e[12].consumable)[e[38]]+"")&&E(n,l)},d(e){e&&w(t)}}}function _t(e,t){let n,l,a,o,r,s=Object.values(t[12].consumable)[t[38]]>1,i=t[38],c=s&&kt(t);const d=()=>t[27](n,i),u=()=>t[27](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),c&&c.c(),r=T(),A(l,"class",a="icon-"+t[39]+" svelte-2yotwx"),A(n,"class","svelte-2yotwx"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),c&&c.m(n,null),b(n,r),d()},p(e,o){t=e,4096&o[0]&&a!==(a="icon-"+t[39]+" svelte-2yotwx")&&A(l,"class",a),4096&o[0]&&(s=Object.values(t[12].consumable)[t[38]]>1),s?c?c.p(t,o):(c=kt(t),c.c(),c.m(n,r)):c&&(c.d(1),c=null),i!==t[38]&&(u(),i=t[38],d())},d(e){e&&w(n),c&&c.d(),u()}}}function xt(e){let t,n,l,a,o,r,s,i,c=[],d=new Map,u=Object.keys(ot);const f=e=>e[38];for(let t=0;t<u.length;t+=1){let n=rt(e,u,t),l=f(n);d.set(l,c[t]=wt(l,n))}return{c(){t=j("div"),n=j("table"),n.innerHTML='<thead class="svelte-2yotwx"><tr class="svelte-2yotwx"><th class="svelte-2yotwx">乘算速查</th> \n                      <th class="svelte-2yotwx">^5</th> \n                      <th class="svelte-2yotwx">^10</th> \n                      <th class="svelte-2yotwx">^15</th> \n                      <th class="svelte-2yotwx">^20</th></tr></thead> \n                  <tbody class="svelte-2yotwx"><tr class="svelte-2yotwx"><td class="svelte-2yotwx">x95%</td> \n                      <td class="svelte-2yotwx">77%</td> \n                      <td class="svelte-2yotwx">60%</td> \n                      <td class="svelte-2yotwx">46%</td> \n                      <td class="svelte-2yotwx">36%</td></tr> \n                    <tr class="svelte-2yotwx"><td class="svelte-2yotwx">x90%</td> \n                      <td class="svelte-2yotwx">60%</td> \n                      <td class="svelte-2yotwx">35%</td> \n                      <td class="svelte-2yotwx">20%</td> \n                      <td class="svelte-2yotwx">12%</td></tr> \n                    <tr class="svelte-2yotwx"><td class="svelte-2yotwx">x85%</td> \n                      <td class="svelte-2yotwx">44%</td> \n                      <td class="svelte-2yotwx">20%</td> \n                      <td class="svelte-2yotwx">9%</td> \n                      <td class="svelte-2yotwx">4%</td></tr></tbody>',l=T(),a=j("txt"),o=T();for(let e=0;e<c.length;e+=1)c[e].c();A(n,"class","table svelte-2yotwx"),A(a,"class","detail svelte-2yotwx"),A(t,"class","annotation container svelte-2yotwx")},m(r,s){x(r,t,s),b(t,n),b(t,l),b(t,a),b(t,o);for(let e=0;e<c.length;e+=1)c[e]&&c[e].m(t,null);e[29](t),i=!0},p(e,n){0&n&&(u=Object.keys(ot),c=pe(c,n,f,1,e,u,d,t,me,wt,null,rt))},i(e){i||(Z((()=>{i&&(s&&s.end(1),r=ue(t,we,{duration:200}),r.start())})),i=!0)},o(e){r&&r.invalidate(),s=fe(t,we,{duration:200}),i=!1},d(n){n&&w(t);for(let e=0;e<c.length;e+=1)c[e].d();e[29](null),n&&s&&s.end()}}}function wt(e,t){let n,l,a,o,r,s=ot[t[36]].name+"",i=ot[t[36]].detail+"";return{key:e,first:null,c(){n=j("txt"),l=O(s),a=T(),o=j("txt"),r=O(i),A(n,"class","name svelte-2yotwx"),A(o,"class","detail svelte-2yotwx"),this.first=n},m(e,t){x(e,n,t),b(n,l),x(e,a,t),x(e,o,t),b(o,r)},p(e,n){t=e},d(e){e&&w(n),e&&w(a),e&&w(o)}}}function $t(e){let t,n,l,a,o;return{c(){t=j("div"),n=j("icon"),a=T(),o=j("txt"),o.textContent="装备",A(n,"class",l="icon-"+e[12].equipment+" svelte-2yotwx"),A(o,"class","svelte-2yotwx"),A(t,"class","equipment svelte-2yotwx")},m(l,r){x(l,t,r),b(t,n),b(t,a),b(t,o),e[30](t)},p(e,t){4096&t[0]&&l!==(l="icon-"+e[12].equipment+" svelte-2yotwx")&&A(n,"class",l)},d(n){n&&w(t),e[30](null)}}}function jt(e){let t,n,l,a,o;return{c(){t=j("div"),n=j("icon"),a=T(),o=j("txt"),o.textContent="纪念品",A(n,"class",l="icon-"+e[12].souvenir+" svelte-2yotwx"),A(o,"class","svelte-2yotwx"),A(t,"class","souvenir svelte-2yotwx")},m(l,r){x(l,t,r),b(t,n),b(t,a),b(t,o),e[31](t)},p(e,t){4096&t[0]&&l!==(l="icon-"+e[12].souvenir+" svelte-2yotwx")&&A(n,"class",l)},d(n){n&&w(t),e[31](null)}}}function Ot(e){let t,n,l=e[0]&&ut(e);return{c(){l&&l.c(),t=M()},m(e,a){l&&l.m(e,a),x(e,t,a),n=!0},p(e,n){e[0]?l?(l.p(e,n),1&n[0]&&ie(l,1)):(l=ut(e),l.c(),ie(l,1),l.m(t.parentNode,t)):l&&(re(),ce(l,1,1,(()=>{l=null})),se())},i(e){n||(ie(l),n=!0)},o(e){ce(l),n=!1},d(e){l&&l.d(e),e&&w(t)}}}function Tt(e,t,n){let l,a,o,r,s;d(e,Te,(e=>n(11,l=e))),d(e,Ae,(e=>n(12,a=e))),d(e,Me,(e=>n(32,o=e))),d(e,ze,(e=>n(33,r=e))),d(e,Ee,(e=>n(13,s=e)));const i=x;let c,u=!1,m="spellcards";const h=[],p=[],g=[],y={};let v,b,k,_;f(ze,r.menu=x,r),N((e=>{a&&(h.forEach(((e,t)=>o(e).color("chance"==c[t].type?a.chance.type:"blue").with(c[t]))),p.forEach(((e,t)=>o(e).color(Ne[Object.keys(a.collection)[t]].type).with(Ne[Object.keys(a.collection)[t]]))),g.forEach(((e,t)=>o(e).color(Fe[Object.keys(a.consumable)[t]].type).with(Fe[Object.keys(a.consumable)[t]]))),"function"==typeof o&&(o(v).color("gold").with({name:"硬币",detail:"对，这是钱。"}),o(_).with({name:Ye[a.role].name,detail:Ye[a.role].talent}),o(b).color("gold").with(Ke[a.equipment]),o(k).color("purple").with(De[a.souvenir])))})),D((e=>{for(let e in y)y[e]&&n(6,y[e].ontouchstart=function(t){let l=t.touches[0].pageX,a=y[e].scrollTop;n(6,y[e].ontouchmove=function(t){let o=t.touches[0].pageX;n(6,y[e].scrollTop=a+o-l,y)},y)},y)}));function x(e){e&&e.preventDefault(),"Index"!=l&&(["Afflatus","Foreword","Archive"].includes(l)?f(Te,l="Index",l):(n(2,c=function(){let e=Xe.role[a.role];return[{type:"maxHealth",name:"最大生命值",detail:"显而易见，生命值不会超过这个数。\n只有等级才能让这个数字提升。",data:e.health},{type:"attack",name:"阶层",detail:"打败BOSS进入下一阶层，总共有3个阶层。",data:a.stage},{type:"speed",name:"速度",detail:"决定了回合中行动的自由度，速度快，能做的事也就会更多。\n抽牌数=基础抽牌数+(速度-敌人平均速度)，小数点后面部分就是多抽一张的概率。\n手牌上限=抽牌数+速度四舍五入。",data:e.speed},{type:"power",name:"灵力",detail:"牌左上角的数字就是其灵力消耗。灵力每回合初都会回复至上限。\n额外灵力：等同于灵力，优先消耗，上限等同于牌库总牌数。",data:e.power},{type:"health",name:"生命值",detail:"必须不让它归零才行。",data:a.health},{type:"sugar",name:"糖",detail:"面临选择时可用选项的数量。",data:a.sugar},{type:"left_card",name:"牌库数量",detail:"等级越高越强大。\n只能通过战斗提升等级。",data:Object.values(a.card).sum()},{type:"chance",name:"机会",detail:`剩余${a.chance.amount}次战败时回到战斗前的机会。机会消耗时，回复生命值并获得一件${{blue:"蓝色",green:"绿色",red:"红色"}[a.chance.type]}收藏品。`,data:a.chance.amount}]}()),n(0,u=!u)))}return[u,m,c,h,p,g,y,v,b,k,_,l,a,s,[{x:50,y:0},{x:35.4,y:-35.4},{x:0,y:-50},{x:-35.4,y:-35.4},{x:-50,y:0},{x:-35.4,y:35.4},{x:0,y:50},{x:35.4,y:35.4}],i,function(e,t){Y[e?"unshift":"push"]((()=>{h[t]=e,n(3,h)}))},function(e){Y[e?"unshift":"push"]((()=>{_=e,n(10,_)}))},function(e){Y[e?"unshift":"push"]((()=>{v=e,n(7,v)}))},e=>{n(0,u=!1),f(Te,l="Index",l)},e=>n(1,m="spellcards"),e=>n(1,m="collection"),e=>n(1,m="consumable"),e=>n(1,m="annotation"),function(e,t){Y[e?"unshift":"push"]((()=>{p[t]=e,n(4,p)}))},function(e){Y[e?"unshift":"push"]((()=>{y.collection=e,n(6,y)}))},function(e){Y[e?"unshift":"push"]((()=>{y.spellcards=e,n(6,y)}))},function(e,t){Y[e?"unshift":"push"]((()=>{g[t]=e,n(5,g)}))},function(e){Y[e?"unshift":"push"]((()=>{y.consumable=e,n(6,y)}))},function(e){Y[e?"unshift":"push"]((()=>{y.annotation=e,n(6,y)}))},function(e){Y[e?"unshift":"push"]((()=>{b=e,n(8,b)}))},function(e){Y[e?"unshift":"push"]((()=>{k=e,n(9,k)}))}]}class Mt extends _e{constructor(e){super(),ke(this,e,Tt,Ot,s,{menu:15},null,[-1,-1])}get menu(){return this.$$.ctx[15]}}function Ct(e){let t,n,l,a,o,r,s,i,c;return{c(){t=j("div"),n=j("span"),l=O(e[0]),a=T(),o=j("a"),r=O(e[1]),H(n,"background-color","var(--"+e[2]+")"),A(n,"class","svelte-1srvrkr"),A(o,"class","svelte-1srvrkr"),A(t,"class","explain svelte-1srvrkr"),H(t,"left",e[3]+"px"),H(t,"top",e[4]+"px"),H(t,"visibility",e[0]?"visible":"hidden")},m(s,i){x(s,t,i),b(t,n),b(n,l),b(t,a),b(t,o),b(o,r),e[8](t),c=!0},p(e,a){(!c||1&a)&&E(l,e[0]),(!c||4&a)&&H(n,"background-color","var(--"+e[2]+")"),(!c||2&a)&&E(r,e[1]),(!c||8&a)&&H(t,"left",e[3]+"px"),(!c||16&a)&&H(t,"top",e[4]+"px"),(!c||1&a)&&H(t,"visibility",e[0]?"visible":"hidden")},i(e){c||(Z((()=>{c&&(i&&i.end(1),s=ue(t,we,{duration:100}),s.start())})),c=!0)},o(e){s&&s.invalidate(),i=fe(t,we,{duration:100}),c=!1},d(n){n&&w(t),e[8](null),n&&i&&i.end()}}}function At(e){let t,n,l=("show"==e[5]||e[7].mobile)&&Ct(e);return{c(){l&&l.c(),t=M()},m(e,a){l&&l.m(e,a),x(e,t,a),n=!0},p(e,[n]){"show"==e[5]||e[7].mobile?l?(l.p(e,n),160&n&&ie(l,1)):(l=Ct(e),l.c(),ie(l,1),l.m(t.parentNode,t)):l&&(re(),ce(l,1,1,(()=>{l=null})),se())},i(e){n||(ie(l),n=!0)},o(e){ce(l),n=!1},d(e){l&&l.d(e),e&&w(t)}}}function Et(e,t,n){let l,a,o,r,s,i,c;d(e,ze,(e=>n(7,l=e))),d(e,Me,(e=>n(9,a=e)));let u,m="hide";f(Me,a=function(e){return{color(e){return this.Color=e,this},with(t){let n=this.Color?this.Color:"blue";this.color=!1,e&&t&&(e.ontouchstart=e=>h.show(e,t,n),l.mobile||(e.onmouseenter=e=>h.show(e,t,n),e.onmousemove=e=>h.move(e,t,n),e.onmouseleave=e=>h.hide()))}}},a);const h={move:(e,t,l)=>{n(0,o=t.name),n(1,r=t.detail),n(2,s=l),n(3,i=document.body.clientWidth-e.x>240?e.x+5:e.x-230),n(4,c=e.y-u.offsetHeight-5)},show:(e,t,a)=>{if(n(5,m="show"),n(0,o=t.name),n(1,r=t.detail),n(2,s=a),l.mobile){e.x||(e.x=e.touches[0].pageX),e.y||(e.y=e.touches[0].pageY);let t=document.getElementById("root");n(3,i=(e.y-(document.body.clientHeight/l.mobile-t.clientWidth)/2)/l.mobile-20),n(4,c=t.clientHeight-e.x/l.mobile-5),setTimeout((e=>window.ontouchstart=h.hide))}else n(3,i=document.body.clientWidth-e.x>240?e.x+5:e.x-230),n(4,c=e.y-5)},hide:e=>{window.ontouchstart=null,n(5,m="hide"),n(0,o=null)}};return K((function(){l.mobile&&n(6,u.ontouchstart=h.hide,u)})),D((function(){u&&(n(6,u.onmouseenter=h.hide,u),l.mobile&&n(4,c-=u.clientHeight))})),[o,r,s,i,c,m,u,l,function(e){Y[e?"unshift":"push"]((()=>{u=e,n(6,u)}))}]}class Ht extends _e{constructor(e){super(),ke(this,e,Et,At,s,{})}}var qt=["啊啊啊我忘记了","阿吽","阿卡麟","阿空","阿燐","阿求","艾丽","爱丽丝","爱丽丝的魔法书","爱丽丝梦游仙境","爱丽丝威震天","爱莲","爱塔妮缇拉尔瓦","庵我烧了","奥莲姬","八百万之神","八坂神奈子","八分咲","八卦炉","八桥","八意永琳","八云蓝","八云紫","百鬼夜行","白鹭风茗","稗田阿求","百万鬼夜行","百药枡","白玉楼","半白泽","坂田合欢乃","宝宝巴士","抱头蹲防","包子仙","本居小铃","本子仙","彼岸","彼岸归航","比那名居天子","弁弁","博丽","博丽大结界","博丽结界","博丽灵梦","博丽神社","博丽神社例大祭","布都","布嘟嘟","不认识的孩子","不朽的曼珠沙华","擦弹","残机","缠流子","车车人","车万","沉默的兽灵","成美","赤蛮奇","重生","畜生界","畜生们的休息","船幽灵","船长","纯狐","纯妈","茨歌仙","茨木华扇","从地下的归还","萃梦想","萃香","村纱水蜜","大蛾子","大根","大蛤蟆之池","大酱","大结界","大鹫灵","大狸子","大妖精","大玉","弹幕","弹幕射击","弹幕邪天鬼","弹幕战","道中","得点","地底通路","敌机","地灵殿","地狱鸦","掉残","弔姐","吊瓶妖","凋叶棕","丁礼田","丁礼田舞","东方","东方蝉时歌","东方茨歌仙","东方萃梦想","东方大炮弹","东方大往生","东方大战争","东方地灵殿","东方绯想天","东方非想天则","东方封魔录","东方风神录","东方绀珠传","东方刚欲异闻","东方怪绮谈","东方鬼形兽","东方红楼梦","东方红魔乡","东方华烂漫","东方花映冢","东方幻想乡","东方辉针城","东方铃奈庵","东方灵异传","东方梦灵梦","东方梦时空","东方儚月抄","东方凭依华","东方清泉飨","东方求闻口授","东方求闻史纪","东方三月精","东方神灵庙","东方深秘录","东方失去之言","东方四季呗","东方天空璋","东方天上花","东方童楼遥","东方外来韦编","东方文花帖","东方香霖堂","东方心绮楼","东方星莲船","东方妖妖梦","东方萤灯筏","东方樱蝶梦","东方樱神月","东方永夜抄","东方游剧天","东方智灵奇传","东方紫香花","东方醉蝶华","东风谷早苗","动物灵","毒奶","多多良小伞","哆来咪","哆来咪苏伊特","谔谔","噩梦日记","二次创作","二设","二婶子","二岩猯藏","尔子田","尔子田里乃","法界","反魂蝶","芳香","防撞桶","非符","非想天","丰聪耳神子","风见幽香","疯帽子茶会","封魔录","风神录","封兽鵺","风之暗穴","疯中二婶子","符卡","符卡规则","芙兰","芙兰朵露","付丧神","尬舞姐妹","感情的摩天楼","绀珠传","刚欲同盟","刚欲异闻","高丽野阿吽","格斗","宫古芳香","狗椛","固定弹","鼓哥","鼓姐","古明地觉","古明地恋","怪力乱神","怪绮谈","广西烧烤摊老板","广有射怪鸟事","鬼畜妹","袿姬","鬼杰组","鬼杰组组长","鬼人正邪","鬼形兽","果果","过膝袜","航哥","好吗","河城荷取","赫卡","赫卡姐","赫卡提亚","荷取","核融炉","河童","黑谷山女","黑历史","红楼","红美铃","红萌馆","红魔馆","红魔乡","红银","红字本","虎哥","胡桃","冴月麟","椛椛","花开夜","华扇","华扇邸","花映冢","坏苹果","欢姐","幻梦缘起","幻视之夜","幻想万华镜","幻想夏乡","幻想乡","幻想乡空闪姬","幻想乡空战姬","幻想乡少女大战","幻想乡玩家","幻想跃迁实验室","幻缘团","幻月","幻跃团","黄昏立绘","辉夜","慧音","辉针城","辉针城的小人族","魂魄妖忌","魂魄妖梦","火车","霍青娥","火焰猫燐","吉弔","吉弔八千慧","姬海棠果","姬海棠极","姬海棠羽立","鸡妹","寄世界于偶像","键山雏","间歇泉","奖残","奖分","姐贵","结界","禁忌的魔法","矜羯罗","今泉影狼","今天也是好天气","今昔幻想乡","劲牙组","劲牙组组长","堇子","京都幻想剧团","静叶","囧仙","囧仙子","旧地狱遗址","旧都","九十九八桥","九十九弁弁","九天瀑布","菊理","决死符","卡娜安娜贝拉尔","考据党","可悲的人偶","克劳恩","克劳恩皮丝","堀川雷鼓","狂气之瞳","蓝妈","狼女","老娘是最强","乐航","乐囧","蕾蒂","蕾蒂霍瓦特洛克","蕾拉","蕾米","雷咪","蕾米莉亚","例大祭","莉格露","莉格露奈特巴格","骊驹早鬼","莉莉","莉莉白","莉莉黑","莉莉霍瓦特","莉莉卡","里乃","里香","恋恋","莲妈","莲子","铃二","铃瑚","灵力","灵梦","铃奈庵","灵乌路空","铃仙","铃仙二号","灵异传","灵知的太阳信仰","留琴","辘轳首","露米娅","露娜","露娜切露德","露娜萨","露易兹","轮椅战神","萝卜","洛天依","绿头发的爸爸","绿眼的嫉妒","玛艾露贝莉赫恩","玛格特罗依德邸","麻将山","玛露奇","满福神社","馒馒来","毛玉","梅蒂欣梅兰可莉","美国酱","妹红","梅丽","梅莉","美铃","梅露兰","魅魔","梦殿大祀庙","梦时空","梦想天生","梦消失","梦月","儚月抄","梦子","秘封","蜜蜂","秘封厨","秘封噩梦日记","秘封活动记录","秘封组","米国酱","米国小妖精","咪咪号","秘神摩多罗","米斯蒂娅","米斯蒂娅萝蕾拉","迷途之家","迷途竹林","面灵气","绵月丰姬","绵月依姬","苗苗","苗爷","冥界","命莲","命莲寺","明罗","摸多了硬起来","摩多罗","摩多罗隐岐奈","魔法森林","魔法使","魔理沙","摩妈","磨米机","摩托罗拉","摩西的奇迹","娜兹玲","牛妈","牛崎润美","女苑","帕露西","帕琪","帕秋莉","帕秋莉诺蕾姬","判定点","蓬莱人","蓬莱山辉夜","凭依华","琪露诺","骑士之夜","琪斯美","千年幻想乡","桥姬","秦河胜","秦心","青娥","清兰","青蛙子","秋静叶","秋穰子","求闻口授","求闻史纪","犬走椛","穰子","人间之里","人形裁判","人形使","人鱼","戎璎花","入道","乳町","若鹭姬","萨拉","萨丽艾尔","三分咲","三途川","伞妖","三月精","桑尼","桑尼米尔克","骚灵","森近霖之助","山姥","山女","山彦","上白泽慧音","烧烤摊老板","少名针妙丸","少女幻葬","少女绮想曲","射命丸文","社团","神话幻想","神灵","神灵庙","神妈","深秘录","神奈子","神绮","神社闭店之日","神玉","神子","圣白莲","圣德传说","圣德太子","圣德太子的马","圣德太子的天马","圣莲船","生死之境","世界美咲剧场","十六夜","十六夜咲夜","矢田寺成美","兽道","寿命论","兽娘幻想入","兽人","守矢神社","双七","水桥帕露西","水獭灵","四重存在","四季","四季大人","四季撒吗","四季撒吗我有罪","四季映姬","斯卡雷特","死灵","死神","四十米大刀","斯塔","斯塔萨菲娅","死亡幻想曲","寺子屋","苏格拉底","苏我屠自古","随机弹","砕月","碎月","太田顺也","太阳花田","太子的马","探女","探女老仙","陶瓷的杖刀人","藤原妹红","天狗","天空璋","天人","天探女","天邪鬼","天子","条纹过膝袜","庭渡久侘歌","同人","土蜘蛛","土著信仰","屠自古","豚乙女","外界","外来人","外来韦编","亡灵","威严满满","胃炎满满","文花帖","文文","我会自己上厕所","我做东方鬼畜音","物部布都","五分咲","无何有之乡","无名之丘","雾雨","雾雨魔理沙","无缘冢","雾之湖","稀神探女","西行寺幽幽子","吸血鬼","下压","仙界","现界","仙人","现世的秘术师","香霖堂","乡长","响子","消弹","小町","小恶魔","小老帝","小铃","小米弹","小人族","小伞","小桶","小兔姬","小碗","小五","咲夜","小野冢小町","泄矢诹访子","心酱","心绮楼","心之所在","星莲船","星条旗的小丑","星熊杯","星熊勇仪","幸运与不幸","星之器","续关","玄武之泽","玄爷","玄云海","阎魔","妖虫","妖怪狸","妖怪鼠","妖怪之山","妖精","妖精大战争","妖梦","妖兽","妖兔","妖妖跋扈","妖妖梦","鵺酱","野狼灵","野蛮至极","爷们红","夜雀","爷是恋恋","一般通过","一般通过山女","异变","伊吹萃香","伊吹瓢","伊吹西瓜","一分咲","衣玖","依莉斯","一轮","一设","依神女苑","依神紫苑","易者","引弹","因幡帝","因幡天为","隐匿的四季","隐岐奈","寅丸星","阴阳玉","樱花樱花","影狼","永动之龛","永江衣玖","永琳","永夜抄","勇仪","永远的春梦","永远的满月","永远亭","幽闭星光","有顶天","幽谷响子","幽幻魔眼","油库里","幽灵","幽冥结界","幽香","幽幽子","御伽之国的鬼岛","玉米棒子","欲望加速","宇佐见堇子","宇佐见莲子","原点组","原始的节拍","远野幻想物语","越共","乐器妖怪","月人","月时计","月兔","月之都","云居一轮","云山","再思之道","早鬼","早苗","杖刀偶磨弓","长者","折返","这是好的","真吉八弔","针妙丸","正邪","埴安神袿姬","智灵奇传","埴轮兵长","中弹","终符","朱鹭子","竹取飞翔","转转","壮族大妈","自机","自机狙","紫老太","紫妈","紫妹","紫奶奶","紫婆婆","紫香花","紫苑","诹访湖","诹访子","醉蝶华","佐渡的二岩"];function Lt(e,t,n){const l=e.slice();return l[23]=t[n],l[25]=n,l}function zt(e){let t,n,l,a;const o=[It,St],r=[];return t=0,n=r[0]=o[0](e),{c(){n.c(),l=M()},m(e,t){r[0].m(e,t),x(e,l,t),a=!0},p(e,t){n.p(e,t)},i(e){a||(ie(n),a=!0)},o(e){ce(n),a=!1},d(e){r[0].d(e),e&&w(l)}}}function St(t){let n,l,a;return{c(){n=j("txt"),n.textContent="Press Any Key",A(n,"class","launch svelte-zu4yik")},m(e,t){x(e,n,t),a=!0},p:e,i(e){a||(l&&l.end(1),a=!0)},o(e){l=fe(n,we,{duration:250}),a=!1},d(e){e&&w(n),e&&l&&l.end()}}}function It(e){let t,n,l,a=[],o=new Map,r=[e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11]];const s=e=>e[25];for(let t=0;t<10;t+=1){let n=Lt(e,r,t),l=s(n);o.set(l,a[t]=Rt(l,n))}return{c(){t=j("div");for(let e=0;e<10;e+=1)a[e].c();A(t,"class","words svelte-zu4yik")},m(e,n){x(e,t,n);for(let e=0;e<10;e+=1)a[e]&&a[e].m(t,null);l=!0},p(e,n){4092&n&&(r=[e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11]],a=pe(a,n,s,1,e,r,o,t,me,Rt,null,Lt))},i(e){l||(n&&n.end(1),l=!0)},o(e){n=fe(t,we,{duration:250}),l=!1},d(e){e&&w(t);for(let e=0;e<10;e+=1)a[e].d();e&&n&&n.end()}}}function Rt(e,t){let n,l,a,o=t[23].word+"";return{key:e,first:null,c(){n=j("txt"),l=O(o),a=T(),H(n,"left",t[23].x),H(n,"top",t[23].y),H(n,"font-size",26-8*Kt()+"px"),H(n,"animation-delay",.2*t[25]+"s"),A(n,"class","svelte-zu4yik"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a)},p(e,a){t=e,4092&a&&o!==(o=t[23].word+"")&&E(l,o),4092&a&&H(n,"left",t[23].x),4092&a&&H(n,"top",t[23].y),4092&a&&H(n,"animation-delay",.2*t[25]+"s")},d(e){e&&w(n)}}}function Bt(e){let t;return{c(){t=j("txt"),t.textContent="幻想异闻录",A(t,"class","title svelte-zu4yik")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Pt(t){let n,l,o,r,s,i,c,d,u,f,m=localStorage.getItem("explore")&&localStorage.getItem("explore").length>10,h=m&&function(t){let n,l,a;return{c(){n=j("txt"),n.textContent="继续",A(n,"class","svelte-zu4yik")},m(e,o){x(e,n,o),l||(a=C(n,"click",t[13]),l=!0)},p:e,d(e){e&&w(n),l=!1,a()}}}(t);return{c(){n=j("div"),h&&h.c(),l=T(),o=j("txt"),o.textContent="开始",r=T(),s=j("txt"),s.textContent="灵感",i=T(),c=j("txt"),c.textContent="记录",A(o,"class","svelte-zu4yik"),A(s,"class","svelte-zu4yik"),A(c,"class","svelte-zu4yik"),A(n,"class","menu svelte-zu4yik")},m(e,a){x(e,n,a),h&&h.m(n,null),b(n,l),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),u||(f=[C(o,"click",t[14]),C(s,"click",t[15]),C(c,"click",t[16])],u=!0)},p(e,t){m&&h.p(e,t)},i(e){d||Z((()=>{d=ue(n,we,{delay:250,duration:250}),d.start()}))},o:e,d(e){e&&w(n),h&&h.d(),u=!1,a(f)}}}function Nt(e){let t,n,l,a,o,r,s,i,c,d,u,f,m,h,p,g,y=!e[1]&&zt(e);let v=Bt(e),k=e[1]&&Pt(e);return{c(){t=j("div"),y&&y.c(),n=T(),v.c(),l=T(),k&&k.c(),a=T(),o=j("txt"),o.textContent="测试",r=T(),s=j("txt"),s.textContent="测试",i=T(),c=j("txt"),c.textContent="测试",d=T(),u=j("icon"),H(o,"color","transparent"),H(o,"font-family","remark"),H(o,"position","absolute"),H(s,"color","transparent"),H(s,"font-family","write"),H(s,"position","absolute"),H(c,"color","transparent"),H(c,"font-family","normal"),H(c,"position","absolute"),A(u,"class","icon-pull pull svelte-zu4yik"),A(t,"class","body svelte-zu4yik")},m(f,m){x(f,t,m),y&&y.m(t,null),b(t,n),v.m(t,null),b(t,l),k&&k.m(t,null),b(t,a),b(t,o),b(t,r),b(t,s),b(t,i),b(t,c),b(t,d),b(t,u),e[17](u),h=!0,p||(g=C(t,"click",e[18],{once:!0}),p=!0)},p(e,[l]){e[1]?y&&(re(),ce(y,1,1,(()=>{y=null})),se()):y?(y.p(e,l),2&l&&ie(y,1)):(y=zt(e),y.c(),ie(y,1),y.m(t,n)),e[1]?k?(k.p(e,l),2&l&&ie(k,1)):(k=Pt(e),k.c(),ie(k,1),k.m(t,a)):k&&(k.d(1),k=null)},i(e){h||(ie(y),ie(k),Z((()=>{h&&(m&&m.end(1),f=ue(t,we,{duration:250}),f.start())})),h=!0)},o(e){ce(y),f&&f.invalidate(),m=fe(t,we,{duration:250}),h=!1},d(n){n&&w(t),y&&y.d(),v.d(),k&&k.d(),e[17](null),n&&m&&m.end(),p=!1,g()}}}function Kt(){return Math.random()}function Dt(e,t,n){let l,a,o,r,s;d(e,He,(e=>n(19,l=e))),d(e,Ae,(e=>n(20,a=e))),d(e,Me,(e=>n(21,o=e))),d(e,Te,(e=>n(12,r=e))),D((function(){o&&o(s).with({name:"同步最新内容",detail:"这将重新加载静态缓存文件，或许需要一小段时间。"}),n(0,s.onclick=e=>window.location.replace(window.location.href),s)}));let i=!1,c=_(),u=_(),m=_(),h=_(),p=_(),g=_(),y=_(),v=_(),b=_(),k=_();function _(){return{x:-40-160*Kt()+"px",y:80-160*Kt()+"px",word:qt[Math.floor(Kt()*qt.length)]}}setTimeout((e=>setInterval((e=>n(2,c=_())),2e3)),0),setTimeout((e=>setInterval((e=>n(3,u=_())),2e3)),200),setTimeout((e=>setInterval((e=>n(4,m=_())),2e3)),400),setTimeout((e=>setInterval((e=>n(5,h=_())),2e3)),600),setTimeout((e=>setInterval((e=>n(6,p=_())),2e3)),800),setTimeout((e=>setInterval((e=>n(7,g=_())),2e3)),1e3),setTimeout((e=>setInterval((e=>n(8,y=_())),2e3)),1200),setTimeout((e=>setInterval((e=>n(9,v=_())),2e3)),1400),setTimeout((e=>setInterval((e=>n(10,b=_())),2e3)),1600),setTimeout((e=>setInterval((e=>n(11,k=_())),2e3)),1800),f(Ae,a=JSON.parse(localStorage.getItem("data")),a),f(He,l=JSON.parse(localStorage.getItem("explore")),l);return[s,i,c,u,m,h,p,g,y,v,b,k,r,e=>f(Te,r="Explore",r),e=>f(Te,r="Foreword",r),e=>f(Te,r="Afflatus",r),e=>f(Te,r="Archive",r),function(e){Y[e?"unshift":"push"]((()=>{s=e,n(0,s)}))},e=>n(1,i=!0)]}class Ft extends _e{constructor(e){super(),ke(this,e,Dt,Nt,s,{})}}const Yt={name:"报春的妖精",intro:"拥有告知春天到来程度的能力",detail:"不受任何效果影响，且攻击造成随机伤害。",type:"normal",scene:["shrine","forest"],growth:{health:.8,attack:1.2,speed:1},action:(e,t)=>{let n=Math.random();e.role.damage.target(0).from(t).by({type:"scale",value:200-100*n}),e.enermy.buff.of(t).clearAll()}},Xt={name:"梅蒂欣",intro:"扔到铃兰田的人偶化作的妖怪",detail:"铃兰花毒素的化身。\n生命值低于40%时吸收目标身上一半的[忧郁之毒]，回复等量生命。",type:"boss",growth:{health:3,attack:2,speed:1.2},onload:function(e,t){e.enermy.buff.of(t).set("poison_body",1)},action:function(e,t){let n=e.enermy.state.of(t).get();if(n.Health/n.health<.4){let n=e.role.buff.of(0).get("blue_poison");e.enermy.heal.target(t).by({type:"static",value:retain(n/2,0)}),e.role.buff.of(0).clear("blue_poison",retain(n/2,0))}e.role.buff.of(0).add("blue_poison",retain(.05*n.Health,0))}},Gt={name:"八坂神奈子",intro:"守矢神社祭祀的神之一，是蛇神和战神",detail:"每回合获得能阻挡伤害的[乾之盾]，奇数回合丢弃目标两张牌，偶数回合进行攻击。",type:"boss",growth:{health:3.5,attack:2,speed:1},onload:function(e,t){let n=e.enermy.state.of(t).get();e.enermy.buff.of(t).add("qianzhidun",retain(n.health/9,0))},action:function(e,t){let n=e.enermy.state.of(t).get();e.enermy.buff.of(t).add("qianzhidun",retain(n.health/9,0)),e.role.event.round.count%2==0?e.role.damage.target(0).from(t).by({type:"scale",value:200}):e.handcard.abandon.amount(2).fromHolds()}},Jt={name:"露米娅",intro:"拥有操纵黑暗程度的能力",detail:"会增加目标的卡牌灵力消耗，将目标所有牌的灵力消耗灵重新分配，并根据目标手牌数进行攻击。",type:"elite",scene:["forest","town"],growth:{health:1.5,attack:2,speed:1.5},onload:(e,t)=>{let n=e.handcard.getAll(),l=e.handcard.getCostOffset().index,a=n.map((e=>e.cost)).sum();a+=n.length;let o=n.map((e=>0));[...Array(a).keys()].forEach((e=>{let t=[...o.keys()].filter((e=>o[e]<20));o[t.rd()[0]]++})),o.forEach(((t,a)=>{e.handcard.setCost.byIndex(a,t-n[a].cost+l[a])}))},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:60,amount:e.handcard.getHolds().length+1})}},Wt={mokou:{name:"藤原妹红",intro:"不死的火鸟",detail:"每回合回复已损失生命的一半并造成等量伤害。",type:"boss",growth:{health:4,attack:2,speed:1.5},action:function(e,t){let n=e.enermy.state.of(t).get(),l=n.health-n.Health;e.role.damage.target(0).by({type:"static",value:l/2}),e.enermy.heal.target(t).by({type:"static",value:l/2})}},cirno:{name:"冰之妖精",intro:"冷酷的智者",detail:"奇数回合攻击附加[迟缓]，偶数回合攻击附加[疲倦]。",type:"normal",scene:["shrine","town"],growth:{health:1,attack:1,speed:1.2},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:100}),e.role.event.round.count%2==0?e.role.buff.of(0).add("tardy",2):e.role.buff.of(0).add("tired",1)}},piece:{name:"地狱的妖精",intro:"拥有使人发狂程度的能力",detail:"攻击附加[燃烧]，低生命时为全体附加[力量]。",type:"normal",scene:["shrine","town"],growth:{health:1,attack:1.2,speed:1},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:100});let n=e.enermy.state.of(t).get();n.Health/n.health<.5&&e.enermy.buff.addAll("strength",5),e.role.buff.of(0).add("burning",2)}},lilywhite:Yt,eternity:{name:"凤蝶的妖精",intro:"拥有播撒鳞粉程度的能力",detail:"攻击造成穿透伤害，附加[恍惚]效果",type:"normal",scene:["shrine","forest"],growth:{health:1.2,attack:1,speed:1.3},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:100,penetrate:!0}),e.role.buff.of(0).add("trance",2)}},chen:{name:"橙",intro:"生活在迷途之家的猫妖",detail:"灵活的猫妖，速度大于目标时会先手行动，且造成的伤害为穿透伤害。",type:"elite",scene:["shrine","town"],growth:{health:1.5,attack:2,speed:1.7},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:40,amount:4,penetrate:!0}),e.role.buff.of(0).add("bleed",1)},onload:(e,t)=>{e.role.state.of(0).get().speed<e.enermy.state.of(t).get().speed&&e.role.damage.target(0).from(t).by({type:"scale",value:80,penetrate:!0})}},daiyousei:{name:"大妖精",intro:"路过的较强妖精",detail:"回合初获得[自然加护]。",type:"elite",scene:["shrine","town"],growth:{health:1.5,attack:2,speed:1.3},onload:(e,t)=>{e.enermy.buff.of(t).set("natral_protect",4)},action:(e,t)=>{e.enermy.buff.of(t).set("natral_protect",4),e.role.damage.target(0).from(t).by({type:"scale",value:80})}},medicine:Xt,kanako:Gt,sunny:{name:"日光的妖精",intro:"具有操纵光的折射程度的能力",detail:"攻击造成多段伤害，还会回血。",type:"normal",scene:["forest","town"],growth:{health:1.2,attack:1,speed:1},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:80}),e.role.damage.target(0).from(t).by({type:"scale",value:60}),e.role.damage.target(0).from(t).by({type:"scale",value:40}),e.role.damage.target(0).from(t).by({type:"scale",value:20});let n=e.enermy.state.of(t).get();e.enermy.heal.targetAll().by({type:"static",value:(n.health-n.Health)/4})}},lunar:{name:"月光的妖精",intro:"拥有消除周围声音程度的能力",detail:"攻击时丢弃目标一张牌，还会回血。",type:"normal",scene:["forest","town"],growth:{health:1,attack:1,speed:1},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:150}),e.handcard.abandon.amount(1).fromHolds();let n=e.enermy.state.of(t).get();e.enermy.heal.targetAll().by({type:"static",value:(n.health-n.Health)/4})}},star:{name:"星光的妖精",intro:"感应到活动事物程度的能力",detail:"攻击附加虚弱，为全体附加力量，受攻击时50%概率闪避。",type:"normal",scene:["forest","town"],growth:{health:.8,attack:1,speed:1},action:(e,t)=>{e.role.damage.target(0).from(t).by({type:"scale",value:100}),e.role.buff.of(0).add("weak",2*e.role.event.round.count),e.enermy.buff.addAll("strength",2),e.enermy.buff.of(t).set("cautious",5)}},rumia:Jt,narumi:{name:"矢田寺成美",intro:"在魔法森林的魔力驱动下得到生命的地藏像",detail:"会不断重生，随着被打败次数的增加而增加攻击、减少生命上限，唯有一击将其打败才是真正战胜她。",type:"elite",scene:["forest","town"],growth:{health:1.5,attack:2,speed:1.3},onload:(e,t)=>{e.cache.narumi||(e.cache.narumi=[]),e.cache.narumi[t]=1},action:(e,t)=>{let n=e.cache.narumi[t];e.role.damage.target(0).from(t).by({type:"scale",value:50*n}),n>1&&e.enermy.buff.of(t).set("magic_life",n-1)}},nitori:{name:"河童",intro:"拥有操纵水程度的能力",detail:"会妨碍目标的治疗，攻击时回复自身少量生命，第三回合初逃跑。",type:"normal",scene:["town"],growth:{health:1,attack:1.2,speed:1},onload:(e,t)=>{e.role.buff.of(0).set("water_joke",2)},action:(e,t)=>{e.role.buff.of(0).set("water_joke",2),e.role.damage.target(0).from(t).by({type:"scale",value:70,amount:2});let n=e.enermy.state.of(t).get();e.enermy.heal.target(t).by({type:"static",value:.1*n.health}),3==e.role.event.round.count&&e.battle.runOutAway(t)}},koakuma:{name:"小恶魔",intro:"不知为何出现在外界的神秘的恶魔",detail:"在自己的回合以外受到的伤害-90%，并造成等量反伤，攻击能力强，第四回合生命值变为1。",type:"elite",scene:["town"],growth:{health:1.2,attack:2,speed:1.3},onload:(e,t)=>{e.enermy.buff.of(t).set("iron_skin",9),e.cache.koakuma||(e.cache.koakuma=[]),e.cache.koakuma[t]=1},action:(e,t)=>{e.enermy.buff.of(t).add("strength",2),e.role.buff.of(0).add("bleed",4),e.role.buff.of(0).add("burning",4),e.role.damage.target(0).from(t).by({type:"scale",value:180}),3==e.role.event.round.count&&e.enermy.state.of(t).set("Health",.1),e.enermy.buff.of(t).set("iron_skin",9)}}};for(let e in Wt){const t={normal:"blue",elite:"green",boss:"red"};Wt[e].color=t[Wt[e].type];let n=Wt[e].growth;Wt[e].growth=e=>Ut(e,n);let l=Wt[e].action;Wt[e].action=(e,t)=>Zt(e,t,(n=>l(e,t)))}function Zt(e,t,n){let l={valid:!0,index:t};et.enermyAction(e,l),l.valid&&n()}function Ut(e,t){return{health:Vt(Qt(e)*t.health),attack:Vt(Qt(e)*t.attack/8),speed:1+.02*(e-1)*t.speed}}function Qt(e){return parseInt(Math.pow(Math.E,e/(Math.log(e+1)+Math.sqrt(e)))+e+10)}function Vt(e){return.95*e+Math.random().toFixed(2)*e*.1}const en={};Object.assign(en,{hypodynamic:{name:"乏力",detail:"回合初失去所有灵力。",expend:!0},orrerys_sun:{name:"太阳仪",detail:"直接攻击在次回合造成120%*1(每层+1)间接伤害。生效时层数-1。",positive:!0},marisa_time:{name:"魔理沙时间",detail:"暴击率+30%。",positive:!0,interim:!0},grand_cross:{name:"大十字",detail:"接下来的1(每层+1)次伤害，暴击伤害+100%。",positive:!0,expend:!0},test_slave:{name:"试验用使魔",detail:"所有伤害截走25%，在回合末合并结算为群体伤害。",positive:!0},milky_way:{name:"银河",detail:"伤害+1",positive:!0}}),Object.assign(en,{Bright_Bitter_Wheel:{name:"幽明的苦轮",detail:"攻击附带60%间接伤害并回复1点灵力。生效时层数-1。",positive:!0,expend:!0},flow:{name:"流转",detail:"普通攻击伤害提高40%。生效时层数-1。",positive:!0,expend:!0},yanfan:{name:"燕返",detail:"普通攻击替换为「燕返: 对目标造成2*70%攻击力伤害」。生效时层数-1。",positive:!0,expend:!0},meditation_slash:{name:"冥想斩",detail:"普通攻击消耗的灵力+1，伤害提高200%。每回合初清空。",positive:!0,interim:!0},telepathism:{name:"通灵",detail:"10%(每层+10%)几率闪避下一次攻击。每回合初清空。",positive:!0,interim:!0},six_roots_clean:{name:"六根清净斩",detail:"下次受到攻击时闪避，并造成15群体伤害",positive:!0,expend:!0}}),Object.assign(en,{illusory:{name:"虚幻",detail:"命中率*95%(每层*95%)。"},lunatic:{name:"狂气",detail:"受到的伤害+5%(每层+5%)。"},insanity:{name:"疯狂",detail:"受到1(每层+1)穿透伤害。"}}),Object.assign(en,{pure_happy:{name:"清欢",detail:"回合开始时造成1(每层+1)群体穿透伤害。每受到1伤害层数-2。",positive:!0},font_safe:{name:"前方安全",detail:"造成伤害时，回复5生命值，获得恍惚*2。回合初清除。",interim:!0,positive:!0},hakurei_phantom:{name:"博丽幻影",detail:"40%概率闪避伤害，闪避时获得清欢*4。回合初清除。",interim:!0,positive:!0},trance_cage:{name:"妖怪拘禁符",detail:"下次行动变为附加恍惚*3。生效时层数-1。",expend:!0},waiting_pearl:{name:"明珠暗投",detail:"回合初获得清欢*12，抽两张牌。生效时层数-1。",expend:!0,positive:!0},yinyang_bird:{name:"阴阳飞鸟井",detail:"打出符卡时40%概率获得2额外灵力。回合初清除。",positive:!0,interim:!0},eight_dragon_kill:{name:"八方龙杀阵",detail:"受到伤害-30%，速度-1。",positive:!0},big_bad_sun:{name:"大祸津日",detail:"造成伤害-90%，治疗效果+100%。回合初清除。",positive:!0,interim:!0}});const tn={tired:{name:"疲倦",detail:"回合开始时回复灵力减少1(每层+1)。生效时层数-1。",expend:!0},prophesy:{name:"预言",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。每回合初清空。",positive:!0,expend:!0,interim:!0},foresee:{name:"预知",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。",positive:!0,expend:!0},interim_barrier:{name:"临时防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。每回合初清空。",positive:!0,interim:!0},barrier:{name:"防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。",positive:!0},burning:{name:"燃烧",detail:"每回合扣除3%(每层+3%)最大生命值。生效时层数-1。",expend:!0},bleed:{name:"流血",detail:"每回合受到1(每层+1)额外伤害。受治疗时移除。"},tardy:{name:"迟缓",detail:"速度*95%(每层*95%)。回合初层数-1。",decrease:!0},fragile:{name:"易伤",detail:"受到伤害+10%(每层+10%)。",interim:!0,roundend:!0},strength:{name:"力量",detail:"造成的伤害+10%(每层+10%)。",positive:!0},insulation:{name:"绝缘",detail:"无法获得任何灵力。",interim:!0,roundend:!0},throttle:{name:"节流",detail:"灵力消耗-1(每层-1)。",positive:!0,interim:!0},iron_skin:{name:"很安全的空间",detail:"受到的伤害-10%(每层-10%)。",positive:!0,interim:!0},weak:{name:"虚弱",detail:"造成的伤害-10%(每层-10%)。",interim:!0,roundend:!0},interim_strength:{name:"临时力量",detail:"造成的伤害+10%(每层+10%)。回合初清除。",positive:!0,interim:!0},accelerate:{name:"加速",detail:"速度+0.1(每层+0.1)。",positive:!0},trance:{name:"恍惚",detail:"命中率-10%(每层-10%)。",interim:!0,roundend:!0},strong_luck:{name:"强运",detail:"概率判定均为正面。回合初清除。",interim:!0,positive:!0},charging:{name:"充能",detail:"回合初获得1(每层+1)额外灵力。回合初移除。",interim:!0,positive:!0},focus:{name:"专注",detail:"符卡造成的伤害+10%(每层+10%)。回合初移除。",positive:!0,interim:!0},exposure:{name:"曝光",detail:"受到伤害均为穿透伤害，持续1(每层+1)回合。",decrease:!0},cautious:{name:"谨慎",detail:"10%(每层+10%)概率闪避伤害。",positive:!0}};Object.assign(tn,{baka:{name:"冰雪聪明",detail:"速度+0.2(每层+0.2)。",positive:!0},shy_rabbit:{name:"兔兔探头",detail:"我只是害羞，我可不受。",positive:!0},slow_power:{name:"渐渐涌上来的POWER",detail:"暴击率+5%(每层+5%)。",positive:!0},in_treatment:{name:"治疗中",detail:"回合初回复5%(每层+5%)当前生命值。",positive:!0,interim:!0},seal_needle:{name:"封魔针",detail:"造成8(每层-1)次伤害后，攻击对全体敌人附加流血。"},cursed_wind:{name:"诅咒之风",detail:"接下来的1(每层+1)次攻击会驱散目标身上所有正面效果。生效时层数-1。",positive:!0,expend:!0},star:{name:"星星",detail:"天上的星星不装在瓶子里可是会爆炸的！",positive:!0}}),Object.assign(tn,en),Object.assign(tn,{rhythm:{name:"节奏感",detail:"打出通式时回复3(每层+3)生命值。",positive:!0},magic_bean:{name:"魔豆",detail:"回合初获得2额外灵力，持续1(每层+1)回合。",positive:!0,expend:!0},blood_blade:{name:"血刃",detail:"造成伤害时，伤害+8，生命值-4。回合初移除。",interim:!0},wrath:{name:"暴怒",detail:"普通攻击伤害+30%(每层+30%)。回合初移除。",interim:!0},lust:{name:"色欲",detail:"下次行动变为造成15%最大生命值的伤害。",expend:!0},humility:{name:"谦逊",detail:"通式灵力消耗-1(每层-1)。回合初移除。",interim:!0,positive:!0},diligence:{name:"勤奋",detail:"手牌灵力消耗+2，效果翻倍。回合初移除。",positive:!0,interim:!0}}),Object.assign(tn,{natral_protect:{name:"自然加护",detail:"受到伤害时将伤害变为5，并对伤害来源附加流血*2。生效时层数-1。回合初移除。",interim:!0,expend:!0,positive:!0},poison_body:{name:"毒气花园",detail:"受到伤害时对伤害来源附加神经之毒*1。",positive:!0},spirit_poison:{name:"神经之毒",detail:"回合初受到等同于5%(每层+5%)当前生命值的额外伤害，获得恍惚*1(每层+1)。",interim:!0},blue_poison:{name:"忧郁之毒",detail:"回合结束时受到1(每层+1)间接伤害。"},qianzhidun:{name:"乾之盾",detail:"阻挡1(每层+1)点伤害，低于层数一半的伤害减半。生效时层数-1。",positive:!0},magic_life:{name:"魔法生命",detail:"这是你第1(每层+1)次击败矢田寺成美。",positive:!0},water_joke:{name:"水的花招",detail:"受到的治疗转化为对自身造成等量伤害。"}});const nn={};Object.assign(nn,Qe),Object.assign(nn,Ve);const ln={collection:Ne,equipment:Ke,souvenir:De,spellcard:Qe,basecard:Ve,role:Ye,consumable:Fe,card:nn,enermy:Wt,buff:tn,scene:{shrine:{name:"博丽神社",detail:"明明是驱逐妖怪的巫女居住的神社，却不知为何挤了一屋子妖怪，周遭还有各种妖精出没……"},forest:{name:"魔法森林",detail:"幻想乡中湿度最高，很少有人踏足的原始森林，住着好多魔法使。"},town:{name:"人间之里",detail:"幻想乡中最多人类居住的地方。因为有许多妖怪也会光临的店，所以会有各种妖怪到访，不过都是些安分的妖怪，这是一个和平的地方。"}}};for(let e in ln.souvenir)ln.souvenir[e].type="purple";function an(e,t,n){const l=e.slice();return l[15]=t[n],l[16]=t,l[17]=n,l}function on(e,t,n){const l=e.slice();return l[18]=t[n],l}function rn(e){let t,n,l,a,o,r,s=Ye[e[18]].name+"";function i(...t){return e[5](e[18],...t)}return{c(){t=j("txt"),n=O(s),l=j("br"),A(t,"class",a="role-selection "+(!e[2].unlocked.role.includes(e[18])&&"locked")+" svelte-1jhlax9")},m(e,a){x(e,t,a),b(t,n),b(t,l),o||(r=C(t,"click",i),o=!0)},p(n,l){e=n,4&l&&a!==(a="role-selection "+(!e[2].unlocked.role.includes(e[18])&&"locked")+" svelte-1jhlax9")&&A(t,"class",a)},d(e){e&&w(t),o=!1,r()}}}function sn(e,t){let n,l,a,o,r,s,i=t[3][t[15]].name+"",c=t[0].difficulty==t[15]?"☑":"☐",d=t[17];function u(...e){return t[6](t[15],...e)}const f=()=>t[7](n,d),m=()=>t[7](null,d);return{key:e,first:null,c(){n=j("txt"),l=O(i),a=T(),o=O(c),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),b(n,o),f(),r||(s=C(n,"click",u),r=!0)},p(e,n){t=e,1&n&&c!==(c=t[0].difficulty==t[15]?"☑":"☐")&&E(o,c),d!==t[17]&&(m(),d=t[17],f())},d(e){e&&w(n),m(),r=!1,s()}}}function cn(e){let t,n,l,o,r,s,i,d,u,f,m,h,p,g,y,v,k,_,M,q,L,z,S,I,R,B,P,N,K,D,F,Y,X,G,J,W,U,Q,V,ee,te,ne,le,ae,oe,re,se,ie,ce,de,he,ge,ye,ve,be,ke,_e,xe,$e,je,Oe,Te,Me,Ce=Ye[e[0].role].name+"",Ae=Ye[e[0].role].detail+"",Ee=[],He=new Map,qe=e[0].sugar+"",Le=Object.keys(Ye),ze=[];for(let t=0;t<Le.length;t+=1)ze[t]=rn(on(e,Le,t));let Se=Object.keys(e[3]);const Ie=e=>e[17];for(let t=0;t<Se.length;t+=1){let n=an(e,Se,t),l=Ie(n);He.set(l,Ee[t]=sn(l,n))}return{c(){t=j("div"),n=j("div"),l=j("div"),l.innerHTML='<div class="page-inner svelte-1jhlax9" contenteditable="">序言\n        最近老是做梦，梅莉也是，仔细想想是上次从神社回来开始的，要解释成灵异现象吗？\n        不过梦里的那些体验倒也蛮新奇的，被怂恿后就决定写成一本小说了，名字还没想好，以后再决定吧，本着“小说的开端肯定是序言吧！”的想法，这篇序言就开始写了，写写停停，因为没想到事由简单一句话就带过了，后面都不会凑了。\n        梅莉陪我商量了很多，人物啊，对话啊，场景啊，她的表达能力可真好，梦里很多东西我都只是有画面而不知道如何描述。哈，这小说都没有主题呢，我的初心应该只是“记录”，不要纠结好了。\n        不知不觉写了好多，已经快写完了，在写结局之前我问了一下梅莉最喜欢的情景，以此决定结局走向，她意外地喜欢云之海。\n        都要写完了，结果序言也没添几句，后记的性质好像和序言差不多，但是可以尽情剧透。\n        先这样吧。</div>',o=T(),r=j("div"),s=j("div"),i=j("div"),d=O("主要人物"),u=j("br"),f=T();for(let e=0;e<ze.length;e+=1)ze[e].c();m=T(),h=j("br"),p=T(),g=j("div"),y=j("img"),k=T(),_=j("div"),M=j("br"),q=O(Ce),L=j("br"),z=O("\r\n          上手难度："),S=j("br"),I=O("✪✪✪✫✫"),R=j("br"),B=j("br"),P=T(),N=j("div"),K=O(Ae),D=T(),F=j("div"),F.textContent="+-+-+-+-+ 割线分 +-+-+-+-+",Y=T(),X=j("br"),G=T(),J=j("div"),W=j("div"),U=j("br"),Q=j("txt"),Q.textContent="风格",V=j("br"),ee=T(),te=j("div");for(let e=0;e<Ee.length;e+=1)Ee[e].c();ne=T(),le=j("div"),ae=j("br"),oe=T(),re=j("div"),se=j("txt"),se.textContent="选项数量： ",ie=T(),ce=j("txt"),ce.textContent="-",de=T(),he=j("txt"),ge=O(qe),ye=T(),ve=j("txt"),ve.textContent="+",be=T(),ke=j("div"),ke.textContent="就这样吧！",_e=T(),xe=j("div"),xe.textContent="右键回到标题界面",A(l,"class","left svelte-1jhlax9"),A(i,"class","role"),c(y.src,v="/img/role/dairi/"+e[0].role+".webp")||A(y,"src",v),A(y,"class","svelte-1jhlax9"),A(g,"class","avatar svelte-1jhlax9"),A(N,"class","role-detail svelte-1jhlax9"),A(_,"class","role-props svelte-1jhlax9"),A(F,"class","divided_line svelte-1jhlax9"),A(Q,"class","svelte-1jhlax9"),A(te,"class","selection svelte-1jhlax9"),A(W,"class","difficulty svelte-1jhlax9"),H(he,"text-align","center"),H(he,"width","40px"),A(re,"class","svelte-1jhlax9"),A(le,"class","sugar svelte-1jhlax9"),A(ke,"class","launch svelte-1jhlax9"),A(s,"class","page-inner svelte-1jhlax9"),A(r,"class","right svelte-1jhlax9"),A(n,"class","notebook svelte-1jhlax9"),A(xe,"class","remind svelte-1jhlax9"),A(t,"class","body svelte-1jhlax9")},m(a,c){x(a,t,c),b(t,n),b(n,l),b(n,o),b(n,r),b(r,s),b(s,i),b(i,d),b(i,u),b(i,f);for(let e=0;e<ze.length;e+=1)ze[e]&&ze[e].m(i,null);b(i,m),b(i,h),b(s,p),b(s,g),b(g,y),b(s,k),b(s,_),b(_,M),b(_,q),b(_,L),b(_,z),b(_,S),b(_,I),b(_,R),b(_,B),b(_,P),b(_,N),b(N,K),b(s,D),b(s,F),b(s,Y),b(s,X),b(s,G),b(s,J),b(J,W),b(W,U),b(W,Q),b(W,V),b(W,ee),b(W,te);for(let e=0;e<Ee.length;e+=1)Ee[e]&&Ee[e].m(te,null);b(J,ne),b(J,le),b(le,ae),b(le,oe),b(le,re),b(re,se),b(re,ie),b(re,ce),b(re,de),b(re,he),b(he,ge),b(re,ye),b(re,ve),b(s,be),b(s,ke),b(t,_e),b(t,xe),Oe=!0,Te||(Me=[C(ce,"click",e[8]),C(ve,"click",e[9]),C(ke,"click",e[4])],Te=!0)},p(e,[t]){if(5&t){let n;for(Le=Object.keys(Ye),n=0;n<Le.length;n+=1){const l=on(e,Le,n);ze[n]?ze[n].p(l,t):(ze[n]=rn(l),ze[n].c(),ze[n].m(i,m))}for(;n<ze.length;n+=1)ze[n].d(1);ze.length=Le.length}(!Oe||1&t&&!c(y.src,v="/img/role/dairi/"+e[0].role+".webp"))&&A(y,"src",v),(!Oe||1&t)&&Ce!==(Ce=Ye[e[0].role].name+"")&&E(q,Ce),(!Oe||1&t)&&Ae!==(Ae=Ye[e[0].role].detail+"")&&E(K,Ae),11&t&&(Se=Object.keys(e[3]),Ee=pe(Ee,t,Ie,1,e,Se,He,te,me,sn,null,an)),(!Oe||1&t)&&qe!==(qe=e[0].sugar+"")&&E(ge,qe)},i(e){Oe||(Z((()=>{Oe&&(je&&je.end(1),$e=ue(t,we,{duration:250}),$e.start())})),Oe=!0)},o(e){$e&&$e.invalidate(),je=fe(t,we,{duration:250}),Oe=!1},d(e){e&&w(t),$(ze,e);for(let e=0;e<Ee.length;e+=1)Ee[e].d();e&&je&&je.end(),Te=!1,a(Me)}}}function dn(e,t,n){let l,a,o,r,s,i;d(e,ze,(e=>n(10,l=e))),d(e,Te,(e=>n(11,a=e))),d(e,He,(e=>n(12,o=e))),d(e,Ae,(e=>n(13,r=e))),d(e,Me,(e=>n(14,s=e))),d(e,Ce,(e=>n(2,i=e)));let c={role:"marisa",difficulty:"normal",sugar:3},u={easy:{name:"轻松",detail:"有3次战败时回到战斗前的机会。机会消耗时，回复生命值并获得一件普通收藏品。",type:"blue",amount:3},normal:{name:"平实",detail:"有2次战败时回到战斗前的机会。机会消耗时，回复生命值并获得一件稀有收藏品。",type:"green",amount:2},hard:{name:"紧张",detail:"有1次战败时回到战斗前的机会。机会消耗时，回复生命值并获得一件传奇收藏品。",type:"red",amount:1}};const m=[];K((function(){m.forEach(((e,t)=>{let n=Object.keys(u)[t];s(e).color(u[n].type).with(u[n])}))}));return[c,m,i,u,function(){f(Ae,r={collection:{},equipment:!1,consumable:{},card:{},souvenir:!1,role:c.role,sugar:c.sugar,consumableLimit:3,chance:u[c.difficulty],health:0,coin:500,scene:"shrine",stage:1,blackList:[],statistics:[],coin_reward_total:0},r),f(Ae,r.card[c.role]=4,r),ln.keys().spellcard.filter((e=>ln.spellcard[e].role==c.role)).rd().splice(0,3).forEach((e=>e.increaseOf(r.card))),ln.keys().basecard.rd().splice(0,3).forEach((e=>e.increaseOf(r.card))),f(He,o={enermy:[],eventSummoned:!1,enermyLimit:4,lv:9,pricelv:1,boss:["kanako","medicine","mokou"]},o),f(Te,a="Explore",a),l.menu()},(e,t)=>{i.unlocked.role.includes(e)?n(0,c.role=e,c):window.msg({content:"该角色尚未解锁"})},(e,t)=>n(0,c.difficulty=e,c),function(e,t){Y[e?"unshift":"push"]((()=>{m[t]=e,n(1,m)}))},e=>n(0,c.sugar=Math.max(c.sugar-1,1),c),e=>n(0,c.sugar=Math.min(c.sugar+1,5),c)]}ln.keys=function(){const e={};for(let t in this)e[t]=Object.keys(this[t]);return e};class un extends _e{constructor(e){super(),ke(this,e,dn,cn,s,{})}}var fn={bottle:{name:"瓶子",detail:"脚边有一个脏兮兮的瓶子，里面有东西在发光。",type:"selection",scene:["shrine","forest"]},itemshop:{name:"香霖堂",detail:"奇怪的杂货店，店主看上去很友好。",type:"shop"},bookshop:{name:"铃奈庵",detail:"不仅有故事书，还有记录妖术的妖魔书。",type:"shop"},canteen:{name:"鲵吞亭",detail:"奇妙的居酒屋，有一位可爱的看板娘。",type:"shop",product:{group:[{forget:3,"consumable(canteen)":3}],weight:[1],size:"M"}},yakumo:{name:"八云邸",detail:"浓厚的历史气息。却有些人类世界的道具。",type:"selection",dialogue:"yakumo"},school:{name:"寺子屋",detail:"人类村落中的一所学校。学习知识的地方。",type:"special"},chest:{name:"宝箱",detail:"地上真的会凭空出现宝箱吗？真的可以打开吗？",type:"reward"},turntable:{name:"幸运转盘",detail:"看来能获得一些稀奇的东西，反正不是坏事！",type:"game"},shrine:{name:"天降御守",detail:"要不打开看一下吧，万一是大吉呢？",type:"rule?"},zixuan:{name:"稻荷祠堂",detail:"满是青苔，虽年久失修，看着却让人感到安心。",type:"reward"},coin:{name:"硬币",detail:"捡到钱啦！",type:"reward"},delete_and_many:{name:"选择",detail:"将一件收藏品从本次游戏中移除，并获得大量另一件收藏品。",type:"selection"},dragon:{name:"龙神像",detail:"风雨的祝福。",type:"rule"},the_666:{name:"骰子大师",detail:"投出两个6就有大奖，次数越多奖励越少。",type:"game"},p21:{name:"二十一点",detail:"打牌，赢了就有大奖。",type:"game"},donate_blood:{name:"爱心血站",detail:"只要人人都献出一点爱，世界就会变成美好的人间。",type:"selection"},dizang:{name:"地藏像",detail:"看起来已经很旧了。",type:"selection?"},yuehong:{name:"月虹市场",detail:"位于高空的云层中，是一个用于交易卡牌的集市。",type:"shop?"},yequeshitang:{name:"夜雀食堂",detail:"有着红色灯笼的移动货摊。不是烤（鸟）肉店而是烤鳗鱼店。",type:"shop?"},copy:{name:"复制",detail:"复制什么都可以哦。",type:"special"},change:{name:"转化",detail:"变成什么都别怨我哦。",type:"special"},shoucangjia:{name:"收藏家",detail:"只收不换，只买不卖，只一不二。",type:"special"},wanted:{name:"悬赏",detail:"收人钱财，替人消灾。",type:"special?"},zagu:{name:"杂鱼",detail:"反正是杂鱼，顺手收拾掉吧。",type:"enermy",unbreakable:!0},elite:{name:"强敌",detail:"比杂鱼要强，要认真应对了。",type:"enermy",unbreakable:!0},boss:{name:"BOSS",detail:"这种强大的气场，只能用BOSS来形容了。",type:"enermy",unbreakable:!0},xijian:{name:"隙间",detail:"某个妖怪随意留下的隙间，不知通向何方。",type:"rule",unbreakable:!0},big_chest:{name:"特大宝箱",detail:"是很大很大很大的宝箱没错，但不知为何有个投币口。",type:"reward"},muxiazi:{name:"木匣子",detail:"就当是宝箱好了。",type:"reward"},diaochuang:{name:"吊床",detail:"看起来摇摇晃晃的，想必是非常新奇的体验。",type:"reward"},laohuji:{name:"老虎机",detail:"真的不来试试看？真的不来试试看？真的不来试试看？",type:"game"},yidongba:{name:"移动靶场",detail:"射中啥就是啥，绝不赖皮！",type:"game"}};function mn(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),o=O(M),r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="踢开",h=T(),p=j("br"),g=T(),y=j("br"),v=T(),k=j("txt"),k.textContent="捡起",A(l,"class","svelte-n7cuwa"),A(m,"class","selection svelte-n7cuwa"),A(k,"class","selection svelte-n7cuwa"),A(n,"class","content svelte-n7cuwa")},m(e,a){x(e,n,a),b(n,l),b(l,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),_||($=[C(m,"click",t[3]),C(k,"click",t[4])],_=!0)},p(e,[t]){1&t&&M!==(M=e[0].detail+"")&&E(o,M)},i:e,o:e,d(e){e&&w(n),_=!1,a($)}}}function hn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;const o=[{detail:"踢开",handle:[{content:"瓶子爆炸了，烟雾中出现了许多身影。",return:"summonElite(1)"},{content:"什么都没有发生",return:"null(null)"}],weight:[1,1]},{detail:"捡起",handle:[{content:"瓶子吸走了你10生命值，消失了。",return:"health(-10)"},{content:"光芒散去，瓶子里是一件收藏品。",return:"collection(white)"}],weight:[4,6]}];return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,o,e=>{Math.random()<.5?(window.msg(o[0].handle[0]),l.event.summonZagu()):window.msg(o[0].handle[1]),l.event.finish()},e=>{Math.random()<.4?(window.msg(o[1].handle[0]),f(ze,l.data.health=Math.max(1,l.data.health-10),l)):(window.msg(o[1].handle[1]),l.event.getCollection("green")),l.event.finish()}]}function pn(e,t,n){const l=e.slice();return l[9]=t[n],l[10]=t,l[11]=n,l}function gn(e,t){let n,l,a,o,r,s,i,c,d=t[9].piece+"",u=t[11];const f=()=>t[3](n,u),m=()=>t[3](null,u);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),r=j("txt"),s=j("icon"),i=O(d),c=T(),A(l,"class",a="icon-"+t[9].key+" svelte-141zm13"),A(s,"class","icon-coin"),A(r,"class","svelte-141zm13"),A(n,"class","product svelte-141zm13"),H(n,"background-color","var(--"+t[9].color+")"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),b(n,r),b(r,s),b(r,i),b(n,c),f()},p(e,o){t=e,2&o&&a!==(a="icon-"+t[9].key+" svelte-141zm13")&&A(l,"class",a),2&o&&d!==(d=t[9].piece+"")&&E(i,d),2&o&&H(n,"background-color","var(--"+t[9].color+")"),u!==t[11]&&(m(),u=t[11],f())},d(e){e&&w(n),m()}}}function yn(t){let n,l,a,o,r,s=t[0].detail+"",i=[],c=new Map,d=t[1];const u=e=>e[11];for(let e=0;e<d.length;e+=1){let n=pn(t,d,e),l=u(n);c.set(l,i[e]=gn(l,n))}return{c(){n=j("div"),l=j("txt"),a=O(s),o=T(),r=j("div");for(let e=0;e<i.length;e+=1)i[e].c();A(l,"class","svelte-141zm13"),A(r,"class","products svelte-141zm13"),A(n,"class","content svelte-141zm13")},m(e,t){x(e,n,t),b(n,l),b(l,a),b(n,o),b(n,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(r,null)},p(e,[t]){1&t&&s!==(s=e[0].detail+"")&&E(a,s),6&t&&(d=e[1],i=pe(i,t,u,1,e,d,c,r,me,gn,null,pn))},i:e,o:e,d(e){e&&w(n);for(let e=0;e<i.length;e+=1)i[e].d()}}}function vn(e,t,n){let l,a;d(e,ze,(e=>n(5,l=e))),d(e,Me,(e=>n(6,a=e)));let o,{info:r}=t;const s=[],i={};return["blue","green","red"].map((e=>{i[e]=function(){return{key:Object.keys(Ne).filter((t=>Ne[t].type==e)).rd()[0],color:e,piece:{blue:200,green:500,red:1e3}[e],left:{blue:4,green:2,red:1}[e]}}})),r.cache.product?o=r.cache.product:r.cache.product=function(){let e=[],t={red:1,green:2,blue:3};for(let n in t)[...Array(t[n]).keys()].forEach((t=>e.push(i[n]())));Math.random()>.5&&(e[0]={key:Object.keys(Ke).rd()[0],color:"gold",piece:500,left:1});return n(1,o=l.discount(e)),e}(),K((function(){s.forEach(((e,t)=>{let r;r=o[t].key in Ne?Ne[o[t].key]:Ke[o[t].key],a(e).color(o[t].color).with(r),e.onclick=e=>{var a;"gray"!=(a=o[t]).color&&(l.data.coin>=a.piece?(n(1,o),f(ze,l.data.coin-=a.piece,l),a.left--,"gold"==a.color?(f(ze,l.data.equipment=a.key,l),msg({content:`已购买[${Ke[a.key].name}]`})):(a.key.increaseOf(l.data.collection),msg({content:`已购买[${Ne[a.key].name}]`})),a.left<1&&(a.color="gray")):msg({content:"硬币不足"}))}}))})),e.$$set=e=>{"info"in e&&n(0,r=e.info)},[r,o,s,function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(2,s)}))}]}function bn(e,t,n){const l=e.slice();return l[8]=t[n],l[9]=t,l[10]=n,l}function kn(e,t){let n,l,a,o,r=t[10];l=new at({props:{key:t[8].key,cover:t[8].sold&&{name:"空",detail:"已售罄"}}});const s=()=>t[3](n,r),i=()=>t[3](null,r);return{key:e,first:null,c(){n=j("div"),ge(l.$$.fragment),a=T(),A(n,"class","product svelte-175k9tw"),this.first=n},m(e,t){x(e,n,t),ye(l,n,null),b(n,a),s(),o=!0},p(e,n){t=e;const a={};2&n&&(a.key=t[8].key),2&n&&(a.cover=t[8].sold&&{name:"空",detail:"已售罄"}),l.$set(a),r!==t[10]&&(i(),r=t[10],s())},i(e){o||(ie(l.$$.fragment,e),o=!0)},o(e){ce(l.$$.fragment,e),o=!1},d(e){e&&w(n),ve(l),i()}}}function _n(e){let t,n,l,a,o,r,s=e[0].detail+"",i=[],c=new Map,d=e[1];const u=e=>e[10];for(let t=0;t<d.length;t+=1){let n=bn(e,d,t),l=u(n);c.set(l,i[t]=kn(l,n))}return{c(){t=j("div"),n=j("txt"),l=O(s),a=T(),o=j("div");for(let e=0;e<i.length;e+=1)i[e].c();A(n,"class","svelte-175k9tw"),A(o,"class","products svelte-175k9tw"),A(t,"class","content svelte-175k9tw")},m(e,s){x(e,t,s),b(t,n),b(n,l),b(t,a),b(t,o);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(o,null);r=!0},p(e,[t]){(!r||1&t)&&s!==(s=e[0].detail+"")&&E(l,s),6&t&&(d=e[1],re(),i=pe(i,t,u,1,e,d,c,o,he,kn,null,bn),se())},i(e){if(!r){for(let e=0;e<d.length;e+=1)ie(i[e]);r=!0}},o(e){for(let e=0;e<i.length;e+=1)ce(i[e]);r=!1},d(e){e&&w(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}function xn(e,t,n){let l,a;d(e,ze,(e=>n(4,l=e))),d(e,Me,(e=>n(5,a=e)));let o,{info:r}=t;const s=[];return r.cache.product?o=r.cache.product:r.cache.product=function(){let e=Object.keys(Ve).rd().splice(0,l.data.sugar+3).map((e=>({key:e,piece:450,sold:!1})));return n(1,o=l.discount(e)),e}(),K((function(){s.forEach(((e,t)=>{let r={name:"价格",detail:o[t].piece};a(e).with(r),e.onclick=e=>{var a;(a=o[t]).sold||(l.data.coin>=a.piece?(n(1,o),f(ze,l.data.coin-=a.piece,l),a.key.increaseOf(l.data.card),msg({content:`已购买[${Ve[a.key].name}]`}),a.sold=!0):msg({content:"硬币不足"}))}}))})),e.$$set=e=>{"info"in e&&n(0,r=e.info)},[r,o,s,function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(2,s)}))}]}function wn(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),o=O(M),r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="休息一下",h=T(),p=j("br"),g=T(),y=j("br"),v=T(),k=j("txt"),k.textContent="获得纪念品",A(l,"class","svelte-1ogutcc"),A(m,"class","selection svelte-1ogutcc"),A(k,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,a){x(e,n,a),b(n,l),b(l,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),_||($=[C(m,"click",t[2]),C(k,"click",t[3])],_=!0)},p(e,[t]){1&t&&M!==(M=e[0].detail+"")&&E(o,M)},i:e,o:e,d(e){e&&w(n),_=!1,a($)}}}function $n(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.heal(100,!0),l.event.finish(),window.msg({content:"感觉精神饱满"})},e=>{l.event.getSouvenir(),l.event.finish()}]}function jn(e,t,n){const l=e.slice();return l[8]=t[n],l[9]=t,l[10]=n,l}function On(e,t){let n,l,a,o,r,s,i,c,d=t[8].piece+"",u=t[10];const f=()=>t[3](n,u),m=()=>t[3](null,u);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),r=j("txt"),s=j("icon"),i=O(d),c=T(),A(l,"class",a="icon-"+t[8].key+" svelte-1jdgn6v"),A(s,"class","icon-coin"),A(r,"class","svelte-1jdgn6v"),A(n,"class","product svelte-1jdgn6v"),H(n,"background-color","var(--"+t[8].color+")"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),b(n,r),b(r,s),b(r,i),b(n,c),f()},p(e,o){t=e,2&o&&a!==(a="icon-"+t[8].key+" svelte-1jdgn6v")&&A(l,"class",a),2&o&&d!==(d=t[8].piece+"")&&E(i,d),2&o&&H(n,"background-color","var(--"+t[8].color+")"),u!==t[10]&&(m(),u=t[10],f())},d(e){e&&w(n),m()}}}function Tn(t){let n,l,a,o,r,s=t[0].detail+"",i=[],c=new Map,d=t[1];const u=e=>e[10];for(let e=0;e<d.length;e+=1){let n=jn(t,d,e),l=u(n);c.set(l,i[e]=On(l,n))}return{c(){n=j("div"),l=j("txt"),a=O(s),o=T(),r=j("div");for(let e=0;e<i.length;e+=1)i[e].c();A(l,"class","svelte-1jdgn6v"),A(r,"class","products svelte-1jdgn6v"),A(n,"class","content svelte-1jdgn6v")},m(e,t){x(e,n,t),b(n,l),b(l,a),b(n,o),b(n,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(r,null)},p(e,[t]){1&t&&s!==(s=e[0].detail+"")&&E(a,s),6&t&&(d=e[1],i=pe(i,t,u,1,e,d,c,r,me,On,null,jn))},i:e,o:e,d(e){e&&w(n);for(let e=0;e<i.length;e+=1)i[e].d()}}}function Mn(e,t,n){let l,a;d(e,ze,(e=>n(4,l=e))),d(e,Me,(e=>n(5,a=e)));let o,{info:r}=t;const s=[];return r.cache.product||(r.cache.product=function(){let e=[{key:"forget",piece:0,color:"red"},{key:"forget",piece:300,color:"red"},{key:"forget",piece:500,color:"red"},{key:"heal",piece:150,color:"green"},{key:"heal",piece:150,color:"green"},{key:"heal",piece:150,color:"green"}];return n(1,o=l.discount(e)),e}()),o=r.cache.product,K((function(){s.forEach(((e,t)=>{a(e).color(o[t].color).with({forget:{name:"忘却",detail:"忘却指定的一张牌。"},heal:{name:"休憩",detail:"回复10生命值。"}}[o[t].key]),e.onclick=e=>{var a;"gray"!=(a=o[t]).color&&(l.data.coin>=a.piece?(n(1,o),f(ze,l.data.coin-=a.piece,l),"red"==a.color?(l.event.forgetCard(),msg({content:"忘却一张牌"})):(l.event.heal(10),msg({content:"回复10生命值"})),a.color="gray"):msg({content:"硬币不足"}))}}))})),e.$$set=e=>{"info"in e&&n(0,r=e.info)},[r,o,s,function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(2,s)}))}]}function Cn(e,t,n){const l=e.slice();return l[8]=t[n],l[9]=t,l[10]=n,l}function An(e,t){let n,l,a,o,r=t[10];l=new at({props:{key:t[8].key,cover:t[8].sold&&{name:"空",detail:"已学习"}}});const s=()=>t[4](n,r),i=()=>t[4](null,r);return{key:e,first:null,c(){n=j("div"),ge(l.$$.fragment),a=T(),A(n,"class","product svelte-cpvc4w"),this.first=n},m(e,t){x(e,n,t),ye(l,n,null),b(n,a),s(),o=!0},p(e,n){t=e;const a={};2&n&&(a.key=t[8].key),2&n&&(a.cover=t[8].sold&&{name:"空",detail:"已学习"}),l.$set(a),r!==t[10]&&(i(),r=t[10],s())},i(e){o||(ie(l.$$.fragment,e),o=!0)},o(e){ce(l.$$.fragment,e),o=!1},d(e){e&&w(n),ve(l),i()}}}function En(e){let t,n,l,a,o,r,s,i,c,d,u,f=e[0].detail+"",m=[],h=new Map,p=e[1];const g=e=>e[10];for(let t=0;t<p.length;t+=1){let n=Cn(e,p,t),l=g(n);h.set(l,m[t]=An(l,n))}return{c(){t=j("div"),n=j("txt"),l=O(f),a=T(),o=j("txt"),r=O("大概还能学习 "),s=O(e[2]),i=O(" 种符卡。"),c=T(),d=j("div");for(let e=0;e<m.length;e+=1)m[e].c();A(n,"class","svelte-cpvc4w"),A(o,"class","svelte-cpvc4w"),A(d,"class","products svelte-cpvc4w"),A(t,"class","content svelte-cpvc4w")},m(e,f){x(e,t,f),b(t,n),b(n,l),b(t,a),b(t,o),b(o,r),b(o,s),b(o,i),b(t,c),b(t,d);for(let e=0;e<m.length;e+=1)m[e]&&m[e].m(d,null);u=!0},p(e,[t]){(!u||1&t)&&f!==(f=e[0].detail+"")&&E(l,f),(!u||4&t)&&E(s,e[2]),10&t&&(p=e[1],re(),m=pe(m,t,g,1,e,p,h,d,he,An,null,Cn),se())},i(e){if(!u){for(let e=0;e<p.length;e+=1)ie(m[e]);u=!0}},o(e){for(let e=0;e<m.length;e+=1)ce(m[e]);u=!1},d(e){e&&w(t);for(let e=0;e<m.length;e+=1)m[e].d()}}}function Hn(e,t,n){let l;d(e,ze,(e=>n(5,l=e)));let a,{info:o}=t,r=2;const s=[];return o.cache.product?a=o.cache.product:o.cache.product=function(){let e=Object.keys(Qe).filter((e=>Qe[e].role==l.data.role)).rd().splice(0,l.data.sugar+3).map((e=>({key:e,sold:!1})));return n(1,a=l.discount(e)),e}(),"number"==typeof o.cache.count&&(r=o.cache.count),K((function(){s.forEach(((e,t)=>{e.onclick=e=>{var s;(s=a[t]).sold||(0!=r?(n(1,a),s.key.increaseOf(l.data.card),msg({content:`已学习[${Qe[s.key].name}]`}),s.sold=!0,n(2,r--,r),n(0,o.cache.count=r,o)):msg({content:"时间精力不足！"}))}}))})),e.$$set=e=>{"info"in e&&n(0,o=e.info)},[o,a,r,s,function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(3,s)}))}]}function qn(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="打开",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function Ln(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{let t=Math.random();l.event.getCollection(t>.75?"green":"blue"),l.event.finish(),window.msg({content:"获得收藏品"})}]}function zn(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="打开",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function Sn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{Math.random()>.6?(l.event.getSpellcard(),window.msg({content:"获得符卡"})):(l.event.getBasecard(),window.msg({content:"获得通式"})),l.event.finish()}]}function In(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),o=O(M),r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="祈求进取",h=T(),p=j("br"),g=T(),y=j("br"),v=T(),k=j("txt"),k.textContent="祈求祝福",A(l,"class","svelte-6iu958"),A(m,"class","selection svelte-6iu958"),A(k,"class","selection svelte-6iu958"),A(n,"class","content svelte-6iu958")},m(e,a){x(e,n,a),b(n,l),b(l,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),_||($=[C(m,"click",t[2]),C(k,"click",t[3])],_=!0)},p(e,[t]){1&t&&M!==(M=e[0].detail+"")&&E(o,M)},i:e,o:e,d(e){e&&w(n),_=!1,a($)}}}function Rn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.getSpellcard(!0),l.event.finish()},e=>{l.event.getCollection("green",!0),l.event.finish()}]}function Bn(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="数一数",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function Pn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{let t=120-40*Math.random();l.event.getCoin(window.retain(t,0)),l.event.finish()}]}function Nn(e,t,n){const l=e.slice();return l[8]=t[n],l[9]=t,l[10]=n,l}function Kn(e,t){let n,l,a,o,r,s,i,c,d,u,f,m,h=("blue"==t[8]?5:3)+"",p=t[10];const g=()=>t[3](n,p),y=()=>t[3](null,p);return{key:e,first:null,c(){n=j("div"),l=j("div"),a=j("icon"),r=j("txt"),r.textContent="×",s=T(),i=j("div"),c=j("icon"),u=j("txt"),f=O(h),m=T(),A(a,"class",o="icon-"+t[1][t[8]][0]+" svelte-1w7kwin"),A(r,"class","svelte-1w7kwin"),A(l,"class","svelte-1w7kwin"),A(c,"class",d="icon-"+t[1][t[8]][1]+" svelte-1w7kwin"),A(u,"class","svelte-1w7kwin"),A(i,"class","svelte-1w7kwin"),A(n,"class","product svelte-1w7kwin"),H(n,"background-color","var(--"+(t[0].cache.gray[t[10]]?"gray":t[8])+")"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,a),b(l,r),b(n,s),b(n,i),b(i,c),b(i,u),b(u,f),b(n,m),g()},p(e,l){t=e,2&l&&o!==(o="icon-"+t[1][t[8]][0]+" svelte-1w7kwin")&&A(a,"class",o),2&l&&d!==(d="icon-"+t[1][t[8]][1]+" svelte-1w7kwin")&&A(c,"class",d),1&l&&H(n,"background-color","var(--"+(t[0].cache.gray[t[10]]?"gray":t[8])+")"),p!==t[10]&&(y(),p=t[10],g())},d(e){e&&w(n),y()}}}function Dn(t){let n,l,a,o,r,s=t[0].detail+"",i=[],c=new Map,d=["blue","green"];const u=e=>e[10];for(let e=0;e<2;e+=1){let n=Nn(t,d,e),l=u(n);c.set(l,i[e]=Kn(l,n))}return{c(){n=j("div"),l=j("txt"),a=O(s),o=T(),r=j("div");for(let e=0;e<2;e+=1)i[e].c();A(l,"class","svelte-1w7kwin"),A(r,"class","products svelte-1w7kwin"),A(n,"class","content svelte-1w7kwin")},m(e,t){x(e,n,t),b(n,l),b(l,a),b(n,o),b(n,r);for(let e=0;e<2;e+=1)i[e]&&i[e].m(r,null)},p(e,[t]){1&t&&s!==(s=e[0].detail+"")&&E(a,s),7&t&&(d=["blue","green"],i=pe(i,t,u,1,e,d,c,r,me,Kn,null,Nn))},i:e,o:e,d(e){e&&w(n);for(let e=0;e<2;e+=1)i[e].d()}}}function Fn(e,t,n){let l,a;d(e,ze,(e=>n(4,l=e))),d(e,Me,(e=>n(5,a=e)));let o,{info:r}=t;const s=[];function i(e){let t=["blue","green"][e];if(!r.cache.gray[e]){n(1,o);let a="blue"==t?5:3;o[t][1].increaseOf(l.data.collection),f(ze,l.data.collection[o[t][1]]+=a-1,l),delete l.data.collection[o[t][0]],l.data.blackList.push(o[t][0]),msg({content:`获得[${Ne[o[t][1]].name}]*${a}`}),n(0,r.cache.gray[e]=!0,r)}}return r.cache.product?o=r.cache.product:r.cache.product=function(){let e={};return["blue","green"].forEach((t=>e[t]=Object.keys(Ne).filter((e=>Ne[e].type==t)).rd().splice(0,2))),n(1,o=e),e}(),r.cache.gray||(r.cache.gray=[!1,!1]),K((function(){s.forEach(((e,t)=>{let n=["blue","green"][t],l={name:"接受",detail:`将[${Ne[o[n][0]].name}]移出游戏，获得[${Ne[o[n][1]].name}]*${"blue"==n?5:3}。\n\n        [${Ne[o[n][0]].name}]: ${Ne[o[n][0]].detail}\n\n        [${Ne[o[n][1]].name}]: ${Ne[o[n][1]].detail}`};a(e).color(n).with(l),e.onclick=e=>i(t)}))})),e.$$set=e=>{"info"in e&&n(0,r=e.info)},[r,o,s,function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(2,s)}))}]}function Yn(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p;return{c(){n=j("div"),l=j("txt"),l.textContent="双倍的精英敌人，双倍的高级奖励。",a=T(),o=j("txt"),o.textContent="双倍的最终BOSS，双倍的最终奖励。",r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="叉腰大笑",A(l,"class","svelte-1ogutcc"),A(o,"class","svelte-1ogutcc"),A(m,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,g){x(e,n,g),b(n,l),b(n,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),h||(p=C(m,"click",t[3]),h=!0)},p:e,i:e,o:e,d(e){e&&w(n),h=!1,p()}}}function Xn(e,t,n){let l,a;d(e,He,(e=>n(0,l=e))),d(e,ze,(e=>n(1,a=e)));let{info:o}=t;return e.$$set=e=>{"info"in e&&n(2,o=e.info)},[l,a,o,e=>{f(He,l.dragon++,l),window.msg({content:"获得了龙神的注视"}),a.event.finish()}]}function Gn(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),o=O(M),r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="献血(生命-25%)",h=T(),p=j("br"),g=T(),y=j("br"),v=T(),k=j("txt"),k.textContent="下次一定",A(l,"class","svelte-1ogutcc"),A(m,"class","selection svelte-1ogutcc"),A(k,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,a){x(e,n,a),b(n,l),b(l,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),_||($=[C(m,"click",t[2]),C(k,"click",t[3])],_=!0)},p(e,[t]){1&t&&M!==(M=e[0].detail+"")&&E(o,M)},i:e,o:e,d(e){e&&w(n),_=!1,a($)}}}function Jn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{if(l.event.loseHealth(25,!0)){let e=Math.random();l.event.getCollection(e>.75?"red":"green"),l.event.finish(),window.msg({content:"感谢您对爱心事业的贡献"})}else window.msg({content:"亲，攒点血再来献吧！"})},e=>{l.event.finish()}]}function Wn(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),o=O(M),r=T(),s=j("br"),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("txt"),m.textContent="复制一张牌",h=T(),p=j("br"),g=T(),y=j("br"),v=T(),k=j("txt"),k.textContent="复制一个收藏品",A(l,"class","svelte-1ogutcc"),A(m,"class","selection svelte-1ogutcc"),A(k,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,a){x(e,n,a),b(n,l),b(l,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),_||($=[C(m,"click",t[2]),C(k,"click",t[3])],_=!0)},p(e,[t]){1&t&&M!==(M=e[0].detail+"")&&E(o,M)},i:e,o:e,d(e){e&&w(n),_=!1,a($)}}}function Zn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.copy("card"),l.event.finish()},e=>{l.event.copy("collection"),l.event.finish()}]}function Un(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p,g,y,v=25*t[0].cache.count+"";return{c(){n=j("div"),l=j("txt"),l.textContent="一次投币25，25%概率打开宝箱。",a=T(),o=j("txt"),r=O("已投"),s=O(v),i=T(),c=j("br"),d=T(),u=j("br"),f=T(),m=j("br"),h=T(),p=j("txt"),p.textContent="投币",A(l,"class","svelte-1ogutcc"),A(o,"class","svelte-1ogutcc"),A(p,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,v){x(e,n,v),b(n,l),b(n,a),b(n,o),b(o,r),b(o,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),g||(y=C(p,"click",t[2]),g=!0)},p(e,[t]){1&t&&v!==(v=25*e[0].cache.count+"")&&E(s,v)},i:e,o:e,d(e){e&&w(n),g=!1,y()}}}function Qn(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;a.cache.count||(a.cache.count=0);return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{if(l.data.coin>=25){n(0,a.cache.count++,a),f(ze,l.data.coin-=25,l);let e=Math.random(),t=Math.random();e>.75?(window.msg({content:"宝箱打开了"}),t<.5?l.event.getEquipment():t<.7?l.event.getCollection("green"):l.event.getCollection("red"),l.event.finish()):window.msg({content:"没什么动静"})}else window.msg({content:"硬币不足！"})}]}function Vn(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="躺一下",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function el(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{let t=Math.random(),n=window.retain(20-15*t,0);window.msg({content:`回复${n}生命值`}),l.event.heal(n),l.event.finish()}]}function tl(t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M,H,q,L=t[0].cache.count+"";return{c(){n=j("div"),l=j("txt"),l.textContent="将一个东西转化成随机的东西，收藏品有可能会品质浮动，最多跨一级。",o=T(),r=j("txt"),s=O("剩余次数: "),i=O(L),c=T(),d=j("br"),u=T(),f=j("br"),m=T(),h=j("br"),p=T(),g=j("txt"),g.textContent="转化一张卡牌",y=T(),v=j("br"),k=T(),_=j("br"),$=T(),M=j("txt"),M.textContent="转化一个收藏品",A(l,"class","svelte-1ogutcc"),A(r,"class","svelte-1ogutcc"),A(g,"class","selection svelte-1ogutcc"),A(M,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,a){x(e,n,a),b(n,l),b(n,o),b(n,r),b(r,s),b(r,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m),b(n,h),b(n,p),b(n,g),b(n,y),b(n,v),b(n,k),b(n,_),b(n,$),b(n,M),H||(q=[C(g,"click",t[2]),C(M,"click",t[3])],H=!0)},p(e,[t]){1&t&&L!==(L=e[0].cache.count+"")&&E(i,L)},i:e,o:e,d(e){e&&w(n),H=!1,a(q)}}}function nl(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;a.cache.count||(a.cache.count=3);return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{a.cache.count>0&&(l.event.change("card"),1==a.cache.count?l.event.finish():n(0,a.cache.count--,a))},e=>{a.cache.count>0&&(l.event.change("collection"),1==a.cache.count?l.event.finish():n(0,a.cache.count--,a))}]}function ll(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="出售收藏品",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function al(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;a.cache.sold||(a.cache.sold=[]);return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.sellCollection(a.cache.sold)}]}function ol(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="遭遇杂鱼",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function rl(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.summonZagu(),l.event.finish()}]}function sl(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="遭遇强敌",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function il(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.summonElite(),l.event.finish()}]}function cl(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="遭遇BOSS",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function dl(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.summonBoss(),l.event.finish()}]}function ul(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"";return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("br"),s=T(),i=j("br"),c=T(),d=j("br"),u=T(),f=j("txt"),f.textContent="走也",A(l,"class","svelte-1ogutcc"),A(f,"class","selection svelte-1ogutcc"),A(n,"class","content svelte-1ogutcc")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),m||(h=C(f,"click",t[2]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p)},i:e,o:e,d(e){e&&w(n),m=!1,h()}}}function fl(e,t,n){let l;d(e,ze,(e=>n(1,l=e)));let{info:a}=t;return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,l,e=>{l.event.nextStage()}]}function ml(e,t,n){const l=e.slice();return l[6]=t[n],l[8]=n,l}function hl(e,t){let n,l,a,o=t[6].name+"";return{key:e,first:null,c(){n=j("div"),l=j("txt"),a=O(o),A(l,"style","left:"+(150+2.3*t[2][t[8]].x-25)+"px;top:"+(150+2.3*t[2][t[8]].y-16)+"px;"+t[6].style),A(l,"class","svelte-10cnpju"),A(n,"class","reward svelte-10cnpju"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,a)},p(e,n){t=e},d(e){e&&w(n)}}}function pl(t){let n,l,a,o,r,s,i,c,d,u,f,m,h,p=t[0].detail+"",g=[],y=new Map,v=t[0].cache.cost+"",k=t[3];const _=e=>e[8];for(let e=0;e<k.length;e+=1){let n=ml(t,k,e),l=_(n);y.set(l,g[e]=hl(l,n))}return{c(){n=j("div"),l=j("txt"),a=O(p),o=T(),r=j("div");for(let e=0;e<g.length;e+=1)g[e].c();s=T(),i=j("div"),c=j("div"),d=T(),u=j("txt"),f=O(v),A(l,"class","svelte-10cnpju"),A(c,"class","cursor svelte-10cnpju"),H(c,"transform","rotate("+t[1]+"deg)"),A(u,"class","go svelte-10cnpju"),A(i,"class","btn svelte-10cnpju"),A(r,"class","turntable svelte-10cnpju"),A(n,"class","content svelte-10cnpju")},m(e,p){x(e,n,p),b(n,l),b(l,a),b(n,o),b(n,r);for(let e=0;e<g.length;e+=1)g[e]&&g[e].m(r,null);b(r,s),b(r,i),b(i,c),b(i,d),b(i,u),b(u,f),m||(h=C(i,"click",t[4]),m=!0)},p(e,[t]){1&t&&p!==(p=e[0].detail+"")&&E(a,p),12&t&&(k=e[3],g=pe(g,t,_,1,e,k,y,r,me,hl,s,ml)),2&t&&H(c,"transform","rotate("+e[1]+"deg)"),1&t&&v!==(v=e[0].cache.cost+"")&&E(f,v)},i:e,o:e,d(e){e&&w(n);for(let e=0;e<g.length;e+=1)g[e].d();m=!1,h()}}}function gl(e,t,n){let l;d(e,ze,(e=>n(5,l=e)));let{info:a}=t;a.cache.cost||(a.cache.cost=100);let o=0;const r=[{name:"谢谢惠顾",handle:_void,style:"width: 120px;"},{name:"谢谢惠顾",handle:_void,style:"transform: rotate(-45deg);width: 120px;"},{name:"蓝色收藏品",handle:e=>l.event.getCollection("blue"),style:"writing-mode: vertical-lr;"},{name:"获得符卡",handle:l.event.getSpellcard,style:"transform: rotate(45deg);width: 120px;"},{name:"获得装备",handle:l.event.getEquipment,style:"width: 120px;"},{name:"蓝色收藏品",handle:e=>l.event.getCollection("blue"),style:"transform: rotate(-45deg);width: 120px;"},{name:"绿色收藏品",handle:e=>l.event.getCollection("green"),style:"writing-mode: vertical-lr;"},{name:"谢谢惠顾",handle:_void,style:"transform: rotate(45deg);width: 120px;"}];return e.$$set=e=>{"info"in e&&n(0,a=e.info)},[a,o,[{x:50,y:0},{x:35.4,y:-35.4},{x:0,y:-50},{x:-35.4,y:-35.4},{x:-50,y:0},{x:-35.4,y:35.4},{x:0,y:50},{x:35.4,y:35.4}],r,function(){if(l.data.coin>=a.cache.cost){f(ze,l.data.coin-=a.cache.cost,l),n(0,a.cache.cost=retain(1.4*a.cache.cost,0),a),n(1,o+=720+45*Math.floor(8*Math.random())),setTimeout(r[7-(o-180)%360/45].handle,1600)}else msg({content:"硬币不足"})}]}const yl={bottle:class extends _e{constructor(e){super(),ke(this,e,hn,mn,s,{info:0})}},itemshop:class extends _e{constructor(e){super(),ke(this,e,vn,yn,s,{info:0})}},bookshop:class extends _e{constructor(e){super(),ke(this,e,xn,_n,s,{info:0})}},yakumo:class extends _e{constructor(e){super(),ke(this,e,$n,wn,s,{info:0})}},canteen:class extends _e{constructor(e){super(),ke(this,e,Mn,Tn,s,{info:0})}},school:class extends _e{constructor(e){super(),ke(this,e,Hn,En,s,{info:0})}},chest:class extends _e{constructor(e){super(),ke(this,e,Ln,qn,s,{info:0})}},muxiazi:class extends _e{constructor(e){super(),ke(this,e,Sn,zn,s,{info:0})}},zixuan:class extends _e{constructor(e){super(),ke(this,e,Rn,In,s,{info:0})}},coin:class extends _e{constructor(e){super(),ke(this,e,Pn,Bn,s,{info:0})}},delete_and_many:class extends _e{constructor(e){super(),ke(this,e,Fn,Dn,s,{info:0})}},dragon:class extends _e{constructor(e){super(),ke(this,e,Xn,Yn,s,{info:2})}},donate_blood:class extends _e{constructor(e){super(),ke(this,e,Jn,Gn,s,{info:0})}},copy:class extends _e{constructor(e){super(),ke(this,e,Zn,Wn,s,{info:0})}},big_chest:class extends _e{constructor(e){super(),ke(this,e,Qn,Un,s,{info:0})}},diaochuang:class extends _e{constructor(e){super(),ke(this,e,el,Vn,s,{info:0})}},change:class extends _e{constructor(e){super(),ke(this,e,nl,tl,s,{info:0})}},shoucangjia:class extends _e{constructor(e){super(),ke(this,e,al,ll,s,{info:0})}},zagu:class extends _e{constructor(e){super(),ke(this,e,rl,ol,s,{info:0})}},elite:class extends _e{constructor(e){super(),ke(this,e,il,sl,s,{info:0})}},boss:class extends _e{constructor(e){super(),ke(this,e,dl,cl,s,{info:0})}},xijian:class extends _e{constructor(e){super(),ke(this,e,fl,ul,s,{info:0})}},turntable:class extends _e{constructor(e){super(),ke(this,e,gl,pl,s,{info:0})}}};function vl(e,t,n){const l=e.slice();return l[31]=t[n],l[32]=t,l[33]=n,l}function bl(e,t,n){const l=e.slice();return l[31]=t[n],l[33]=n,l}function kl(e,t,n){const l=e.slice();return l[35]=t[n],l[33]=n,l}function _l(e,t,n){const l=e.slice();return l[31]=t[n],l[38]=n,l}function xl(e){let t,n,l,a,o,r;function s(...t){return e[14](e[33],...t)}return{c(){t=j("div"),n=j("div"),n.textContent="x",l=T(),a=j("div"),A(n,"class","svelte-b1jre1"),A(a,"class","range svelte-b1jre1"),A(t,"class","event-close svelte-b1jre1")},m(e,i){x(e,t,i),b(t,n),b(t,l),b(t,a),o||(r=C(a,"click",s),o=!0)},p(t,n){e=t},d(e){e&&w(t),o=!1,r()}}}function wl(e,t){let n,l,o,r,s,i,c,d,u,f,m,h,p,g,y=t[9](t[31].key).name+"",v=t[9](t[31].key).detail+"";function k(...e){return t[12](t[38],t[33],t[31],...e)}function _(...e){return t[13](t[38],t[33],t[31],...e)}let $=!fn[t[31].key].unbreakable&&xl(t);return{key:e,first:null,c(){n=j("div"),l=j("div"),o=j("txt"),r=O(y),s=T(),i=j("txt"),c=O(v),d=T(),$&&$.c(),A(o,"class","title svelte-b1jre1"),A(i,"class","detail svelte-b1jre1"),A(l,"class","event-body svelte-b1jre1"),A(l,"style",u="--color:var(--"+fn[t[31].key].type+");"+t[31].style),A(n,"class",f="event "+(t[38]==t[5].cursor[t[33]]&&"cursor")+" "+(t[38]+t[5].offsetY[t[33]]>0&&t[38]+t[5].offsetY[t[33]]<4&&"show")+" svelte-b1jre1"),A(n,"style",m=(t[0]&&"transition: 0.3s")+";"),A(n,"index",h=t[38]),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,o),b(o,r),b(l,s),b(l,i),b(i,c),b(l,d),$&&$.m(l,null),p||(g=[C(o,"click",k),C(i,"click",_)],p=!0)},p(e,a){t=e,32&a[0]&&y!==(y=t[9](t[31].key).name+"")&&E(r,y),32&a[0]&&v!==(v=t[9](t[31].key).detail+"")&&E(c,v),fn[t[31].key].unbreakable?$&&($.d(1),$=null):$?$.p(t,a):($=xl(t),$.c(),$.m(l,null)),32&a[0]&&u!==(u="--color:var(--"+fn[t[31].key].type+");"+t[31].style)&&A(l,"style",u),32&a[0]&&f!==(f="event "+(t[38]==t[5].cursor[t[33]]&&"cursor")+" "+(t[38]+t[5].offsetY[t[33]]>0&&t[38]+t[5].offsetY[t[33]]<4&&"show")+" svelte-b1jre1")&&A(n,"class",f),1&a[0]&&m!==(m=(t[0]&&"transition: 0.3s")+";")&&A(n,"style",m),32&a[0]&&h!==(h=t[38])&&A(n,"index",h)},d(e){e&&w(n),$&&$.d(),p=!1,a(g)}}}function $l(e,t){let n,l,a,o=[],r=new Map,s=t[5].eventList[t[33]];const i=e=>e[38];for(let e=0;e<s.length;e+=1){let n=_l(t,s,e),l=i(n);r.set(l,o[e]=wl(l,n))}return{key:e,first:null,c(){n=j("div");for(let e=0;e<o.length;e+=1)o[e].c();l=T(),A(n,"class","list-"+t[35]+" svelte-b1jre1"),A(n,"style",a="bottom:"+210*(t[5].offsetY[t[33]]-1)+"px;"+(t[0]&&"transition: 0.4s")+";"),this.first=n},m(e,t){x(e,n,t);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(n,null);b(n,l)},p(e,c){t=e,1697&c[0]&&(s=t[5].eventList[t[33]],o=pe(o,c,i,1,t,s,r,n,me,wl,l,_l)),33&c[0]&&a!==(a="bottom:"+210*(t[5].offsetY[t[33]]-1)+"px;"+(t[0]&&"transition: 0.4s")+";")&&A(n,"style",a)},d(e){e&&w(n);for(let e=0;e<o.length;e+=1)o[e].d()}}}function jl(e){let t,n,l,a,o,r,s,i,c=e[5].target[e[33]]?"☑":"☐",d=e[5].lv+"",u=Wt[e[31]].name+"";function f(...t){return e[15](e[33],...t)}return{c(){t=j("txt"),n=O(c),l=O(" lv."),a=O(d),o=T(),r=O(u),A(t,"class","enermy svelte-b1jre1")},m(e,c){x(e,t,c),b(t,n),b(t,l),b(t,a),b(t,o),b(t,r),s||(i=C(t,"click",f),s=!0)},p(t,l){e=t,32&l[0]&&c!==(c=e[5].target[e[33]]?"☑":"☐")&&E(n,c),32&l[0]&&d!==(d=e[5].lv+"")&&E(a,d),32&l[0]&&u!==(u=Wt[e[31]].name+"")&&E(r,u)},d(e){e&&w(t),s=!1,i()}}}function Ol(e,t){let n,l,a=t[33]<11&&jl(t);return{key:e,first:null,c(){n=M(),a&&a.c(),l=M(),this.first=n},m(e,t){x(e,n,t),a&&a.m(e,t),x(e,l,t)},p(e,n){(t=e)[33]<11?a?a.p(t,n):(a=jl(t),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},d(e){e&&w(n),a&&a.d(e),e&&w(l)}}}function Tl(e,t){let n,l,a=t[31];const o=()=>t[17](n,a),r=()=>t[17](null,a);return{key:e,first:null,c(){n=j("img"),A(n,"class","scene_enermy svelte-b1jre1"),c(n.src,l="/img/enermy/"+ln.enermy[t[31]].type+"/"+t[31]+"/portrait.webp")||A(n,"src",l),H(n,"top",240-340*window.r()+"px"),this.first=n},m(e,t){x(e,n,t),o()},p(e,s){t=e,32&s[0]&&!c(n.src,l="/img/enermy/"+ln.enermy[t[31]].type+"/"+t[31]+"/portrait.webp")&&A(n,"src",l),a!==t[31]&&(r(),a=t[31],o())},d(e){e&&w(n),r()}}}function Ml(e){let t,n,l,a,o,r,s=fn[e[5].event[e[2]].key].name+"";var i=yl[e[5].event[e[2]].key];function c(e){return{props:{info:e[5].event[e[2]]}}}return i&&(a=q(i,c(e))),{c(){t=j("div"),n=O(s),l=T(),a&&ge(a.$$.fragment),o=M(),A(t,"class","title svelte-b1jre1")},m(e,s){x(e,t,s),b(t,n),x(e,l,s),a&&ye(a,e,s),x(e,o,s),r=!0},p(e,t){(!r||36&t[0])&&s!==(s=fn[e[5].event[e[2]].key].name+"")&&E(n,s);const l={};if(36&t[0]&&(l.info=e[5].event[e[2]]),36&t[0]&&i!==(i=yl[e[5].event[e[2]].key])){if(a){re();const e=a;ce(e.$$.fragment,1,0,(()=>{ve(e,1)})),se()}i?(a=q(i,c(e)),ge(a.$$.fragment),ie(a.$$.fragment,1),ye(a,o.parentNode,o)):a=null}else i&&a.$set(l)},i(e){r||(a&&ie(a.$$.fragment,e),r=!0)},o(e){a&&ce(a.$$.fragment,e),r=!1},d(e){e&&w(t),e&&w(l),e&&w(o),a&&ve(a,e)}}}function Cl(e){let t,n,l,o,r,s,i,d,u,f,m,h,p,g,y,v,k,_,$,M,q,L,z,S,I,R,B,P,N,K,D,F,Y=[],X=new Map,G=e[5].enermy.length+"",J=[],W=new Map,U=[],Q=new Map,V=["l","m","r"];const ee=e=>e[33];for(let t=0;t<3;t+=1){let n=kl(e,V,t),l=ee(n);X.set(l,Y[t]=$l(l,n))}let te=e[5].enermy;const ne=e=>e[33];for(let t=0;t<te.length;t+=1){let n=bl(e,te,t),l=ne(n);W.set(l,J[t]=Ol(l,n))}let le=Object.keys(e[5].enermy.count()).reverse();const ae=e=>e[33];for(let t=0;t<le.length;t+=1){let n=vl(e,le,t),l=ae(n);Q.set(l,U[t]=Tl(l,n))}let oe="number"==typeof e[2]&&e[5].event[e[2]]&&Ml(e);return{c(){t=j("div"),n=j("div");for(let e=0;e<3;e+=1)Y[e].c();l=T(),o=j("div"),r=j("div"),s=j("div"),i=j("txt"),d=O("遇敌("),u=O(G),f=O(")"),m=T(),h=j("txt"),h.textContent="开战！",p=T();for(let e=0;e<J.length;e+=1)J[e].c();g=T(),y=j("div"),v=j("div"),k=T(),_=j("div"),$=j("img"),q=T();for(let e=0;e<U.length;e+=1)U[e].c();L=T(),z=j("div"),S=T(),I=j("div"),R=j("div"),R.textContent="×",B=T(),oe&&oe.c(),A(n,"class","event-list svelte-b1jre1"),A(h,"class","battle svelte-b1jre1"),A(s,"class","title svelte-b1jre1"),A(r,"class","notebook svelte-b1jre1"),A(v,"class","speaker svelte-b1jre1"),A($,"class","scene_bg svelte-b1jre1"),c($.src,M="/img/scene/"+e[6].data.scene+".webp")||A($,"src",M),A(_,"class","screen svelte-b1jre1"),A(y,"class","nexus svelte-b1jre1"),A(o,"class","right svelte-b1jre1"),A(z,"class","paper_close svelte-b1jre1"),H(z,"z-index","number"==typeof e[2]?1:-1),A(R,"class","event_fold svelte-b1jre1"),A(I,"class","paper svelte-b1jre1"),A(t,"class","body svelte-b1jre1"),H(t,"--bg","url(/img/scene/r"+[...Array(9).keys()].rd()[0]+".jpg)")},m(a,c){x(a,t,c),b(t,n);for(let e=0;e<3;e+=1)Y[e]&&Y[e].m(n,null);b(t,l),b(t,o),b(o,r),b(r,s),b(s,i),b(i,d),b(i,u),b(i,f),b(s,m),b(s,h),b(r,p);for(let e=0;e<J.length;e+=1)J[e]&&J[e].m(r,null);b(o,g),b(o,y),b(y,v),b(y,k),b(y,_),b(_,$),e[16]($),b(_,q);for(let e=0;e<U.length;e+=1)U[e]&&U[e].m(_,null);b(t,L),b(t,z),b(t,S),b(t,I),b(I,R),b(I,B),oe&&oe.m(I,null),e[18](I),K=!0,D||(F=[C(h,"click",e[11]),C(z,"click",e[8]),C(R,"click",e[8])],D=!0)},p(e,t){1697&t[0]&&(V=["l","m","r"],Y=pe(Y,t,ee,1,e,V,X,n,me,$l,null,kl)),(!K||32&t[0])&&G!==(G=e[5].enermy.length+"")&&E(u,G),32&t[0]&&(te=e[5].enermy,J=pe(J,t,ne,1,e,te,W,r,me,Ol,null,bl)),(!K||64&t[0]&&!c($.src,M="/img/scene/"+e[6].data.scene+".webp"))&&A($,"src",M),48&t[0]&&(le=Object.keys(e[5].enermy.count()).reverse(),U=pe(U,t,ae,1,e,le,Q,_,me,Tl,null,vl)),(!K||4&t[0])&&H(z,"z-index","number"==typeof e[2]?1:-1),"number"==typeof e[2]&&e[5].event[e[2]]?oe?(oe.p(e,t),36&t[0]&&ie(oe,1)):(oe=Ml(e),oe.c(),ie(oe,1),oe.m(I,null)):oe&&(re(),ce(oe,1,1,(()=>{oe=null})),se())},i(e){K||(ie(oe),Z((()=>{K&&(N&&N.end(1),P=ue(t,we,{duration:250}),P.start())})),K=!0)},o(e){ce(oe),P&&P.invalidate(),N=fe(t,we,{duration:250}),K=!1},d(n){n&&w(t);for(let e=0;e<3;e+=1)Y[e].d();for(let e=0;e<J.length;e+=1)J[e].d();e[16](null);for(let e=0;e<U.length;e+=1)U[e].d();oe&&oe.d(),e[18](null),n&&N&&N.end(),D=!1,a(F)}}}function Al(){const e=Math.random;let t=12*e()-6;return t=(Math.abs(t)+3)*(t/Math.abs(t)),`transform:rotate(${t}deg)translate(${20*e()-10}px,${20*e()-10}px);`}function El(e,t,n){let l,a,o,r,s;d(e,He,(e=>n(5,l=e))),d(e,Te,(e=>n(19,a=e))),d(e,ze,(e=>n(6,o=e))),d(e,Ae,(e=>n(20,r=e))),d(e,Me,(e=>n(21,s=e))),f(ze,o.data=r,o),l.eventSummoned||p();let i,c,u,m=!0;const h={};function p(){f(He,l.enermy=[],l),f(He,l.offsetY=[0,0,0],l),f(He,l.cursor=[1,1,1],l),f(He,l.dragon=0,l),f(He,l.target=[...Array(11).keys()].map((e=>!1)),l),f(He,l.event=function(){const e=[{random:{reward:3,selection:5,special:3,shop:2},static:{zagu:6,elite:3,itemshop:1,school:1,canteen:1,chest:5,muxiazi:4,bookshop:1,dragon:1,zixuan:1,diaochuang:1,big_chest:1,turntable:1}},{random:{reward:5,selection:4,special:3,shop:2},static:{zagu:6,elite:4,itemshop:1,school:1,canteen:1,chest:4,muxiazi:3,bookshop:1,dragon:1,zixuan:1,diaochuang:1,yakumo:1,turntable:1}},{random:{reward:4,selection:4,special:4,shop:2},static:{zagu:4,elite:4,itemshop:1,school:1,canteen:1,chest:3,muxiazi:3,bookshop:1,dragon:1,zixuan:1,diaochuang:1,turntable:1}}];let t=[],n=o.data.stage-1,l=Object.keys(fn).map((e=>({key:e,type:fn[e].type})));for(let a in e[n].random){let o=l.filter((e=>e.type==a)).rd();o.splice(0,e[n].random[a]).map((e=>t.push(e.key)))}for(let l in e[n].static)[...Array(e[n].static[l]).keys()].forEach((e=>t.push(l)));return t.rd(),t.splice(1,0,"zixuan"),t}().map(((e,t)=>({key:e,cache:{},id:t,style:Al(),detail:fn[e].detail,type:fn[e].type}))),l),f(He,l.eventLeft=deepCopy(l.event),l),f(He,l.eventList=[0,1,2].map((e=>l.eventLeft.splice(0,5))),l)}function g(e){l.event[e].cache.finish?msg({content:"事件已完成"}):(o.mobile?n(1,i.style.top="60px",i):n(1,i.style.top=document.body.clientHeight-640+"px",i),n(2,c=e))}function y(){n(1,i.style.top=`${document.body.clientHeight}px`,i),n(2,c=!1)}function v(e){f(He,l.event[l.eventList[e][l.cursor[e]].id].closed=!0,l);let t=l.event.length-l.event.filter((e=>e.closed)).length;9!=t||l.event.map((e=>e.key)).includes("boss")||b("boss"),l.enermy.length>0&&f(He,l.lv++,l);let a=[0,1,2].filter((t=>t!=e));f(He,l.offsetY[e]-=1,l),a.forEach((e=>{0==l.eventLeft.length&&1==l.cursor[e]||1==l.cursor[e]&&f(He,l.offsetY[e]+=1,l)})),setTimeout((t=>{n(0,m=!1),l.eventLeft.length>0?l.eventList[e].push(l.eventLeft.rd().shift()):(0!=l.cursor[a[1]]&&(l.eventList[e].push(l.eventList[a[1]].shift()),f(He,l.cursor[a[1]]=0,l),f(He,l.offsetY[a[1]]+=1,l)),0!=l.cursor[a[0]]&&(l.eventList[e].push(l.eventList[a[0]].shift()),f(He,l.cursor[a[0]]=0,l),f(He,l.offsetY[a[0]]+=1,l))),l.eventList[e].splice(l.cursor[e],1),He.set(l),a.forEach((e=>{l.eventLeft.length>0?(f(He,l.eventList[e]=[l.eventLeft.rd().shift(),...l.eventList[e]],l),f(He,l.offsetY[e]-=1,l)):f(He,l.cursor[e]=0,l)})),f(He,l.offsetY[e]+=1,l),setTimeout((e=>{n(0,m=!0)}),100)}),400)}function b(e){let t={key:e,cache:{},id:l.event.length,style:Al(),detail:fn[e].detail,type:fn[e].type},n=Math.max(...l.eventList.map((e=>e.length))),a=l.eventList.map(((e,t)=>t)).filter((e=>l.eventList[e].length==n))[0];l.eventList[a].push(t),l.event.push(t)}f(ze,o.event.summonZagu=function(){let e=[];[...Array(Xe.amount(l.lv)).keys()].forEach((t=>e.push(Object.keys(Wt).filter((e=>"normal"==Wt[e].type&&Wt[e].scene.includes(o.data.scene))).rd()[0]))),f(He,l.enermy=[...l.enermy,...e],l)},o),f(ze,o.event.summonElite=function(){let e=[];[...Array(l.dragon+1).keys()].forEach((t=>e.push(Object.keys(Wt).filter((e=>"elite"==Wt[e].type&&Wt[e].scene.includes(o.data.scene))).rd()[0]))),f(He,l.enermy=[...l.enermy,...e],l)},o),f(ze,o.event.summonBoss=function(){let e=[];[...Array(l.dragon+1).keys()].forEach((t=>e.push(l.boss[r.stage-1]))),f(He,l.enermy=[...l.enermy,...e],l)},o),f(ze,o.event.finish=function(){let e;f(He,l.event[c].cache.finish=!0,l),l.eventList.forEach(((t,n)=>{t.forEach((t=>{t.id==c&&(e=n)}))})),l.event[c]&&"enermy"==l.event[c].type&&v(e);y()},o),f(ze,o.event.stageClear=e=>b("xijian"),o),f(ze,o.event.nextStage=function(){let e=["shrine","forest","town"];y(),o.data.stage<3?(f(ze,o.data.scene=e[o.data.stage],o),f(ze,o.data.stage++,o),p(),msg({content:`到达${ln.scene[o.data.scene].name}`})):f(Te,a="Epilog",a)},o),f(ze,o.discount=function(e){let t=1;if("carnyx"in o.data.collection){let e=o.data.collection.carnyx;t*=Math.pow(.95,e)}"marisa"==o.data.role&&(t*=.9);return e.forEach((e=>e.piece=retain(t*e.piece,0))),e},o),K((function(){n(1,i.style.top=`${document.body.clientHeight}px`,i),n(1,i.style.transition="0.3s",i),l.eventSummoned||(o.event.heal(100,!0),f(He,l.eventSummoned=!0,l))})),N((function(){if("function"==typeof s){s(u).with(ln.scene[o.data.scene]);for(let e in h)s(h[e]).color(ln.enermy[e].color).with({name:ln.enermy[e].name,detail:ln.enermy[e].intro})}}));return[m,i,c,u,h,l,o,g,y,function(e){let t=deepCopy(fn[e]);return"selection"==t.type&&(t.name="未知事件",t.detail="什么都没有，但又隐隐约约感觉到有什么要发生。"),t},v,function(){let e=l.enermy.filter(((e,t)=>l.target[t])).length;e<1?msg({content:"至少选中一个敌人"}):e>l.enermyLimit?msg({content:`最多只能选中${l.enermyLimit}个敌人`}):f(Te,a="Battle",a)},(e,t,n,a)=>e==l.cursor[t]&&g(n.id),(e,t,n,a)=>e==l.cursor[t]&&g(n.id),(e,t)=>v(e),(e,t)=>f(He,l.target[e]=!l.target[e],l),function(e){Y[e?"unshift":"push"]((()=>{u=e,n(3,u)}))},function(e,t){Y[e?"unshift":"push"]((()=>{h[t]=e,n(4,h)}))},function(e){Y[e?"unshift":"push"]((()=>{i=e,n(1,i)}))}]}class Hl extends _e{constructor(e){super(),ke(this,e,El,Cl,s,{},null,[-1,-1])}}function ql(e,t,n){const l=e.slice();return l[39]=t[n],l}function Ll(e,t,n){const l=e.slice();return l[39]=t[n],l[43]=n,l}function zl(e,t){let n,l,a;function o(...e){return t[16](t[43],t[39],...e)}return l=new at({props:{key:t[11][t[39]],action:t[12],select:o,cost:t[9][t[39]],transform:t[8][t[43]],animate:t[4],interim:t[6][t[39]],abandoned:t[7][t[39]]}}),{key:e,first:null,c(){n=M(),ge(l.$$.fragment),this.first=n},m(e,t){x(e,n,t),ye(l,e,t),a=!0},p(e,n){t=e;const a={};2&n[0]&&(a.key=t[11][t[39]]),2&n[0]&&(a.select=o),514&n[0]&&(a.cost=t[9][t[39]]),258&n[0]&&(a.transform=t[8][t[43]]),16&n[0]&&(a.animate=t[4]),66&n[0]&&(a.interim=t[6][t[39]]),130&n[0]&&(a.abandoned=t[7][t[39]]),l.$set(a)},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l,e)}}}function Sl(e){let t;return{c(){t=j("txt"),t.textContent="空空如也",A(t,"class","svelte-jeafs6")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Il(e,t){let n,l,a;return l=new at({props:{key:t[11][t[39]]}}),{key:e,first:null,c(){n=M(),ge(l.$$.fragment),this.first=n},m(e,t){x(e,n,t),ye(l,e,t),a=!0},p(e,n){t=e;const a={};1&n[0]&&(a.key=t[11][t[39]]),l.$set(a)},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l,e)}}}function Rl(e){let t,n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M,q=[],L=new Map,z=e[0].length+"",S=[],I=new Map,R=e[1];const B=e=>e[43];for(let t=0;t<R.length;t+=1){let n=Ll(e,R,t),l=B(n);L.set(l,q[t]=zl(l,n))}let P=0==e[0].length&&Sl(),N=e[0];const K=e=>e[39];for(let t=0;t<N.length;t+=1){let n=ql(e,N,t),l=K(n);I.set(l,S[t]=Il(l,n))}return{c(){t=j("div");for(let e=0;e<q.length;e+=1)q[e].c();n=T(),l=j("div"),o=T(),r=j("div"),s=T(),i=j("div"),c=j("icon"),u=T(),f=j("txt"),m=O(z),h=T(),p=j("div"),g=j("div"),P&&P.c(),y=T(),v=j("div");for(let e=0;e<S.length;e+=1)S[e].c();A(l,"class","barrier svelte-jeafs6"),H(l,"display",e[5]?"block":"none"),A(r,"class","left-card-close svelte-jeafs6"),H(r,"display",e[2]?"block":"none"),A(c,"class",d="icon-left_card "+(e[10]&&"animate_leftChange")+" svelte-jeafs6"),A(f,"class","svelte-jeafs6"),A(v,"class","svelte-jeafs6"),A(g,"class","list svelte-jeafs6"),A(p,"class","svelte-jeafs6"),A(i,"class",k="left-card "+(e[2]&&"show")+" svelte-jeafs6"),A(t,"class","handcards svelte-jeafs6")},m(a,d){x(a,t,d);for(let e=0;e<q.length;e+=1)q[e]&&q[e].m(t,null);b(t,n),b(t,l),b(t,o),b(t,r),b(t,s),b(t,i),b(i,c),b(i,u),b(i,f),b(f,m),b(i,h),b(i,p),b(p,g),P&&P.m(g,null),b(g,y),b(g,v);for(let e=0;e<S.length;e+=1)S[e]&&S[e].m(v,null);e[18](v),_=!0,$||(M=[C(r,"click",e[17]),C(i,"click",e[19])],$=!0)},p(e,a){15314&a[0]&&(R=e[1],re(),q=pe(q,a,B,1,e,R,L,t,he,zl,n,Ll),se()),(!_||32&a[0])&&H(l,"display",e[5]?"block":"none"),(!_||4&a[0])&&H(r,"display",e[2]?"block":"none"),(!_||1024&a[0]&&d!==(d="icon-left_card "+(e[10]&&"animate_leftChange")+" svelte-jeafs6"))&&A(c,"class",d),(!_||1&a[0])&&z!==(z=e[0].length+"")&&E(m,z),0==e[0].length?P||(P=Sl(),P.c(),P.m(g,y)):P&&(P.d(1),P=null),2049&a[0]&&(N=e[0],re(),S=pe(S,a,K,1,e,N,I,v,he,Il,null,ql),se()),(!_||4&a[0]&&k!==(k="left-card "+(e[2]&&"show")+" svelte-jeafs6"))&&A(i,"class",k)},i(e){if(!_){for(let e=0;e<R.length;e+=1)ie(q[e]);for(let e=0;e<N.length;e+=1)ie(S[e]);_=!0}},o(e){for(let e=0;e<q.length;e+=1)ce(q[e]);for(let e=0;e<S.length;e+=1)ce(S[e]);_=!1},d(n){n&&w(t);for(let e=0;e<q.length;e+=1)q[e].d();P&&P.d();for(let e=0;e<S.length;e+=1)S[e].d();e[18](null),$=!1,a(M)}}}function Bl(e,t,n){let l,a,o,s,i;d(e,ze,(e=>n(21,s=e))),d(e,Ae,(e=>n(22,i=e)));const c=deepCopy(i),u=Object.unCount(c.card),m=Object.assign(deepCopy(Qe),deepCopy(Ve));let h,p=[],g=[];const y={index:u.map((e=>0)),key:{},reset(){this.index=u.map((e=>0)),this.key={}}};let v,b=!1,k=!0,_=!1,x=u.map((e=>m[e].interim)),w=u.map((e=>!1));const $=[];let j={limit:4,drawAmount:2,holdLimit:4,handcards:u},{battle:O}=t;const T={refresh:function(){const e={holdLimit:4+Math.round(s.role.state.of(0).get().speed),drawAmount:Math.max(0,2+E()),drawLimit:p.length,ex:[],handcards:u,hold:g};1==s.role.event.round.count&&e.drawAmount++;et.handcardRefresh(s,e);let t=e.holdLimit-g.length,l=Math.min(t,e.drawAmount,p.length);n(1,g=[...g,...p.splice(0,l),...e.ex]),M()},punch:C,aim:()=>{if(u[h])return"aim"in m[u[h]]},getHolds:e=>g.map((e=>{let t=u[e],n=deepCopy(m[t]);return n.cost=l[e],n.key=t,n.index=e,n})),getLefts:e=>p.map((e=>{let t=u[e],n=deepCopy(m[t]);return n.cost=l[e],n.key=t,n.index=e,n})),getUseds:e=>{let t=[...u.keys()];return t=t.filter((e=>!g.includes(e)||!p.includes(e))),t},getAll:e=>u.map(((e,t)=>{let n=deepCopy(m[e]);return n.cost=l[t],n.key=e,n.index=t,n.interim=x[t],n})),draw:{amount(e){return this.Amount=e,this},type(e){return this.Type=e,this},fromAll(){const e=u.map(((e,t)=>t)).filter((e=>!$.includes(e)&&!g.includes(e)));e.length<=this.Amount&&msg({content:"抽空了"});let t={holdLimit:4+Math.round(s.role.state.of(0).get().speed),amount:this.Amount};et.drawCard(s,t);let l=g.length,a=t.holdLimit-l,o=Math.min(a,t.amount);setTimeout((t=>{e.rd().splice(0,o).forEach((e=>{n(1,g=[...g,e]),p.includes(e)&&n(0,p=p.filter((t=>t!=e)))}))}),600),o>a&&msg({content:"达到手牌上限"})},fromLeft(){Object.keys(m).filter((e=>Object.keys(Ve).includes(e))),Object.keys(m).filter((e=>Object.keys(Qe).includes(e))),this.handle(p)},fromExpend(){this.handle($)},fromUsed(){const e=u.map(((e,t)=>t)).filter((e=>!$.includes(e)&&!g.includes(e)&&!p.includes(e)));this.handle(e)},handle(e){let t=e;this.Type&&(t=e.filter((e=>m[u[e]].type==this.Type))),t.length<=this.Amount&&msg({content:"抽空了"});let l={holdLimit:4+Math.round(s.role.state.of(0).get().speed),amount:this.Amount,drawLimit:t.length};et.drawCard(s,l);let a=g.length,o=t.filter((e=>!g.includes(e))).length,r=l.holdLimit-a,i=Math.min(r,l.amount,o);i>r&&msg({content:"达到手牌上限"}),setTimeout((l=>{if(this.Type){let e=t.rd().splice(0,i);n(1,g=[...g,...e]),n(0,p=p.filter((t=>!e.includes(t))))}else n(1,g=[...g,...e.rd().splice(0,i)]),n(0,p)}),600)}},setCost:{byIndex:(e,t)=>{n(15,y.index[e]=t,y)},byKey:(e,t)=>{n(15,y.key[e]=t,y)}},getCostOffset:()=>y,setInterim:{byIndex:(e,t)=>{n(6,x[e]=t,x)},byKey:(e,t)=>{u.forEach(((l,a)=>{l==e&&n(6,x[a]=t,x)})),n(6,x)}},insert:{amount(e){return this.Amount=e,this},interim(e){return this.Interim=e,this},toAll(e){let t=[];return this.Amount||(this.Amount=1),[...Array(this.Amount).keys()].forEach((l=>{this.Interim?x.push(!0):x.push(m[e].interim),u.push(e),n(15,y.index=[...y.index,0],y),t.push(u.length-1)})),this.Amount=!1,t},toHolds(e){let t=this.toAll(e);setTimeout((e=>{n(1,g=[...g,...t])}),600)},toLeft(e){let t=this.toAll(e);n(0,p=[...p,...t])}},abandon:{amount(e){return this.Amount=e,this},type(e){return this.Type=e,this},fromHolds(){setTimeout((e=>{let t;t="spellcard"==this.Type?g.filter((e=>"spellcard"==m[u[e]].type)):deepCopy(g);let l=t.rd().splice(0,this.Amount);l.forEach((e=>n(7,w[e]=!0,w))),l=l.map((e=>g.indexOf(e))),setTimeout((e=>{n(8,a=H(l)),setTimeout((e=>{n(4,k=!1),n(1,g=g.filter(((e,t)=>!l.includes(t)))),w.set(!1),setTimeout((e=>n(4,k=!0)),50)}),250)}),200)}),600)}},Cost:A};function M(){let e=u.map(((e,t)=>t)).filter((e=>!g.includes(e)&&!$.includes(e))).rd(),t={res:e};return et.handcardLeftReset(s,t),n(0,p=e),e}function C(e){let t,n=m[u[h]];n.key=u[h],n.index=h,t="role"in n?"spellcard":"basecard",c.role==u[h]&&(t="normal_attack");const l={cost:A(),type:t,card:n,target:e,valid:!0};if(O.round.get())if(!1===l.cost)msg({content:"条件不足"});else if(l.cost>s.role.power.of(0).get())msg({content:"灵力不足"});else{s.role.power.of(0).cost(l.cost),et.punchCard(s,l);let t=m[u[h]].handle;l.valid&&t(s,e),f(ze,s.cache.last_card=u[h],s),f(ze,s.cache.last_target=e,s)}else msg({content:"不在你的回合"})}function A(){const e={card:deepCopy(m[u[h]]),cost:l[h],valid:!0};return e.card.key=u[h],et.beforePowerCost(s,e),!!e.valid&&e.cost}function E(){let e=s.enermy.state.getAll().filter((e=>e.Health>0)),t=e.reduce(((e,t)=>e+t.speed),0)/e.length,n=Math.abs(s.role.state.of(0).get().speed-t),l=n-parseInt(n),a=parseInt(n)+Number(r()<l);return s.role.state.of(0).get().speed>t?a:-a}function H(e){e=e||[];let t=g.filter(((t,n)=>!e.includes(n))),n=Math.max(t.length,6)-1,l=t.map(((e,l)=>({x:560*(l-(t.length-1)/2)/n,y:(Math.sqrt(49e4-Math.pow((l-(t.length-1)/2)/n*700,2))-600)/2.5-90,rotate:(l-(t.length-1)/2)*(30/n)})));for(let t of e)"number"==typeof t&&l.splice(t,0,a[t]);return l}function q(e,t){h="number"==typeof e?t:null,n(8,a=H([e]))}f(ze,s.handcard=T,s),K((e=>{setTimeout((e=>{et.handcardOnload(s,j),M()}))})),D((e=>{v&&n(3,v.ontouchstart=function(e){let t=e.touches[0].pageX,l=v.scrollTop;n(3,v.ontouchmove=function(e){let a=e.touches[0].pageX;n(3,v.scrollTop=l+a-t,v)},v)},v)}));return e.$$set=e=>{"battle"in e&&n(14,O=e.battle)},e.$$.update=()=>{32768&e.$$.dirty[0]&&n(9,l=y&&function(){let e=deepCopy(m);for(let t in y.key)e[t].cost+=y.key[t];let t=u.map((t=>e[t].cost));return y.index.forEach(((e,n)=>t[n]+=e)),t=t.map((e=>Math.max(0,e))),n(9,l=t),t}()),2&e.$$.dirty[0]&&n(8,a=g&&H()),1&e.$$.dirty[0]&&n(10,o=p&&(setTimeout((e=>n(10,o=!1)),800),!0))},[p,g,b,v,k,_,x,w,a,l,o,u,function(e){const t=h;C(e),n(5,_=!0),setTimeout((e=>{n(4,k=!1),n(1,g=g.filter((e=>e!=t))),setTimeout((e=>{n(4,k=!0),n(5,_=!1),x[t]&&$.push(t)}),80)}),500)},q,O,y,(e,t,n)=>q(n?e:null,t),e=>n(2,b=!1),function(e){Y[e?"unshift":"push"]((()=>{v=e,n(3,v)}))},e=>n(2,b=!0)]}class Pl extends _e{constructor(e){super(),ke(this,e,Bl,Rl,s,{battle:14},null,[-1,-1])}}function Nl(t){let n,l,a,o,r,s,i,c,d,u,f,m;return{c(){n=j("div"),l=j("div"),a=T(),o=j("div"),r=T(),s=j("div"),i=T(),c=j("div"),d=T(),u=j("div"),f=T(),m=j("div"),A(l,"class","icon-star svelte-1whc4g4"),A(o,"class","icon-star svelte-1whc4g4"),A(s,"class","icon-star svelte-1whc4g4"),A(c,"class","icon-star svelte-1whc4g4"),A(u,"class","icon-star svelte-1whc4g4"),A(m,"class","icon-star svelte-1whc4g4"),A(n,"class","MarisaAttack svelte-1whc4g4"),H(n,"transform","rotate("+t[0]+"deg)"),H(n,"left",t[1]+"px"),H(n,"top",t[2]+"px")},m(e,t){x(e,n,t),b(n,l),b(n,a),b(n,o),b(n,r),b(n,s),b(n,i),b(n,c),b(n,d),b(n,u),b(n,f),b(n,m)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Kl(e){return[360*Math.random(),30+150*Math.random(),50+150*Math.random()]}function Dl(t){let n,l,a,o,r,s,i,c,d,u;return{c(){n=j("div"),l=j("div"),a=j("div"),o=T(),r=j("div"),s=T(),i=j("div"),c=j("div"),d=T(),u=j("div"),A(a,"class","shadow svelte-bo2yxx"),H(a,"--rotate",t[2][0]+"deg"),H(a,"--height",t[3][0]+"px"),A(r,"class","shadow svelte-bo2yxx"),H(r,"--rotate",t[2][1]+"deg"),H(r,"--height",t[3][1]+"px"),H(l,"z-index","0"),A(l,"class","svelte-bo2yxx"),A(c,"class","slash svelte-bo2yxx"),H(c,"--rotate",t[2][0]+"deg"),H(c,"--height",t[3][0]+"px"),A(u,"class","slash svelte-bo2yxx"),H(u,"--rotate",t[2][1]+"deg"),H(u,"--height",t[3][1]+"px"),H(i,"z-index","4"),A(i,"class","svelte-bo2yxx"),A(n,"class","YoumuAttack svelte-bo2yxx"),H(n,"left",t[0]+"px"),H(n,"top",t[1]+"px"),H(n,"transform","rotate("+(30-60*Fl())+")")},m(e,t){x(e,n,t),b(n,l),b(l,a),b(l,o),b(l,r),b(n,s),b(n,i),b(i,c),b(i,d),b(i,u)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Fl(){return Math.random()}function Yl(e){return[40+120*Fl(),80+120*Fl(),[-20-50*Fl(),20+50*Fl()],[180+40*Fl(),180+40*Fl()]]}const Xl={marisa:class extends _e{constructor(e){super(),ke(this,e,Kl,Nl,s,{})}},youmu:class extends _e{constructor(e){super(),ke(this,e,Yl,Dl,s,{})}}};function Gl(e,t,n){const l=e.slice();return l[40]=t[n],l[41]=t,l[42]=n,l}function Jl(e,t,n){const l=e.slice();return l[43]=t[n],l[45]=n,l}function Wl(e,t,n){const l=e.slice();return l[46]=t[n],l[47]=t,l[45]=n,l}function Zl(e){let t,n,l=Object.values(e[3][e[42]])[e[45]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-1lblg1l")},m(e,l){x(e,t,l),b(t,n)},p(e,t){8&t[0]&&l!==(l=Object.values(e[3][e[42]])[e[45]]+"")&&E(n,l)},d(e){e&&w(t)}}}function Ul(e,t){let n,l,a,o,r,s=Object.values(t[3][t[42]])[t[45]]>1,i=t[42],c=t[45],d=s&&Zl(t);const u=()=>t[16](n,i,c),f=()=>t[16](null,i,c);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),d&&d.c(),r=T(),A(l,"class",a="icon-"+t[46]+" svelte-1lblg1l"),A(n,"class","svelte-1lblg1l"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),d&&d.m(n,null),b(n,r),u()},p(e,o){t=e,8&o[0]&&a!==(a="icon-"+t[46]+" svelte-1lblg1l")&&A(l,"class",a),8&o[0]&&(s=Object.values(t[3][t[42]])[t[45]]>1),s?d?d.p(t,o):(d=Zl(t),d.c(),d.m(n,r)):d&&(d.d(1),d=null),i===t[42]&&c===t[45]||(f(),i=t[42],c=t[45],u())},d(e){e&&w(n),d&&d.d(),f()}}}function Ql(e,t){let n,l,a,o=t[43].info.value+"";return{key:e,first:null,c(){n=j("a"),l=O(o),A(n,"class",a="battle-input-"+t[43].info.prop+" "+(t[43].info.penetrate&&"penetrate")+" "+(t[43].info.critical&&"critical")+" svelte-1lblg1l"),H(n,"left",150*na()-25+"px"),H(n,"top",50+150*na()+"px"),this.first=n},m(e,t){x(e,n,t),b(n,l)},p(e,r){t=e,64&r[0]&&o!==(o=t[43].info.value+"")&&E(l,o),64&r[0]&&a!==(a="battle-input-"+t[43].info.prop+" "+(t[43].info.penetrate&&"penetrate")+" "+(t[43].info.critical&&"critical")+" svelte-1lblg1l")&&A(n,"class",a)},d(e){e&&w(n)}}}function Vl(e){let t,n,l;var a=Xl[e[12].role];return a&&(t=q(a,{})),{c(){t&&ge(t.$$.fragment),n=M()},m(e,a){t&&ye(t,e,a),x(e,n,a),l=!0},p(e,l){if(a!==(a=Xl[e[12].role])){if(t){re();const e=t;ce(e.$$.fragment,1,0,(()=>{ve(e,1)})),se()}a?(t=q(a,{}),ge(t.$$.fragment),ie(t.$$.fragment,1),ye(t,n.parentNode,n)):t=null}},i(e){l||(t&&ie(t.$$.fragment,e),l=!0)},o(e){t&&ce(t.$$.fragment,e),l=!1},d(e){e&&w(n),t&&ve(t,e)}}}function ea(e,t){let n,l,a,o,r,s,i,d,f,m,h,p,g,y,v,k,_,$,M,C,E=t[42],q=Wt[t[40]].name+"",L=[],z=new Map,S=[],I=new Map;const R=()=>t[15](a,E),B=()=>t[15](null,E);let P=Object.keys(t[3][t[42]]);const N=e=>e[45];for(let e=0;e<P.length;e+=1){let n=Wl(t,P,e),l=N(n);z.set(l,L[e]=Ul(l,n))}let K=t[6][t[42]];const D=e=>e[45];for(let e=0;e<K.length;e+=1){let n=Jl(t,K,e),l=D(n);I.set(l,S[e]=Ql(l,n))}let F=t[8][t[42]]&&Vl(t);return{key:e,first:null,c(){n=j("div"),l=j("div"),a=j("img"),s=T(),i=j("txt"),d=O(q),f=T(),m=j("div"),h=j("div"),p=T(),g=j("div");for(let e=0;e<L.length;e+=1)L[e].c();y=T(),v=j("div"),k=T();for(let e=0;e<S.length;e+=1)S[e].c();_=T(),F&&F.c(),$=T(),c(a.src,o=`/img/enermy/${Wt[t[40]].type}/${t[40]}/${t[7][t[42]]}.webp`)||A(a,"src",o),A(a,"class",r=u(`${t[8][t[42]]&&"animate_enermyShake"}`)+" svelte-1lblg1l"),A(i,"class","svelte-1lblg1l"),A(l,"class","enermy-info svelte-1lblg1l"),A(h,"class","enermy-health svelte-1lblg1l"),H(h,"visibility",t[2][t[42]]<t[1][t[42]].health?"visible":"hidden"),H(h,"background-image",`linear-gradient(90deg, white ${t[2][t[42]]/t[1][t[42]].health*100}%, transparent ${t[2][t[42]]/t[1][t[42]].health*100}%)`),A(g,"class","enermy-buff svelte-1lblg1l"),A(m,"class","enermy-state svelte-1lblg1l"),A(v,"class","enermy-aim icon-aim svelte-1lblg1l"),A(n,"class",M=u(`enermy ${t[5]===t[42]&&"oneAim"} ${t[2][t[42]]<=0&&"animate_enermyOut"} ${t[0]==t[42]&&"orderEnermy"}`)+" svelte-1lblg1l"),H(n,"z-index",t[13].length-t[42]),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,a),R(),b(l,s),b(l,i),b(i,d),b(n,f),b(n,m),b(m,h),b(m,p),b(m,g);for(let e=0;e<L.length;e+=1)L[e]&&L[e].m(g,null);b(n,y),b(n,v),b(n,k);for(let e=0;e<S.length;e+=1)S[e]&&S[e].m(n,null);b(n,_),F&&F.m(n,null),b(n,$),C=!0},p(e,l){t=e,(!C||128&l[0]&&!c(a.src,o=`/img/enermy/${Wt[t[40]].type}/${t[40]}/${t[7][t[42]]}.webp`))&&A(a,"src",o),(!C||256&l[0]&&r!==(r=u(`${t[8][t[42]]&&"animate_enermyShake"}`)+" svelte-1lblg1l"))&&A(a,"class",r),E!==t[42]&&(B(),E=t[42],R()),(!C||6&l[0])&&H(h,"visibility",t[2][t[42]]<t[1][t[42]].health?"visible":"hidden"),(!C||6&l[0])&&H(h,"background-image",`linear-gradient(90deg, white ${t[2][t[42]]/t[1][t[42]].health*100}%, transparent ${t[2][t[42]]/t[1][t[42]].health*100}%)`),8712&l[0]&&(P=Object.keys(t[3][t[42]]),L=pe(L,l,N,1,t,P,z,g,me,Ul,null,Wl)),8256&l[0]&&(K=t[6][t[42]],S=pe(S,l,D,1,t,K,I,n,me,Ql,_,Jl)),t[8][t[42]]?F?(F.p(t,l),256&l[0]&&ie(F,1)):(F=Vl(t),F.c(),ie(F,1),F.m(n,$)):F&&(re(),ce(F,1,1,(()=>{F=null})),se()),(!C||37&l[0]&&M!==(M=u(`enermy ${t[5]===t[42]&&"oneAim"} ${t[2][t[42]]<=0&&"animate_enermyOut"} ${t[0]==t[42]&&"orderEnermy"}`)+" svelte-1lblg1l"))&&A(n,"class",M)},i(e){C||(ie(F),C=!0)},o(e){ce(F),C=!1},d(e){e&&w(n),B();for(let e=0;e<L.length;e+=1)L[e].d();for(let e=0;e<S.length;e+=1)S[e].d();F&&F.d()}}}function ta(e){let t,n,l,a,o,r=[],s=new Map,i=e[13];const c=e=>e[42];for(let t=0;t<i.length;t+=1){let n=Gl(e,i,t),l=c(n);s.set(l,r[t]=ea(l,n))}return{c(){t=j("div");for(let e=0;e<r.length;e+=1)r[e].c();A(t,"class",n="enermys "+(e[4]&&"number"==typeof e[5]&&"allAim")+" svelte-1lblg1l")},m(n,s){x(n,t,s);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null);e[18](t),l=!0,a||(o=C(t,"mouseenter",e[17]),a=!0)},p(e,a){14319&a[0]&&(i=e[13],re(),r=pe(r,a,c,1,e,i,s,t,he,ea,null,Gl),se()),(!l||48&a[0]&&n!==(n="enermys "+(e[4]&&"number"==typeof e[5]&&"allAim")+" svelte-1lblg1l"))&&A(t,"class",n)},i(e){if(!l){for(let e=0;e<i.length;e+=1)ie(r[e]);l=!0}},o(e){for(let e=0;e<r.length;e+=1)ce(r[e]);l=!1},d(n){n&&w(t);for(let e=0;e<r.length;e+=1)r[e].d();e[18](null),a=!1,o()}}}function na(){return Math.random()}function la(e,t,n){let l,a,o,r,s;d(e,ze,(e=>n(20,l=e))),d(e,Le,(e=>n(21,a=e))),d(e,Me,(e=>n(22,o=e))),d(e,Ae,(e=>n(23,r=e))),d(e,He,(e=>n(24,s=e)));let{battle:i}=t;const c=deepCopy(s);f(ze,l.explore=c,l);const u=deepCopy(r),m=c.target.map(((e,t)=>e&&c.enermy[t])).filter((e=>e));let h,p=m.map((e=>Wt[e].growth(c.lv))),g=p.map((e=>e.health)),y=g.map((e=>new Object)),v=!1,b=!1,k=m.map((e=>new Array)),_=m.map((e=>"portrait")),x=m.map((e=>!1));const w=m.map((e=>[])),$=[];let j;const O={list:[],handle(){this.list.length>0&&(1==this.list[0].time?0==i.effect.listLengthOf("enermy")&&this.list.shift().handle():this.list[0].time--)}},T={add(e,t){n(6,k[t]=[...k[t],{info:e,time:50}],k)},handle(){k.forEach(((e,t)=>{e.forEach((e=>{e.time>0&&e.time--})),0==e.filter((e=>e.time>0)).length&&H.express.outHurt(t)}))}},M={of(e){let t=deepCopy(this);return t.Target=e,t},get(e){return e in y[this.Target]&&y[this.Target][e]},getAll(){let e={};for(let t in y[this.Target])e[t]=tn[t];return e},add(e,t){i.effect.targetEnermy(this.Target).by((l=>{t=t||1,e in y[this.Target]?n(3,y[this.Target][e]+=t,y):n(3,y[this.Target][e]=t,y)}),10)},addAll(e,t){i.effect.targetEnermy(0).by((l=>{t=t||1,H.survival().forEach((l=>{e in y[l]?n(3,y[l][e]+=t,y):n(3,y[l][e]=t,y)}))}),10)},set(e,t){i.effect.targetEnermy(this.Target).by((l=>{n(3,y[this.Target][e]=t,y)}),10)},clear(e,t){if(!(e in y[this.Target]))return!1;t?i.effect.targetEnermy(this.Target).by((l=>{null!=y[this.Target][e]&&(n(3,y[this.Target][e]-=t,y),y[this.Target][e]<=0&&delete y[this.Target][e])}),10):i.effect.targetEnermy(this.Target).by((t=>{delete y[this.Target][e],n(3,y)}),10)},clearAll(e){i.effect.targetEnermy(this.Target).by((t=>{if(!0===e)for(let e in y[this.Target])tn[e].positive&&delete y[this.Target][e];else if(!1===e)for(let e in y[this.Target])!tn[e].positive&&delete y[this.Target][e];else n(3,y[this.Target]={},y);n(3,y)}),10)},link(e){return this.Key=e,this},to(e){if(this.Key in y[this.Target]){let t=y[this.Target][this.Key];tn[this.Key].expend&&this.clear(this.Key,1),e(Math.max(t,0))}},count(e){let t=Object.keys(y[this.Target]).filter((e=>tn[e].positive)).length;return e?t:Object.keys(y[this.Target]).length-t}},C={store:m.map((e=>"portrait")),emotionGet(e){let t="hurt"==_[e]?this.store[e]:_[e];return"number"==typeof e?t:_},emotionSet(e,t){"hurt"!=t&&(this.store[e]=_[e]),n(7,_[e]=t,_)},outHurt(e){n(7,_[e]=this.store[e],_),n(8,x[e]=!1,x)},hurt(e){n(8,x[e]=!0,x)}},A={except(e){let t=deepCopy(this);return t.Except=e,t},target(e){let t=deepCopy(this);return t.Aim="one",t.Target=e,t},targetMuti(e){let t=this;return t.Aim="muti",t.Muti=e,t},targetAll(){return this.Aim="all",this},average(){return this.Aim="average",this},random(){return this.Aim="random",this},source(e){return this.Source=e,this},from(e){return this.From=e,this},by(e){e.type;let t=g.map(((e,t)=>t)).filter((e=>g[e]>0)),a={one:[this.Target],all:t.filter((e=>e!=this.Except)),average:t.filter((e=>e!=this.Except)),random:t.filter((e=>e!=this.Except)).rd().splice(0,1)};const o=this.Source;this.Source=!1;let r="muti"==this.Aim?this.Muti:a[this.Aim];this.Target=!1,this.Except=-1,e.amount||(e.amount=1),i.effect.targetEnermy(this.Target).by((t=>{for(let t of r){const a=deepCopy(e);a.value/="average"==this.Aim?r.length:1;const s=[];for(let e=0;e<a.amount;e++){let e,r={damage:deepCopy(a),target:t,source:o};et.enermyDamagedProcess(l,r),r.damage.blocked?e="已阻挡":r.damage.miss?e="Miss":(n(2,g[t]-=r.damage.value,g),g[t]<=0&&(O.list=O.list.filter((e=>e.index!=t)),l.role.event.defeat(t).by(r.damage),0==l.enermy.survival().length&&l.battle.winEvent()),e=retain(r.damage.value,1)),T.add({value:e,prop:"damage",penetrate:r.damage.penetrate,critical:r.damage.critical},t),s.push(r.damage)}let i=s.filter((e=>e.miss)),c=s.filter((e=>e.blocked));0==i.length&&"hurt"!=H.express.emotionGet(t)&&H.express.hurt(t),0==c&&H.express.emotionSet(t,"hurt")}}))}},E={from(e){return this.From=e,this},target(e){return this.Target=e,this.Aim="one",this},targetAll(){return this.Aim="all",this},by(e){e.type;let t=g.map(((e,t)=>t)).filter((e=>g[e]>0)),l={one:[this.Target],all:t.filter((e=>e!=this.Except)),average:t.filter((e=>e!=this.Except)),random:t.filter((e=>e!=this.Except)).rd().splice(0,1)};this.Source=!1;let a="muti"==this.Aim?this.Muti:l[this.Aim];this.Target=!1,this.Except=-1,e.amount||(e.amount=1),i.effect.targetEnermy(this.Target).by((t=>{for(let t of a){return e.type,n(2,g[t]+=e.value,g),g[t]-p.health>0&&n(2,g[t]=p.health,g),T.add({value:retain(e.value,1),prop:"heal"},t),e.value}}))}},H={action:function(){a.add("enermyAction",(e=>O.handle()),1);m.forEach(((e,t)=>{g[t]>0&&(O.list.push({handle:e=>{i.effect.targetEnermy(t).by((e=>{n(0,h=t),H.event.round.of(t).start()}))},time:75,index:t}),O.list.push({handle:n=>i.effect.targetRole(t).by((n=>{Wt[e].action(l,t)})),time:50,index:t}))})),O.list.push({handle:e=>{i.effect.targetRole(0).by((e=>{n(0,h=null),a.clear("enermyAction"),l.role.event.round.start()}))},time:75})},render:T,state:{of(e){return this.Target=e,this},get(){let e=deepCopy(p[this.Target]);e.Health=g[this.Target];let t={state:e,target:this.Target};return et.enermyStateGet(l,t),e},getAll(){let e=deepCopy(p);return g.forEach(((t,n)=>e[n].Health=t)),e},set(e,t){var a,o;"Health"==e?(a=t,o=this.Target,n(2,g[o]=a>p[o].health?p[o].health:a,g)):n(1,p[this.Target][e]=t,p),g[this.Target]<=0&&(O.list=O.list.filter((e=>e.index!=this.Target)),l.role.event.defeat(this.Target),0==l.enermy.survival().length&&l.battle.winEvent())}},buff:M,express:C,damage:A,heal:E,event:{round:{of(e){return this.Target=e,this},start(){let e={target:this.Target,interimBuff:Object.keys(tn).filter((e=>tn[e].interim)),decreaseBuff:Object.keys(tn).filter((e=>tn[e].decrease))};et.enermyRoundStart(l,e),e.decreaseBuff.forEach((e=>H.buff.of(this.Target).clear(e,1))),e.interimBuff.forEach((e=>H.buff.of(this.Target).clear(e)))},end(){}}},survival:q,info:{of(e){return this.Target=e,this},get(){return Wt[m[this.Target]]}},checkForPosition:function(e){let t=$.map((e=>e.getBoundingClientRect())),a=j.getBoundingClientRect(),o=!1,r=!l.handcard.aim()&&!l.battle.equipment.aim();t.forEach(((t,n)=>{e.x>t.left&&e.x<t.right&&e.y<t.bottom-50&&e.y>t.top&&(o=n)})),"number"==typeof o&&g[o]<=0&&(o=!1);r?(e.x>a.left&&e.x<a.right&&e.y<a.bottom-50&&e.y>a.top&&(o=q()[0]),n(5,b=o)):n(5,b=o);return o},equipmentAim:function(){return"number"==typeof b&&(g[b]>0&&(i.equipment.target(b).use(),n(5,b=!1),!0))}};function q(){return m.map(((e,t)=>t)).filter((e=>p[e].health<0||g[e]>0))}f(ze,l.enermy=H,l),K((e=>{a.add("enermyInput",(e=>T.handle()),1),et.enermyOnload(l,{enermys:m}),setTimeout((e=>{m.forEach(((e,t)=>Wt[e].onload&&Wt[e].onload(l,t)))}),1e3)})),N((e=>{l.handcard&&l.battle.equipment&&n(4,v=!l.handcard.aim()&&!l.battle.equipment.aim()),w.forEach(((e,t)=>{e.forEach(((e,n)=>{let l=Object.keys(y[t])[n];l&&o(e).color(tn[l].positive?"blue":"purple").with(tn[l])}))}));let t=c.enermy.filter(((e,t)=>c.target[t])).map((e=>Wt[e]));$.forEach(((e,n)=>{o(e).color(t[n].color).with(t[n])}))}));return e.$$set=e=>{"battle"in e&&n(14,i=e.battle)},[h,p,g,y,v,b,k,_,x,w,$,j,u,m,i,function(e,t){Y[e?"unshift":"push"]((()=>{$[t]=e,n(10,$)}))},function(e,t,l){Y[e?"unshift":"push"]((()=>{w[t][l]=e,n(9,w)}))},e=>n(5,b=!1),function(e){Y[e?"unshift":"push"]((()=>{j=e,n(11,j)}))}]}class aa extends _e{constructor(e){super(),ke(this,e,la,ta,s,{battle:14},null,[-1,-1])}}function oa(e,t,n){const l=e.slice();return l[29]=t[n],l[30]=t,l[31]=n,l}function ra(e,t,n){const l=e.slice();return l[31]=t[n],l}function sa(e,t,n){const l=e.slice();return l[31]=t[n],l}function ia(e,t,n){const l=e.slice();return l[36]=t[n],l[31]=n,l}function ca(e,t){let n,l,a,o=t[36].info.value+"";return{key:e,first:null,c(){n=j("a"),l=O(o),A(n,"class",a="battle-input-"+t[36].info.prop+" "+(t[36].info.penetrate&&"penetrate")+" svelte-pm6iuh"),H(n,"left",160+150*ga()+"px"),H(n,"top",60*ga()+40+"px"),this.first=n},m(e,t){x(e,n,t),b(n,l)},p(e,r){t=e,32&r[0]&&o!==(o=t[36].info.value+"")&&E(l,o),32&r[0]&&a!==(a="battle-input-"+t[36].info.prop+" "+(t[36].info.penetrate&&"penetrate")+" svelte-pm6iuh")&&A(n,"class",a)},d(e){e&&w(n)}}}function da(e){let t;return{c(){t=j("div"),H(t,"transform","rotate("+180/e[1][0].power*e[31]+"deg)"),A(t,"class","svelte-pm6iuh")},m(e,n){x(e,t,n)},p(e,n){2&n[0]&&H(t,"transform","rotate("+180/e[1][0].power*e[31]+"deg)")},d(e){e&&w(t)}}}function ua(t){let n;return{c(){n=j("div"),A(n,"style",t[31]%4==3&&"height:15px"),A(n,"class","svelte-pm6iuh")},m(e,t){x(e,n,t)},p:e,d(e){e&&w(n)}}}function fa(e){let t,n,l,a,o,r=Object.values(e[0][0])[e[31]]>1,s=e[29],i=r&&ma(e);const c=()=>e[11](t,s),d=()=>e[11](null,s);return{c(){t=j("div"),n=j("icon"),a=T(),i&&i.c(),o=T(),A(n,"class",l="icon-"+e[29]+" svelte-pm6iuh"),A(t,"class","svelte-pm6iuh")},m(e,l){x(e,t,l),b(t,n),b(t,a),i&&i.m(t,null),b(t,o),c()},p(a,u){e=a,1&u[0]&&l!==(l="icon-"+e[29]+" svelte-pm6iuh")&&A(n,"class",l),1&u[0]&&(r=Object.values(e[0][0])[e[31]]>1),r?i?i.p(e,u):(i=ma(e),i.c(),i.m(t,o)):i&&(i.d(1),i=null),s!==e[29]&&(d(),s=e[29],c())},d(e){e&&w(t),i&&i.d(),d()}}}function ma(e){let t,n,l=Object.values(e[0][0])[e[31]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-pm6iuh")},m(e,l){x(e,t,l),b(t,n)},p(e,t){1&t[0]&&l!==(l=Object.values(e[0][0])[e[31]]+"")&&E(n,l)},d(e){e&&w(t)}}}function ha(e,t){let n,l,a=Object.values(t[0][0])[t[31]]>0,o=a&&fa(t);return{key:e,first:null,c(){n=M(),o&&o.c(),l=M(),this.first=n},m(e,t){x(e,n,t),o&&o.m(e,t),x(e,l,t)},p(e,n){t=e,1&n[0]&&(a=Object.values(t[0][0])[t[31]]>0),a?o?o.p(t,n):(o=fa(t),o.c(),o.m(l.parentNode,l)):o&&(o.d(1),o=null)},d(e){e&&w(n),o&&o.d(e),e&&w(l)}}}function pa(t){let n,l,a,o,r,s,i,d,u,f,m,h,p,g,y,v,k,_,M,C,q,L,z,S,I,R,B=[],P=new Map,N=t[4][0]+"",K=t[2][0].toFixed(0)+"",D=t[1][0].health+"",F=[],Y=new Map,X=t[5][0];const G=e=>e[31];for(let e=0;e<X.length;e+=1){let n=ia(t,X,e),l=G(n);P.set(l,B[e]=ca(l,n))}let J=[...Array(t[1][0].power).keys()],W=[];for(let e=0;e<J.length;e+=1)W[e]=da(sa(t,J,e));let Z=[...Array(28).keys()],U=[];for(let e=0;e<Z.length;e+=1)U[e]=ua(ra(t,Z,e));let Q=Object.keys(t[0][0]);const V=e=>e[31];for(let e=0;e<Q.length;e+=1){let n=oa(t,Q,e),l=V(n);Y.set(l,F[e]=ha(l,n))}return{c(){n=j("div");for(let e=0;e<B.length;e+=1)B[e].c();l=T(),a=j("div"),o=j("div");for(let e=0;e<W.length;e+=1)W[e].c();r=T(),s=j("div"),i=T(),d=j("div"),u=j("img"),m=T(),h=j("div"),p=j("txt"),g=O(N),y=T(),v=j("div"),k=j("div"),_=j("txt"),M=O(K),C=T(),q=j("div");for(let e=0;e<U.length;e+=1)U[e].c();L=T(),z=j("txt"),S=O(D),I=T(),R=j("div");for(let e=0;e<F.length;e+=1)F[e].c();A(o,"class","line svelte-pm6iuh"),A(s,"class","cursor svelte-pm6iuh"),H(s,"transform","rotate("+(180*t[3][0]/t[1][0].power-90)+"deg)"),A(a,"class","power svelte-pm6iuh"),c(u.src,f="/img/role/dairi/"+t[8].role+".webp")||A(u,"src",f),A(u,"class","svelte-pm6iuh"),A(p,"class","svelte-pm6iuh"),A(h,"class","exPower svelte-pm6iuh"),H(h,"visibility",t[4][0]>0?"visible":"hidden"),A(d,"class","avatar svelte-pm6iuh"),A(_,"class","svelte-pm6iuh"),A(k,"class","pencil svelte-pm6iuh"),H(k,"width",120+150*t[2][0]/t[1][0].health+"px"),A(z,"class","svelte-pm6iuh"),A(q,"class","ruler svelte-pm6iuh"),A(v,"class","health svelte-pm6iuh"),A(R,"class","buff svelte-pm6iuh"),A(n,"class","state svelte-pm6iuh")},m(e,c){x(e,n,c);for(let e=0;e<B.length;e+=1)B[e]&&B[e].m(n,null);b(n,l),b(n,a),b(a,o);for(let e=0;e<W.length;e+=1)W[e]&&W[e].m(o,null);b(a,r),b(a,s),b(n,i),b(n,d),b(d,u),b(d,m),b(d,h),b(h,p),b(p,g),t[10](h),b(n,y),b(n,v),b(v,k),b(k,_),b(_,M),b(v,C),b(v,q);for(let e=0;e<U.length;e+=1)U[e]&&U[e].m(q,null);b(q,L),b(q,z),b(z,S),b(n,I),b(n,R);for(let e=0;e<F.length;e+=1)F[e]&&F[e].m(R,null)},p(e,t){if(32&t[0]&&(X=e[5][0],B=pe(B,t,G,1,e,X,P,n,me,ca,l,ia)),2&t[0]){let n;for(J=[...Array(e[1][0].power).keys()],n=0;n<J.length;n+=1){const l=sa(e,J,n);W[n]?W[n].p(l,t):(W[n]=da(l),W[n].c(),W[n].m(o,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=J.length}if(10&t[0]&&H(s,"transform","rotate("+(180*e[3][0]/e[1][0].power-90)+"deg)"),16&t[0]&&N!==(N=e[4][0]+"")&&E(g,N),16&t[0]&&H(h,"visibility",e[4][0]>0?"visible":"hidden"),4&t[0]&&K!==(K=e[2][0].toFixed(0)+"")&&E(M,K),6&t[0]&&H(k,"width",120+150*e[2][0]/e[1][0].health+"px"),0&t){let n;for(Z=[...Array(28).keys()],n=0;n<Z.length;n+=1){const l=ra(e,Z,n);U[n]?U[n].p(l,t):(U[n]=ua(l),U[n].c(),U[n].m(q,L))}for(;n<U.length;n+=1)U[n].d(1);U.length=Z.length}2&t[0]&&D!==(D=e[1][0].health+"")&&E(S,D),129&t[0]&&(Q=Object.keys(e[0][0]),F=pe(F,t,V,1,e,Q,Y,R,me,ha,null,oa))},i:e,o:e,d(e){e&&w(n);for(let e=0;e<B.length;e+=1)B[e].d();$(W,e),t[10](null),$(U,e);for(let e=0;e<F.length;e+=1)F[e].d()}}}function ga(){return Math.random()}function ya(e,t,n){let l,a,o,r;d(e,Me,(e=>n(12,l=e))),d(e,ze,(e=>n(13,a=e))),d(e,Le,(e=>n(14,o=e))),d(e,Ae,(e=>n(15,r=e)));const s=deepCopy(r);let i=[{},{}],c=[deepCopy(Xe.role[s.role]),{}],u=[s.health,50],m=[c[0].power,0],h=[0,0],p=[[],[]];const g={exPowerLimit:Object.values(s.card).sum()};let y;const v=deepCopy(tn),b={add(e,t){n(5,p[t]=[...p[t],{info:e,time:50}],p)},handle(){p.forEach(((e,t)=>{e.forEach((e=>{e.time>0&&e.time--}))}))}},k={except(e){return this.Except=e,this},target(e){return this.Aim="one",this.Target=e,this},targetAll(){return this.Aim="all",this},average(){return this.Aim="average",this},source(e){return this.Source=e,this},from(e){return this.From=e,this},random(){return this.Aim="random",this},by(e){let t=this.From;this.From=!1,x.effect.targetRole(this.Target).by((l=>{e.type,"scale"==e.type&&(e.value*=.01*a.enermy.state.of([t]).get().attack);let o=u.map(((e,t)=>t)).filter((e=>u[e]>0)),r={one:[this.Target],all:o.filter((e=>e!=this.Except)),average:o.filter((e=>e!=this.Except)),random:o.filter((e=>e!=this.Except)).rd().splice(0,1)}[this.Aim];this.Except=-1;const s=this.Source;this.Source=!1;for(let l of r){const o=deepCopy(e);o.value/="average"==this.Aim?r.length:1;let i={damage:o,target:l,source:s,from:t};et.roleDamagedProcess(a,i),o.amount||(o.amount=1);for(let e=0;e<o.amount;e++){let e;o.blocked?e="已阻挡":o.miss?e="Miss":(n(2,u[l]-=o.value,u),u[l]<0&&x.deadEvent(),e=retain(o.value,1)),b.add({value:e,prop:"damage",penetrate:i.damage.penetrate},l)}}}))}},_={damage:k,heal:{from(e){return this.From=e,this},target(e){return this.Target=e,this},by(e){e.type;let t={heal:e,target:this.Target};return et.roleHealProcess(a,t),u[this.Target],c[this.Target].health,w(u[this.Target]+e.value,this.Target),b.add({value:retain(e.value,1),prop:"heal"},this.Target),e.value}},state:{of(e){return this.Target=e,this},get(){let e=deepCopy(c[this.Target]);e.Health=u[this.Target];let t={state:e,target:this.Target};return et.roleStateGet(a,t),e},getAll:()=>c,set(e,t){"Health"==e?w(t,this.Target):n(1,c[this.Target][e]=t,c),"health"==e&&w(Math.min(t,u[this.Target]),this.Target),u[this.Target]<0&&x.deadEvent()},add(e,t){let n=a.role.state.of(0).get();a.role.state.set(e,n[e]+t)}},buff:{of(e){return this.Target=e,this},get(e){if(e in i[this.Target]){let t={amount:i[this.Target][e],buff:tn[e],target:this.Target};return et.roleBuffGet(a,t),t.amount}return!1},getAll(){let e={};for(let t in i[this.Target])e[t]=tn[t];return e},set(e,t){x.effect.targetRole(this.Target).by((l=>{n(0,i[this.Target][e]=t,i)}),10)},clear(e,t){if(e in i[this.Target])x.effect.targetRole(this.Target).by((l=>{t&&i[this.Target][e]?(n(0,i[this.Target][e]-=t,i),i[this.Target][e]<=0&&delete i[this.Target][e]):delete i[this.Target][e],n(0,i)}),10);else{if("boolean"!=typeof e)return!1;for(let n=0;n<t;n++){let t=Object.keys(i[this.Target]).rd(),n=t.filter((e=>tn[e].positive)),l=t.filter((e=>!tn[e].positive));this.clear(e?n[0]:l[0],1)}}n(0,i)},clearAll(e){x.effect.targetRole(this.Target).by((t=>{if(!0===e)for(let e in i[this.Target])tn[e].positive&&delete i[this.Target][e];else if(!1===e)for(let e in i[this.Target])!tn[e].positive&&delete i[this.Target][e];else n(0,i[this.Target]={},i);n(0,i)}),10)},link(e){return this.Key=e,this},to(e){if(this.Key in i[this.Target]){let t={amount:i[this.Target][this.Key],buff:tn[this.Key],target:this.Target};et.roleBuffGet(a,t),tn[this.Key].expend&&(this.Key.decreaseOf(i[this.Target]),n(0,i)),t.amount>0&&e(t.amount)}},add(e,t){x.effect.targetRole(this.Target).by((l=>{t=t||1,e in i[this.Target]?n(0,i[this.Target][e]+=t,i):n(0,i[this.Target][e]=t,i)}),10,e)},count(e){let t=Object.keys(i[this.Target]).filter((e=>tn[e].positive)).length;return e?t:Object.keys(i[this.Target]).length-t}},power:{of(e){return this.Target=e,this},cost(e){let t=m[this.Target]+h[this.Target]-e;return n(4,h[this.Target]=t<=m[this.Target]?0:h[this.Target]-e,h),t<=m[this.Target]&&n(3,m[this.Target]=t,m),t},reset(e){e||(e=0),n(3,m[this.Target]=Math.max(0,c[this.Target].power+e,m[this.Target]),m)},add(e){let t={amount:e};et.rolePowerAdd(a,t),n(4,h[this.Target]=Math.min(g.exPowerLimit,h[this.Target]+t.amount),h)},get(){return m[this.Target]+h[this.Target]},getExPower(){return h[this.Target]},clear(){n(3,m[this.Target]=0,m),n(4,h[this.Target]=0,h)}},collection:{link(e){return this.Key=e,this},to(e){return this.Key in s.collection&&e(s.collection[this.Key]),this.Key in s.collection}},equipment:{link(e){return this.Key=e,this},to(e){return s.equipment==this.Key&&e(),s.equipment==this.Key}},souvenir:{link(e){return this.Key=e,this},to(e){return s.souvenir==this.Key&&e(),s.souvenir==this.Key}},event:{handle:{defeat(e,t){let n={target:t,damage:e};a.enermy.state.getAll().filter((e=>e.Health>0)).length>0&&(et.defeatEnermy(a,n),a.battle.winEvent(t))},failed(e){}},defeat(e){return this.Type="defeat",this.Target=e,this},failed(){return this.Type="failed",this},by(e){this.handle[this.Type](e,this.Target)},round:{count:0,start(){x.effect.targetRole(0).by((e=>{this.count++;let t={powerReset:!0,handcardRefresh:!0,interimBuff:Object.keys(tn).filter((e=>tn[e].interim&&!tn[e].roundend)),decreaseBuff:Object.keys(tn).filter((e=>tn[e].decrease&&!tn[e].roundend)),offset:0};et.roleRoundStart(a,t),t.decreaseBuff.forEach((e=>_.buff.of(0).clear(e,1))),t.interimBuff.forEach((e=>_.buff.of(0).clear(e))),t.powerReset&&_.power.of(0).reset(t.offset),t.handcardRefresh&&a.handcard.refresh(),x.round.set(!0),et.afterRoleRoundStart(a,{})}))},end(){let e={interimBuff:Object.keys(tn).filter((e=>tn[e].interim&&tn[e].roundend)),decreaseBuff:Object.keys(tn).filter((e=>tn[e].decrease&&tn[e].roundend))};et.roleRoundEnd(a,e),e.decreaseBuff.forEach((e=>_.buff.of(0).clear(e,1))),e.interimBuff.forEach((e=>_.buff.of(0).clear(e))),x.round.set(!1),a.enermy.action()}}}};f(ze,a.role=_,a);let{battle:x}=t;function w(e,t){n(2,u[t]=Math.min(e,c[t].health),u)}return K((e=>{l(y).with({name:"额外灵力",detail:"等同于灵力，优先消耗。\n上限等同于牌库总牌数。"}),o.add("roleInput",(e=>b.handle()),1),et.roleOnload(a,g)})),N((e=>{for(let e in v)v[e].e&&l(v[e].e).color(tn[e].positive?"blue":"purple").with(v[e])})),e.$$set=e=>{"battle"in e&&n(9,x=e.battle)},[i,c,u,m,h,p,y,v,s,x,function(e){Y[e?"unshift":"push"]((()=>{y=e,n(6,y)}))},function(e,t){Y[e?"unshift":"push"]((()=>{v[t].e=e,n(7,v)}))}]}class va extends _e{constructor(e){super(),ke(this,e,ya,pa,s,{battle:9},null,[-1,-1])}}function ba(e,t,n){const l=e.slice();return l[50]=t[n],l[52]=n,l}function ka(e,t,n){const l=e.slice();return l[53]=t[n],l[54]=t,l[52]=n,l}function _a(e){let t,n,l,a,o,r;return{c(){t=j("div"),n=j("div"),l=T(),a=j("div"),A(n,"class","cursor-body svelte-1udp2xy"),A(a,"class","pointer svelte-1udp2xy"),A(t,"class","cursor svelte-1udp2xy"),H(t,"left",e[6].x+"px"),H(t,"top",e[6].y+"px"),H(t,"transform","rotate("+e[6].r+"deg)"),H(t,"height",e[6].l+"px"),H(t,"--color",e[6].aim?"#f00":"#00f")},m(e,o){x(e,t,o),b(t,n),b(t,l),b(t,a),r=!0},p(e,n){(!r||64&n[0])&&H(t,"left",e[6].x+"px"),(!r||64&n[0])&&H(t,"top",e[6].y+"px"),(!r||64&n[0])&&H(t,"transform","rotate("+e[6].r+"deg)"),(!r||64&n[0])&&H(t,"height",e[6].l+"px"),(!r||64&n[0])&&H(t,"--color",e[6].aim?"#f00":"#00f")},i(e){r||(o&&o.end(1),r=!0)},o(e){o=fe(t,$e,{duration:250}),r=!1},d(e){e&&w(t),e&&o&&o.end()}}}function xa(e){let t,n,l,a=[],o=new Map,r=Object.keys(e[0].consumable);const s=e=>e[52];for(let t=0;t<r.length;t+=1){let n=ka(e,r,t),l=s(n);o.set(l,a[t]=$a(l,n))}return{c(){t=j("div");for(let e=0;e<a.length;e+=1)a[e].c();n=T(),l=j("txt"),l.textContent="长按使用",A(t,"class","consumable-list svelte-1udp2xy"),A(l,"class","tip svelte-1udp2xy")},m(e,o){x(e,t,o);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,null);x(e,n,o),x(e,l,o)},p(e,n){513&n[0]&&(r=Object.keys(e[0].consumable),a=pe(a,n,s,1,e,r,o,t,me,$a,null,ka))},d(e){e&&w(t);for(let e=0;e<a.length;e+=1)a[e].d();e&&w(n),e&&w(l)}}}function wa(e){let t,n,l=e[0].consumable[e[53]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-1udp2xy")},m(e,l){x(e,t,l),b(t,n)},p(e,t){1&t[0]&&l!==(l=e[0].consumable[e[53]]+"")&&E(n,l)},d(e){e&&w(t)}}}function $a(e,t){let n,l,a,o=t[52],r=t[0].consumable[t[53]]>1&&wa(t);const s=()=>t[26](n,o),i=()=>t[26](null,o);return{key:e,first:null,c(){n=j("icon"),r&&r.c(),l=T(),A(n,"class",a="icon-"+t[53]+" svelte-1udp2xy"),this.first=n},m(e,t){x(e,n,t),r&&r.m(n,null),b(n,l),s()},p(e,c){(t=e)[0].consumable[t[53]]>1?r?r.p(t,c):(r=wa(t),r.c(),r.m(n,l)):r&&(r.d(1),r=null),1&c[0]&&a!==(a="icon-"+t[53]+" svelte-1udp2xy")&&A(n,"class",a),o!==t[52]&&(i(),o=t[52],s())},d(e){e&&w(n),r&&r.d(),i()}}}function ja(e){let t,n;return{c(){t=j("img"),c(t.src,n="/img/role/"+e[16].resource+"/"+e[2]+"/"+e[0].role+".webp")||A(t,"src",n),A(t,"class","svelte-1udp2xy")},m(e,n){x(e,t,n)},p(e,l){65541&l[0]&&!c(t.src,n="/img/role/"+e[16].resource+"/"+e[2]+"/"+e[0].role+".webp")&&A(t,"src",n)},d(e){e&&w(t)}}}function Oa(e){let t,n,l="win"==e[2]?"胜利":"满身疮痍";return{c(){t=j("txt"),n=O(l),A(t,"class","title svelte-1udp2xy")},m(e,l){x(e,t,l),b(t,n)},p(e,t){4&t[0]&&l!==(l="win"==e[2]?"胜利":"满身疮痍")&&E(n,l)},d(e){e&&w(t)}}}function Ta(e,t){let n,l,a,o,r,s,i="blue"==t[50]?"蓝色":"green"==t[50]?"绿色":"红色";function c(...e){return t[29](t[50],t[52],...e)}return{key:e,first:null,c(){n=j("txt"),l=O("获得"),a=O(i),o=O("收藏品"),A(n,"class","skip svelte-1udp2xy"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),b(n,o),r||(s=C(n,"click",c),r=!0)},p(e,n){t=e,1024&n[0]&&i!==(i="blue"==t[50]?"蓝色":"green"==t[50]?"绿色":"红色")&&E(a,i)},d(e){e&&w(n),r=!1,s()}}}function Ma(t){let n,l,a;return{c(){n=j("txt"),n.textContent="结算",A(n,"class","skip svelte-1udp2xy")},m(e,o){x(e,n,o),l||(a=C(n,"click",t[33]),l=!0)},p:e,d(e){e&&w(n),l=!1,a()}}}function Ca(e){let t,n,l,a,o,r=e[12]&&Aa(e),s=0!=e[11]&&Ea(e);return{c(){r&&r.c(),t=T(),s&&s.c(),n=T(),l=j("txt"),l.textContent="返回",A(l,"class","skip svelte-1udp2xy")},m(i,c){r&&r.m(i,c),x(i,t,c),s&&s.m(i,c),x(i,n,c),x(i,l,c),a||(o=C(l,"click",e[32]),a=!0)},p(e,l){e[12]?r?r.p(e,l):(r=Aa(e),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),0!=e[11]?s?s.p(e,l):(s=Ea(e),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},d(e){r&&r.d(e),e&&w(t),s&&s.d(e),e&&w(n),e&&w(l),a=!1,o()}}}function Aa(t){let n,l,a;return{c(){n=j("txt"),n.textContent="获得装备",A(n,"class","skip svelte-1udp2xy")},m(e,o){x(e,n,o),l||(a=C(n,"click",t[30]),l=!0)},p:e,d(e){e&&w(n),l=!1,a()}}}function Ea(e){let t,n,l,a,o,r;return{c(){t=j("txt"),n=O("获得"),l=O(e[11]),a=j("icon"),A(a,"class","icon-coin"),A(t,"class","skip svelte-1udp2xy")},m(s,i){x(s,t,i),b(t,n),b(t,l),b(t,a),o||(r=C(t,"click",e[31]),o=!0)},p(e,t){2048&t[0]&&E(l,e[11])},d(e){e&&w(t),o=!1,r()}}}function Ha(e){let t,n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M,q,L,z,S,I,R,B,P,N,K,D,F,Y,X,G,J,W,U=e[13][e[3]]+"",Q=[],V=new Map,ee="x"in e[6]&&_a(e);o=new aa({props:{battle:e[18]}}),s=new Pl({props:{battle:e[18]}}),c=new va({props:{battle:e[18]}});let te=e[8]&&xa(e),ne=e[2]&&"none"!=e[2]&&ja(e),le=e[2]&&"none"!=e[2]&&Oa(e),ae=e[10];const oe=e=>e[52];for(let t=0;t<ae.length;t+=1){let n=ba(e,ae,t),l=oe(n);V.set(l,Q[t]=Ta(l,n))}function de(e,t){return e[15].chance.amount>=0?Ca:Ma}let he=de(e),be=he(e);return{c(){t=j("div"),ee&&ee.c(),n=T(),l=j("div"),ge(o.$$.fragment),r=T(),ge(s.$$.fragment),i=T(),ge(c.$$.fragment),d=T(),u=j("div"),f=j("div"),m=j("icon"),p=T(),g=j("div"),g.innerHTML='<icon class="icon-consumables svelte-1udp2xy"></icon>',y=T(),v=j("txt"),v.innerHTML="结束<br/>回合",k=T(),_=j("txt"),_.textContent="x",$=T(),M=j("txt"),q=O(U),L=T(),te&&te.c(),I=T(),R=j("div"),ne&&ne.c(),B=T(),P=j("div"),le&&le.c(),N=T();for(let e=0;e<Q.length;e+=1)Q[e].c();K=T(),be.c(),A(m,"class",h="icon-"+(e[0].equipment?e[0].equipment:"empty")+" svelte-1udp2xy"),A(f,"class","equipment svelte-1udp2xy"),A(g,"class","consumables svelte-1udp2xy"),A(v,"class","roundEnd svelte-1udp2xy"),A(_,"class","hideconsumable svelte-1udp2xy"),A(M,"class","remark svelte-1udp2xy"),A(u,"class",z="action "+(e[1]?"in":"out")+"Round "+(e[7]&&"showRemark")+" "+(e[8]&&"showConsumable")+" svelte-1udp2xy"),A(l,"class",S="battle "+e[2]+" svelte-1udp2xy"),H(P,"width","180px"),A(P,"class","svelte-1udp2xy"),A(R,"class","barrier body svelte-1udp2xy"),A(R,"style",D="z-index:"+(e[2]?6:-1)+";"+(e[2]&&"visibility:visible")),A(t,"class",F="body "+e[2]+" svelte-1udp2xy"),H(t,"background-image","url('/img/scene/"+e[0].scene+".webp')")},m(a,h){x(a,t,h),ee&&ee.m(t,null),b(t,n),b(t,l),ye(o,l,null),b(l,r),ye(s,l,null),b(l,i),ye(c,l,null),b(l,d),b(l,u),b(u,f),b(f,m),e[19](f),b(u,p),b(u,g),b(u,y),b(u,v),b(u,k),b(u,_),b(u,$),b(u,M),b(M,q),b(u,L),te&&te.m(u,null),b(t,I),b(t,R),ne&&ne.m(R,null),b(R,B),b(R,P),le&&le.m(P,null),b(P,N);for(let e=0;e<Q.length;e+=1)Q[e]&&Q[e].m(P,null);b(P,K),be.m(P,null),e[34](t),G=!0,J||(W=[C(g,"mouseenter",e[20]),C(g,"click",e[21]),C(v,"click",e[22]),C(v,"mouseenter",e[23]),C(_,"mouseenter",e[24]),C(_,"click",e[25]),C(u,"mouseover",e[27]),C(u,"mouseout",e[28])],J=!0)},p(e,a){"x"in e[6]?ee?(ee.p(e,a),64&a[0]&&ie(ee,1)):(ee=_a(e),ee.c(),ie(ee,1),ee.m(t,n)):ee&&(re(),ce(ee,1,1,(()=>{ee=null})),se()),(!G||1&a[0]&&h!==(h="icon-"+(e[0].equipment?e[0].equipment:"empty")+" svelte-1udp2xy"))&&A(m,"class",h),(!G||8200&a[0])&&U!==(U=e[13][e[3]]+"")&&E(q,U),e[8]?te?te.p(e,a):(te=xa(e),te.c(),te.m(u,null)):te&&(te.d(1),te=null),(!G||386&a[0]&&z!==(z="action "+(e[1]?"in":"out")+"Round "+(e[7]&&"showRemark")+" "+(e[8]&&"showConsumable")+" svelte-1udp2xy"))&&A(u,"class",z),(!G||4&a[0]&&S!==(S="battle "+e[2]+" svelte-1udp2xy"))&&A(l,"class",S),e[2]&&"none"!=e[2]?ne?ne.p(e,a):(ne=ja(e),ne.c(),ne.m(R,B)):ne&&(ne.d(1),ne=null),e[2]&&"none"!=e[2]?le?le.p(e,a):(le=Oa(e),le.c(),le.m(P,N)):le&&(le.d(1),le=null),17408&a[0]&&(ae=e[10],Q=pe(Q,a,oe,1,e,ae,V,P,me,Ta,K,ba)),he===(he=de(e))&&be?be.p(e,a):(be.d(1),be=he(e),be&&(be.c(),be.m(P,null))),(!G||4&a[0]&&D!==(D="z-index:"+(e[2]?6:-1)+";"+(e[2]&&"visibility:visible")))&&A(R,"style",D),(!G||4&a[0]&&F!==(F="body "+e[2]+" svelte-1udp2xy"))&&A(t,"class",F),(!G||1&a[0])&&H(t,"background-image","url('/img/scene/"+e[0].scene+".webp')")},i(e){G||(ie(ee),ie(o.$$.fragment,e),ie(s.$$.fragment,e),ie(c.$$.fragment,e),Z((()=>{G&&(X&&X.end(1),Y=ue(t,we,{duration:250}),Y.start())})),G=!0)},o(e){ce(ee),ce(o.$$.fragment,e),ce(s.$$.fragment,e),ce(c.$$.fragment,e),Y&&Y.invalidate(),X=fe(t,we,{duration:250}),G=!1},d(n){n&&w(t),ee&&ee.d(),ve(o),ve(s),ve(c),e[19](null),te&&te.d(),ne&&ne.d(),le&&le.d();for(let e=0;e<Q.length;e+=1)Q[e].d();be.d(),e[34](null),n&&X&&X.end(),J=!1,a(W)}}}function qa(e,t,n){let l,a,o,r,s,i,c,u;d(e,ze,(e=>n(14,l=e))),d(e,He,(e=>n(37,a=e))),d(e,Ae,(e=>n(15,o=e))),d(e,qe,(e=>n(38,r=e))),d(e,Me,(e=>n(39,s=e))),d(e,Le,(e=>n(40,i=e))),d(e,Ee,(e=>n(16,c=e))),d(e,Te,(e=>n(17,u=e)));const m=o;f(ze,l.cache=r,l),f(ze,l.probability=function(e){let t={probability:e};return et.probability(l,t),Math.random()<t.probability},l);let h,p,g,y=!0,v=1,b="null",k={},_=!1,x=!1,w=[],$=[],j=0,O=!1,T=!1;f(ze,l.data=o,l);const M={task:{role:{list:[],handle:e=>e.content(l,e.target),state:!1},enermy:{list:[],handle:e=>e.content(l,e.target),state:!1}},handle(){for(let e in this.task)this.task[e].list.length>0?this.task[e].state?1==this.task[e].list[0].time?this.task[e].handle(this.task[e].list.shift()):this.task[e].list[0].time--:(this.task[e].handle(this.task[e].list.shift()),this.task[e].state=!0):this.task[e].state=!1}},C={targetRole(e){return this.Type="role",this.Target=e,this},targetEnermy(e){return this.Type="enermy",this.Target=e,this},by(e,t){M.task[this.Type].list.push({content:e,target:this.Target,time:t||20})},listLengthOf:e=>M.task[e].list.length},A={use(){Ke[m.equipment].handle(l,this.Target),v--,et.useEquipment(l),n(13,E.equipment=A.explain(),E)},left:{get:e=>v,add(e){v+=e}},explain:e=>{let t;return t=m.equipment?Ke[m.equipment].passive?"这是被动装备。":`剩余可使用次数：${v}`:"还没有装备。",t},target(e){return this.Target=e,this},aim:e=>{if(Object.keys(k).length>0)return"aim"in Ke[l.data.equipment]},aimming(){if(m.equipment)if(v<1)msg({content:"次数用完了"});else if(y)if(Ke[m.equipment].passive)msg({content:"你这是被动装备"});else if("none"==p.style.cursor);else{let e=deepCopy(g.getBoundingClientRect());e.x=(e.left+e.right)/2,e.y=(e.top+e.bottom)/2,n(4,p.style.cursor="none",p);let t=t=>{n(7,_=!0),n(3,b="equipment");let a=l.enermy.checkForPosition(t),o={x:(t.x+e.x)/2,y:(t.y+e.y)/2},r=Math.atan((e.y-t.y)/(e.x-t.x));n(6,k.r=r/Math.PI*180-90,k),t.x>e.x&&n(6,k.r+=180,k),n(6,k.l=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))+60,k),n(6,k.x=o.x,k),n(6,k.y=o.y-k.l/2,k),n(6,k.aim="number"==typeof a,k)};n(4,p.onmousemove=t,p),setTimeout((e=>{n(4,p.onclick=()=>{l.enermy.equipmentAim(),n(4,p.onmousemove=null,p),n(4,p.onclick=null,p),n(4,p.style.cursor="unset",p),n(6,k={}),n(7,_=!1),n(3,b="null")},p)}))}else;else msg({content:"你还没有装备"})}},E={equipment:A.explain(),consumable:"使用携带的消耗品。",roundEnd:"没招了，轮到敌人了。",close:"不看了。",null:""},H={round_items:["round_punch_count","round_damage_frequency","round_expend_count","round_damage_total","round_max_damage","round_max_hurt","round_hurt_total","round_hurt_frequency","round_cost_total"],roundData:[],resetRoundData(){this.round_items.forEach((e=>f(ze,l.cache[e]=0,l)))},saveRoundData(){let e={};this.round_items.forEach((t=>e[t]=l.cache[t])),this.roundData.push(e)},countTotal(){let e={};return this.round_items.forEach((t=>{let n=t.split("_");n[0]="battle",e[n.join("_")]=this.roundData.map((e=>e[t])).sum()})),e.battle_max_damage=Math.max(...this.roundData.map((e=>e.round_max_damage))),e.battle_max_hurt=Math.max(...this.roundData.map((e=>e.round_max_hurt))),e}},q={round:{get:()=>y,set(e){n(1,y=e)}},winEvent:function(e){if(O)return;if(0==l.enermy.survival().length){O=!0,f(Ae,o.health=Math.ceil(l.role.state.get().Health),o),f(He,a.lv++,a),f(qe,r={},r);let e=a.enermy.filter(((e,t)=>a.target[t]));e.forEach((e=>{n(10,$=[...$,Wt[e].color])})),L({battle_defeat_total:e.length}),n(11,j=10*$.length*(4+$.length)),f(He,a.enermy=a.enermy.filter(((e,t)=>!a.target[t])),a);let t=!a.enermy.map((e=>Wt[e].type)).includes("boss");$.includes("red")&&t&&(l.event.stageClear(),1==l.data.stage&&n(12,T=!0)),a.target.set(!1),setTimeout((e=>{n(2,h="win")}),1200)}},deadEvent:function(e){if(O)return;O=!0,f(qe,r={},r),n(2,h="dead"),f(Ae,o.chance.amount--,o),o.chance.amount>=0&&(n(10,$=[...$,o.chance.type]),f(Ae,o.health=Xe.role[o.role].health,o));let t=a.enermy.filter(((e,t)=>a.target[t])),s=l.enermy.survival(),i=t.map(((e,t)=>t)).filter((e=>!s.includes(e)));f(He,a.enermy=a.enermy.filter(((e,t)=>!i.includes(t))),a);let c=t.filter(((e,t)=>!s.includes(t)));c.forEach((e=>{n(10,$=[...$,Wt[e].color])})),L({battle_defeat_total:c.length}),a.target.set(!1)},result:e=>h,effect:C,equipment:A,runOutAway:function(e){!0===e?msg({content:"逃跑成功"}):(l.enermy.state.of(e).set("health",-1),l.enermy.state.of(e).set("Health",-25565),msg({content:"有人逃跑了！"}));let t=l.enermy.state.getAll().map((e=>e.health)).filter((e=>e<0)).length;if(l.enermy.survival().length==t||!0===e){O=!0,n(2,h="none"),f(Ae,o.health=Math.ceil(l.role.state.get().Health),o),f(He,a.lv++,a),f(qe,r={},r);let e=a.enermy.filter(((e,t)=>a.target[t])),t=l.enermy.survival(),s=e.map(((e,t)=>t)).filter((e=>!t.includes(e)));f(He,a.enermy=a.enermy.filter(((e,t)=>!s.includes(t))),a),a.target.set(!1);let i=e.filter(((e,n)=>!t.includes(n)));i.forEach((e=>{n(10,$=[...$,Wt[e].color])})),n(11,j=10*$.length*(4+$.length)),L({battle_defeat_total:i.length})}}};function L(e){l.statistics.saveRoundData();const t=l.statistics.countTotal();t.battle_round_total=l.role.event.round.count,t.battle_defeat_total=e.battle_defeat_total,l.data.statistics.push(t)}f(ze,l.battle=q,l),f(ze,l.effect=C,l),f(ze,l.statistics=H,l),K((e=>{et.battleOnload(l),setTimeout((e=>l.role.event.round.start())),i.add("battleWorker",(e=>M.handle()),1),n(5,g.onmouseenter=e=>n(3,b="equipment"),g),n(5,g.onclick=q.equipment.aimming,g)})),N((e=>{n(13,E.equipment=A.explain(),E),l.role&&n(13,E.roundEnd=`现在是第${l.role.event.round.count}回合。`,E),w.forEach(((e,t)=>{e&&s(e).with(Fe[Object.keys(m.consumable)[t]])})),w.forEach(((e,t)=>{const l=Object.keys(m.consumable)[t];e&&(e.onmousedown=t=>{let a=e.className;e.className=`${e.className} using`;let o=setTimeout((e=>{msg({content:`使用了[${Fe[l].name}]`}),1==m.consumable[l]?delete m.consumable[l]:n(0,m.consumable[l]--,m),n(0,m),r()}),1200),r=t=>{clearTimeout(o),e.className=a};e.onmouseup=r,e.onmouseout=r})}))}));return[m,y,h,b,p,g,k,_,x,w,$,j,T,E,l,o,c,u,q,function(e){Y[e?"unshift":"push"]((()=>{g=e,n(5,g)}))},e=>n(3,b="consumable"),e=>{y&&n(8,x=!x)},e=>y&&l.role.event.round.end(),e=>n(3,b="roundEnd"),e=>n(3,b="close"),e=>{n(8,x=!1),n(7,_=!1)},function(e,t){Y[e?"unshift":"push"]((()=>{w[t]=e,n(9,w)}))},e=>{n(7,_=!0),n(3,b=x?"consumable":"null")},e=>{x?n(3,b="consumable"):(n(7,_=!1),n(3,b="null"))},(e,t,a)=>{l.event.getCollection(e),$.splice(t,1),n(10,$)},e=>{l.event.getEquipment(),n(12,T=!1)},e=>{l.event.getCoin(j),n(11,j=0)},e=>f(Te,u="Explore",u),e=>{f(Te,u="Epilog",u)},function(e){Y[e?"unshift":"push"]((()=>{p=e,n(4,p)}))}]}class La extends _e{constructor(e){super(),ke(this,e,qa,Ha,s,{},null,[-1,-1])}}var za={collection:{portable_money_box:"她经常要暴打妖怪，解决异变，人们很尊敬她。\n但那神社在人迹罕至的山里头。\n对了，随身带着赛钱箱不就好了。",bronze_mirror:"“这是我在竹林里捡到的镜子。”\n“应该叫毛玻璃？是半透明的。还很糊。”\n“但如果像这样对它发射一束光线。”\n“光线居然同时发生了穿透和反射！”\n“不过它的折射角度我就没法控制就是了。”",mimosa:"“老师快看呀，这棵含羞草只有三片叶子！”\n“碰一下试试？”\n叶子收拢了，相邻的那两片叶子靠在了一起。\n“那片叶子好孤独……”\n“但它坚持了该做的事。”",compass_cat:"“稀客啊。”\n“你居然还养了猫。”\n“你那不也有两只兔子。”\n“我总是觉得猫的眼睛……很像指南针。”\n“它在竹林里也不会迷路呢。”\n“那就给它起名叫罗盘猫吧。”\n“不要。”",bird_wine:"“我感觉到了，这节竹子里有东西。”\n“雀酒！”\n“也可能是青蛙？”\n“青蛙！”",frozen_frog:"敬请期待",fluorescent_zanthoxylum:"敬请期待",corvis_feathers:"“哇——哇——”\n“这乌鸦好烦。”\n一颗石子丢了过去，但树上只落下一根羽毛。\n“啊呀，乌鸦可是能预言凶兆，带来吉祥的哦。”\n“真不巧，我就是凶兆本人，连我妹妹都奈何不了我。”\n“这样啊，乌鸦的羽毛或许能抵消一些不幸，试试？”\n“嗯。”\n“噢，这根不行，这是我身上的。”",sundial:"“这是，日晷？”\n“在红雾之下的话，要用特别的方法才能知道时间。”\n“也就是说用不上了？说起来我家那片森林也见不到阳光呢。”\n“不行。”\n“那这个我也借走啦。”\n“老鼠。”",pickled_radish:"敬请期待",conch_shell:"“我在藏书的仓库里发现了这个。”\n“是海螺壳呢。”\n“幻想乡有海吗？”\n“月亮上，有的。”\n“我父亲居然上过月球。”\n“但那海里没有生命呢。”\n“难不成......”\n“嗯，是陶瓷的。”\n",cursed_wind_chimes:"“不是刮着风吗，这风铃怎么不会响。”\n“被诅咒了。或者成精了。”\n“也就是说，要做点驱魔仪式什么的吗？”\n“不，要是哪一天突然跑出来一个付丧神，我就不用自己打扫神社了。”\n“真懒呀。”\n“你家可比我这糟蹋多了。”\n“啰嗦。”",ghost_lantern:"敬请期待",vampires_old_tooth:"前端略尖的牙齿。\n“她小时候换牙换下来的旧牙，我一直收藏着。”\n“能感觉到残存的强大力量，或许能作为大魔法的媒介。”\n“真的？”\n“假的。”",large_roll_of_bandages:"“这、这个尺寸，你究竟是谁？”\n“裹胸用的绷带被某个仙人顺走了啦。”\n“呀，还有这种事。”\n“还有人顺走过扫帚呢。”\n“诶嘿嘿。”",burning_seashore_flower:"“又在这偷懒？”\n“这株彼岸花，由于强大的意念在燃烧着，燃不尽。”\n“要是会引起麻烦就早点退治掉好了。”\n“你不会懂的，正是这份意念传达不出去，才会如此强大。”\n“所以？”\n“请您也不要将我偷懒的事说出去！”",skyrocket:"“在偷拍吗！”\n“啊呀呀，吓我一跳。毕竟巫女难得要出门了嘛，你呢？”\n“我拿到了一个好玩的火箭烟花，来吓一吓她。”\n向着巫女，窜天猴“嗖——”地飞出去。\n飞进了神社的赛钱箱里。",magic_dart:"“这个是未完成品，可以用魔力进行导向的飞镖。”\n“听起来很有意思，便宜卖我呗。”\n“都说了是未完成——小心！”\n“呀，戳我屁股上了。”\n“没受伤吧？”\n“当然没有。”",fox_jade:"敬请期待",cherry:"敬请期待",earthy_spider_wine:"敬请期待",amulet_of_full_moon:"敬请期待",seal_needle:"“真巧啊。”\n“……嗯，很巧呢。”\n“我想委托你给封魔针加些新功能。”\n“然后呢？然后你就要用新的封魔针退治我了吗？”\n“当然不。”\n“真的？”\n“我的赛钱箱被炸了个洞，我先退治完你再去找你。”",crown_of_thorns:"敬请期待",red_and_white_scarf:"敬请期待",bottle_of_stars:"“天上的星星非常亮呢，地上的什么东西，经过了自我燃烧，也可以变成星星的吧。”\n“地上的星星，不装进瓶子里的话迟早会燃尽的。”\n“哈，那不如就放任它去绽放，哪怕只有一瞬间，或许会比天上的星星还亮哦。”",normal_stone:"敬请期待",blade_of_yellow_spring:"敬请期待",blood_book:"敬请期待",human_soul_lamp:"敬请期待",patchoulis_ribbon:"敬请期待",fish_stone:"敬请期待",crypto_cloak:"敬请期待",shy_rabbit:"敬请期待",dimensional_pocket:"敬请期待",terrible_ring:"敬请期待"},souvenir:{nodas_hat:"献给挚爱的「你」的「REALLUTION」",aokis_fish:"回首向来萧瑟处，归去，也无风雨也无晴。",ahabs_opinion:"爱丽丝的汗脚不应该甘之如饴吗？",mimicry_cat_pendant:"Great ideals but through selfless struggle and sacrifice to achieve.",wanderlust:"未经他人苦，勿劝他人善？你若经我苦，未必有我善！",cerallins_bottle:"Roses are red. I'm going to bed."},equipment:{gongonier:"敬请期待",sword_of_feixiang:"敬请期待",sunshade:"敬请期待",mirror_of_pear:"敬请期待",mini_bagua_stove:"敬请期待",louguanjian:"敬请期待",hd_camera:"敬请期待",repentance_rod:"敬请期待",circular_fan:"敬请期待",devil_tied_scroll:"敬请期待"},consumable:{doubtful_potion:"敬请期待",heart_fire_of_grace:"敬请期待",gift_from_ergen:"敬请期待",good_corn:"敬请期待",banana:"敬请期待"},buff:{}};function Sa(e,t,n){const l=e.slice();return l[33]=t[n],l[35]=n,l}function Ia(e,t,n){const l=e.slice();return l[36]=t[n],l[35]=n,l}function Ra(e,t,n){const l=e.slice();return l[38]=t[n],l[39]=t,l[35]=n,l}function Ba(e,t,n){const l=e.slice();return l[36]=t[n],l[40]=t,l[35]=n,l}function Pa(e,t,n){const l=e.slice();return l[36]=t[n],l[41]=t,l[35]=n,l}function Na(e,t,n){const l=e.slice();return l[36]=t[n],l[42]=t,l[35]=n,l}function Ka(e,t,n){const l=e.slice();return l[43]=t[n],l[44]=t,l[35]=n,l}function Da(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(Ne);const i=e=>e[35];for(let t=0;t<s.length;t+=1){let n=Ka(e,s,t),l=i(n);r.set(l,o[t]=Fa(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","collections container list svelte-1hd5mfv")},m(e,n){x(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);a=!0},p(e,n){10&n[0]&&(s=Object.keys(Ne),o=pe(o,n,i,1,e,s,r,t,me,Fa,null,Ka))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(e){e&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e&&l&&l.end()}}}function Fa(e,t){let n,l,a,o,r,s,i=t[35];function c(...e){return t[18](t[43],...e)}const d=()=>t[19](n,i),f=()=>t[19](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),a=T(),A(l,"class","icon-"+t[43]+" svelte-1hd5mfv"),A(n,"class",o=u(t[1]==t[43]&&"selected")+" svelte-1hd5mfv"),H(n,"background-color","var(--"+Ne[t[43]].type+")"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),d(),r||(s=C(n,"click",c),r=!0)},p(e,l){t=e,2&l[0]&&o!==(o=u(t[1]==t[43]&&"selected")+" svelte-1hd5mfv")&&A(n,"class",o),i!==t[35]&&(f(),i=t[35],d())},d(e){e&&w(n),f(),r=!1,s()}}}function Ya(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(De);const i=e=>e[35];for(let t=0;t<s.length;t+=1){let n=Na(e,s,t),l=i(n);r.set(l,o[t]=Xa(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","souvenirs container list svelte-1hd5mfv")},m(e,n){x(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);a=!0},p(e,n){34&n[0]&&(s=Object.keys(De),o=pe(o,n,i,1,e,s,r,t,me,Xa,null,Na))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(e){e&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e&&l&&l.end()}}}function Xa(e,t){let n,l,a,o,r,s,i=t[35];function c(...e){return t[20](t[36],...e)}const d=()=>t[21](n,i),f=()=>t[21](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),a=T(),A(l,"class","icon-"+t[36]+" svelte-1hd5mfv"),A(n,"class",o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv"),H(n,"background-color","var(--purple)"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),d(),r||(s=C(n,"click",c),r=!0)},p(e,l){t=e,2&l[0]&&o!==(o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv")&&A(n,"class",o),i!==t[35]&&(f(),i=t[35],d())},d(e){e&&w(n),f(),r=!1,s()}}}function Ga(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(Ke);const i=e=>e[35];for(let t=0;t<s.length;t+=1){let n=Pa(e,s,t),l=i(n);r.set(l,o[t]=Ja(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","equipments container list svelte-1hd5mfv")},m(e,n){x(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);a=!0},p(e,n){18&n[0]&&(s=Object.keys(Ke),o=pe(o,n,i,1,e,s,r,t,me,Ja,null,Pa))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(e){e&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e&&l&&l.end()}}}function Ja(e,t){let n,l,a,o,r,s,i=t[35];function c(...e){return t[22](t[36],...e)}const d=()=>t[23](n,i),f=()=>t[23](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),a=T(),A(l,"class","icon-"+t[36]+" svelte-1hd5mfv"),A(n,"class",o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv"),H(n,"background-color","var(--gold)"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),d(),r||(s=C(n,"click",c),r=!0)},p(e,l){t=e,2&l[0]&&o!==(o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv")&&A(n,"class",o),i!==t[35]&&(f(),i=t[35],d())},d(e){e&&w(n),f(),r=!1,s()}}}function Wa(e){let t,n,l,a,o=[],r=new Map,s=Object.keys(Fe);const i=e=>e[35];for(let t=0;t<s.length;t+=1){let n=Ba(e,s,t),l=i(n);r.set(l,o[t]=Za(l,n))}return{c(){t=j("div");for(let e=0;e<o.length;e+=1)o[e].c();A(t,"class","consumables container list svelte-1hd5mfv")},m(e,n){x(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);a=!0},p(e,n){66&n[0]&&(s=Object.keys(Fe),o=pe(o,n,i,1,e,s,r,t,me,Za,null,Ba))},i(e){a||(Z((()=>{a&&(l&&l.end(1),n=ue(t,we,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=fe(t,we,{duration:200}),a=!1},d(e){e&&w(t);for(let e=0;e<o.length;e+=1)o[e].d();e&&l&&l.end()}}}function Za(e,t){let n,l,a,o,r,s,i=t[35];function c(...e){return t[24](t[36],...e)}const d=()=>t[25](n,i),f=()=>t[25](null,i);return{key:e,first:null,c(){n=j("div"),l=j("icon"),a=T(),A(l,"class","icon-"+t[36]+" svelte-1hd5mfv"),A(n,"class",o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv"),H(n,"background-color","var(--blue)"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,a),d(),r||(s=C(n,"click",c),r=!0)},p(e,l){t=e,2&l[0]&&o!==(o=u(t[1]==t[36]&&"selected")+" svelte-1hd5mfv")&&A(n,"class",o),i!==t[35]&&(f(),i=t[35],d())},d(e){e&&w(n),f(),r=!1,s()}}}function Ua(e){let t,n,l,a,o,r,s,i,d,u,f,m,h,p,g,y,v,k,_,$,M,C,H,q,L,z,S,I,R,B,P,N,K,D,F,Y,X,G,J,W,U=[],Q=new Map,V=Ye[e[2]].name+"",ee=Xe.role[e[2]].health+"",te=Xe.role[e[2]].power+"",ne=Xe.role[e[2]].speed+"",le=Ye[e[2]].talent+"",ae=Object.keys(Qe).filter(e[27]).length+"",oe=[],de=new Map,ge=Object.keys(Ye);const ye=e=>e[35];for(let t=0;t<ge.length;t+=1){let n=Ra(e,ge,t),l=ye(n);Q.set(l,U[t]=Qa(l,n))}let ve=Object.keys(Qe).filter(e[28]);const be=e=>e[35];for(let t=0;t<ve.length;t+=1){let n=Ia(e,ve,t),l=be(n);de.set(l,oe[t]=Va(l,n))}return{c(){t=j("div"),n=j("div");for(let e=0;e<U.length;e+=1)U[e].c();l=T(),a=j("div"),o=j("div"),r=j("img"),i=T(),d=j("div"),u=O(V),f=T(),m=j("div"),h=j("txt"),p=O("生命上限: "),g=O(ee),y=T(),v=j("txt"),k=O("灵力上限: "),_=O(te),$=T(),M=j("txt"),C=O("基础速度: "),H=O(ne),q=T(),L=j("txt"),L.textContent="天赋",z=T(),S=j("div"),I=O(le),R=T(),B=j("div"),P=j("txt"),N=O("符卡 (38/"),K=O(ae),D=O(")"),F=T(),Y=j("div"),X=j("div");for(let e=0;e<oe.length;e+=1)oe[e].c();A(n,"class","role_list svelte-1hd5mfv"),c(r.src,s="/img/role/dairi/"+e[2]+".webp")||A(r,"src",s),A(r,"class","svelte-1hd5mfv"),A(o,"class","photo svelte-1hd5mfv"),A(d,"class","name svelte-1hd5mfv"),A(m,"class","state svelte-1hd5mfv"),A(L,"class","title svelte-1hd5mfv"),A(S,"class","talent svelte-1hd5mfv"),A(a,"class","left svelte-1hd5mfv"),A(P,"class","title svelte-1hd5mfv"),A(X,"class","svelte-1hd5mfv"),A(Y,"class","spellcard container svelte-1hd5mfv"),A(B,"class","right svelte-1hd5mfv"),A(t,"class","role svelte-1hd5mfv")},m(s,c){x(s,t,c),b(t,n);for(let e=0;e<U.length;e+=1)U[e]&&U[e].m(n,null);b(t,l),b(t,a),b(a,o),b(o,r),b(a,i),b(a,d),b(d,u),b(a,f),b(a,m),b(m,h),b(h,p),b(h,g),b(m,y),b(m,v),b(v,k),b(v,_),b(m,$),b(m,M),b(M,C),b(M,H),b(a,q),b(a,L),b(a,z),b(a,S),b(S,I),b(t,R),b(t,B),b(B,P),b(P,N),b(P,K),b(P,D),b(B,F),b(B,Y),b(Y,X);for(let e=0;e<oe.length;e+=1)oe[e]&&oe[e].m(X,null);e[29](Y),W=!0},p(e,t){640&t[0]&&(ge=Object.keys(Ye),U=pe(U,t,ye,1,e,ge,Q,n,me,Qa,null,Ra)),(!W||4&t[0]&&!c(r.src,s="/img/role/dairi/"+e[2]+".webp"))&&A(r,"src",s),(!W||4&t[0])&&V!==(V=Ye[e[2]].name+"")&&E(u,V),(!W||4&t[0])&&ee!==(ee=Xe.role[e[2]].health+"")&&E(g,ee),(!W||4&t[0])&&te!==(te=Xe.role[e[2]].power+"")&&E(_,te),(!W||4&t[0])&&ne!==(ne=Xe.role[e[2]].speed+"")&&E(H,ne),(!W||4&t[0])&&le!==(le=Ye[e[2]].talent+"")&&E(I,le),(!W||4&t[0])&&ae!==(ae=Object.keys(Qe).filter(e[27]).length+"")&&E(K,ae),4&t[0]&&(ve=Object.keys(Qe).filter(e[28]),re(),oe=pe(oe,t,be,1,e,ve,de,X,he,Va,null,Ia),se())},i(e){if(!W){for(let e=0;e<ve.length;e+=1)ie(oe[e]);Z((()=>{W&&(J&&J.end(1),G=ue(t,we,{duration:200}),G.start())})),W=!0}},o(e){for(let e=0;e<oe.length;e+=1)ce(oe[e]);G&&G.invalidate(),J=fe(t,we,{duration:200}),W=!1},d(n){n&&w(t);for(let e=0;e<U.length;e+=1)U[e].d();for(let e=0;e<oe.length;e+=1)oe[e].d();e[29](null),n&&J&&J.end()}}}function Qa(e,t){let n,l,a,o=t[35];const r=()=>t[26](n,o),s=()=>t[26](null,o);return{key:e,first:null,c(){n=j("img"),c(n.src,l="/img/role/dairi/"+t[38]+".webp")||A(n,"src",l),A(n,"class",a=u(!t[9].unlocked.role.includes(t[38])&&"locked")+" svelte-1hd5mfv"),this.first=n},m(e,t){x(e,n,t),r()},p(e,l){t=e,512&l[0]&&a!==(a=u(!t[9].unlocked.role.includes(t[38])&&"locked")+" svelte-1hd5mfv")&&A(n,"class",a),o!==t[35]&&(s(),o=t[35],r())},d(e){e&&w(n),s()}}}function Va(e,t){let n,l,a;return l=new at({props:{key:t[36]}}),{key:e,first:null,c(){n=M(),ge(l.$$.fragment),this.first=n},m(e,t){x(e,n,t),ye(l,e,t),a=!0},p(e,n){t=e;const a={};4&n[0]&&(a.key=t[36]),l.$set(a)},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l,e)}}}function eo(e){let t,n,l=[],a=new Map,o=Object.keys(Ve);const r=e=>e[35];for(let t=0;t<o.length;t+=1){let n=Sa(e,o,t),s=r(n);a.set(s,l[t]=to(s,n))}return{c(){t=j("div");for(let e=0;e<l.length;e+=1)l[e].c();A(t,"class","basecard container svelte-1hd5mfv")},m(a,o){x(a,t,o);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);e[30](t),n=!0},p(e,n){0&n&&(o=Object.keys(Ve),re(),l=pe(l,n,r,1,e,o,a,t,he,to,null,Sa),se())},i(e){if(!n){for(let e=0;e<o.length;e+=1)ie(l[e]);n=!0}},o(e){for(let e=0;e<l.length;e+=1)ce(l[e]);n=!1},d(n){n&&w(t);for(let e=0;e<l.length;e+=1)l[e].d();e[30](null)}}}function to(e,t){let n,l,a;return l=new at({props:{key:t[33],action:ao}}),{key:e,first:null,c(){n=j("div"),ge(l.$$.fragment),A(n,"class","svelte-1hd5mfv"),this.first=n},m(e,t){x(e,n,t),ye(l,n,null),a=!0},p(e,n){t=e},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l)}}}function no(e){let t,n,l,a,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_,$,M,C,H,q,L,z,S,I,R,B,P,N=e[10][e[0]][e[1]].name+"",K=e[10][e[0]][e[1]].detail+"",D=za[e[0]][e[1]]+"";return{c(){t=j("div"),n=j("div"),l=T(),a=j("div"),o=j("div"),o.innerHTML='<span class="svelte-1hd5mfv">11:39</span> \n            <span class="battery svelte-1hd5mfv"></span> \n            <span class="gsm svelte-1hd5mfv"><b class="signal1 svelte-1hd5mfv"></b> \n              <b class="signal2 svelte-1hd5mfv"></b> \n              <b class="signal3 svelte-1hd5mfv"></b> \n              <b class="signal4 svelte-1hd5mfv"></b></span>',r=T(),s=j("div"),i=j("div"),c=j("div"),d=j("icon"),f=T(),m=j("txt"),h=O(N),p=T(),g=j("txt"),y=O(K),v=T(),k=j("txt"),_=O(D),$=T(),M=j("div"),C=j("li"),H=j("a"),q=j("i"),q.textContent="<",L=T(),z=j("li"),z.innerHTML='<a class="svelte-1hd5mfv"><i class="icon home svelte-1hd5mfv"></i></a>',S=T(),I=j("li"),I.innerHTML='<a class="svelte-1hd5mfv"><i class="icon windows svelte-1hd5mfv"></i></a>',A(n,"class","speaker svelte-1hd5mfv"),A(o,"class","phone-infos svelte-1hd5mfv"),A(d,"class",u="icon-"+e[1]+" svelte-1hd5mfv"),A(m,"class","name svelte-1hd5mfv"),A(g,"class","effect svelte-1hd5mfv"),A(k,"class","story svelte-1hd5mfv"),A(c,"class","detail container svelte-1hd5mfv"),A(i,"class","tab phone current svelte-1hd5mfv"),A(s,"class","phone-tab-contents svelte-1hd5mfv"),A(q,"class","icon back svelte-1hd5mfv"),A(H,"class","svelte-1hd5mfv"),A(C,"class","svelte-1hd5mfv"),A(z,"class","svelte-1hd5mfv"),A(I,"class","svelte-1hd5mfv"),A(M,"class","main-btns svelte-1hd5mfv"),A(a,"class","screen svelte-1hd5mfv"),A(t,"class","nexus svelte-1hd5mfv")},m(u,w){x(u,t,w),b(t,n),b(t,l),b(t,a),b(a,o),b(a,r),b(a,s),b(s,i),b(i,c),b(c,d),b(c,f),b(c,m),b(m,h),b(c,p),b(c,g),b(g,y),b(c,v),b(c,k),b(k,_),e[31](c),b(a,$),b(a,M),b(M,C),b(C,H),b(H,q),b(M,L),b(M,z),b(M,S),b(M,I),P=!0},p(e,t){(!P||2&t[0]&&u!==(u="icon-"+e[1]+" svelte-1hd5mfv"))&&A(d,"class",u),(!P||3&t[0])&&N!==(N=e[10][e[0]][e[1]].name+"")&&E(h,N),(!P||3&t[0])&&K!==(K=e[10][e[0]][e[1]].detail+"")&&E(y,K),(!P||3&t[0])&&D!==(D=za[e[0]][e[1]]+"")&&E(_,D)},i(e){P||(Z((()=>{P&&(B&&B.end(1),R=ue(t,$e,{duration:200}),R.start())})),P=!0)},o(e){R&&R.invalidate(),B=fe(t,$e,{duration:200}),P=!1},d(n){n&&w(t),e[31](null),n&&B&&B.end()}}}function lo(e){let t,n,l,o,r,s,i,c,d,f,m,h,p,g,y,v,k,_,$,M,E,H,q,L,z,S,I,R,B,P,N,K,D,F,Y,X,G,J,W,U,Q="collection"==e[0]&&Da(e),V="souvenir"==e[0]&&Ya(e),ee="equipment"==e[0]&&Ga(e),te="consumable"==e[0]&&Wa(e),ne="role"==e[0]&&Ua(e),le="basecard"==e[0]&&eo(e),ae=e[1]&&no(e);return{c(){t=j("div"),n=j("div"),l=j("txt"),o=O("角色"),s=T(),i=j("txt"),c=O("收藏品"),f=T(),m=j("txt"),h=O("装备"),g=T(),y=j("txt"),v=O("纪念品"),_=T(),$=j("txt"),M=O("通式"),H=T(),q=j("txt"),L=O("消耗品"),S=T(),I=j("div"),Q&&Q.c(),R=T(),V&&V.c(),B=T(),ee&&ee.c(),P=T(),te&&te.c(),N=T(),ne&&ne.c(),K=T(),le&&le.c(),D=T(),ae&&ae.c(),F=T(),Y=j("div"),Y.textContent="右键回到标题界面",A(l,"class",r=u("role"==e[0]&&"selected")+" svelte-1hd5mfv"),A(i,"class",d=u("collection"==e[0]&&"selected")+" svelte-1hd5mfv"),A(m,"class",p=u("equipment"==e[0]&&"selected")+" svelte-1hd5mfv"),A(y,"class",k=u("souvenir"==e[0]&&"selected")+" svelte-1hd5mfv"),A($,"class",E=u("basecard"==e[0]&&"selected")+" svelte-1hd5mfv"),A(q,"class",z=u("consumable"==e[0]&&"selected")+" svelte-1hd5mfv"),A(n,"class","index svelte-1hd5mfv"),A(I,"class","main svelte-1hd5mfv"),A(Y,"class","remind svelte-1hd5mfv"),A(t,"class","body svelte-1hd5mfv")},m(a,r){x(a,t,r),b(t,n),b(n,l),b(l,o),b(n,s),b(n,i),b(i,c),b(n,f),b(n,m),b(m,h),b(n,g),b(n,y),b(y,v),b(n,_),b(n,$),b($,M),b(n,H),b(n,q),b(q,L),b(t,S),b(t,I),Q&&Q.m(I,null),b(I,R),V&&V.m(I,null),b(I,B),ee&&ee.m(I,null),b(I,P),te&&te.m(I,null),b(I,N),ne&&ne.m(I,null),b(I,K),le&&le.m(I,null),b(I,D),ae&&ae.m(I,null),b(t,F),b(t,Y),J=!0,W||(U=[C(l,"click",e[12]),C(i,"click",e[13]),C(m,"click",e[14]),C(y,"click",e[15]),C($,"click",e[16]),C(q,"click",e[17])],W=!0)},p(e,t){(!J||1&t[0]&&r!==(r=u("role"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A(l,"class",r),(!J||1&t[0]&&d!==(d=u("collection"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A(i,"class",d),(!J||1&t[0]&&p!==(p=u("equipment"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A(m,"class",p),(!J||1&t[0]&&k!==(k=u("souvenir"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A(y,"class",k),(!J||1&t[0]&&E!==(E=u("basecard"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A($,"class",E),(!J||1&t[0]&&z!==(z=u("consumable"==e[0]&&"selected")+" svelte-1hd5mfv"))&&A(q,"class",z),"collection"==e[0]?Q?(Q.p(e,t),1&t[0]&&ie(Q,1)):(Q=Da(e),Q.c(),ie(Q,1),Q.m(I,R)):Q&&(re(),ce(Q,1,1,(()=>{Q=null})),se()),"souvenir"==e[0]?V?(V.p(e,t),1&t[0]&&ie(V,1)):(V=Ya(e),V.c(),ie(V,1),V.m(I,B)):V&&(re(),ce(V,1,1,(()=>{V=null})),se()),"equipment"==e[0]?ee?(ee.p(e,t),1&t[0]&&ie(ee,1)):(ee=Ga(e),ee.c(),ie(ee,1),ee.m(I,P)):ee&&(re(),ce(ee,1,1,(()=>{ee=null})),se()),"consumable"==e[0]?te?(te.p(e,t),1&t[0]&&ie(te,1)):(te=Wa(e),te.c(),ie(te,1),te.m(I,N)):te&&(re(),ce(te,1,1,(()=>{te=null})),se()),"role"==e[0]?ne?(ne.p(e,t),1&t[0]&&ie(ne,1)):(ne=Ua(e),ne.c(),ie(ne,1),ne.m(I,K)):ne&&(re(),ce(ne,1,1,(()=>{ne=null})),se()),"basecard"==e[0]?le?(le.p(e,t),1&t[0]&&ie(le,1)):(le=eo(e),le.c(),ie(le,1),le.m(I,D)):le&&(re(),ce(le,1,1,(()=>{le=null})),se()),e[1]?ae?(ae.p(e,t),2&t[0]&&ie(ae,1)):(ae=no(e),ae.c(),ie(ae,1),ae.m(I,null)):ae&&(re(),ce(ae,1,1,(()=>{ae=null})),se())},i(e){J||(ie(Q),ie(V),ie(ee),ie(te),ie(ne),ie(le),ie(ae),Z((()=>{J&&(G&&G.end(1),X=ue(t,we,{duration:250}),X.start())})),J=!0)},o(e){ce(Q),ce(V),ce(ee),ce(te),ce(ne),ce(le),ce(ae),X&&X.invalidate(),G=fe(t,we,{duration:250}),J=!1},d(e){e&&w(t),Q&&Q.d(),V&&V.d(),ee&&ee.d(),te&&te.d(),ne&&ne.d(),le&&le.d(),ae&&ae.d(),e&&G&&G.end(),W=!1,a(U)}}}const ao=e=>null;function oo(e,t,n){let l,a;d(e,Ce,(e=>n(9,l=e))),d(e,Me,(e=>n(32,a=e)));let o="role",r=null,s=l.unlocked.role[0];const i={buff:tn,collection:Ne,equipment:Ke,souvenir:De,spellcard:Qe,role:Ye,consumable:Fe,basecard:Ve},c=[],u=[],f=[],m=[],h=[],p={};function g(e){n(1,r=null),n(0,o=e)}N((e=>{c.forEach(((e,t)=>{let n=Object.keys(Ne)[t];a(e).color(Ne[n].type).with(Ne[n])})),u.forEach(((e,t)=>{let n=Object.keys(Ke)[t];a(e).color("gold").with(Ke[n])})),f.forEach(((e,t)=>{let n=Object.keys(De)[t];a(e).color("purple").with(De[n])})),m.forEach(((e,t)=>{let n=Object.keys(tn)[t];a(e).with(tn[n])})),h.forEach(((e,t)=>{let o=Object.keys(Ye)[t],r=deepCopy(Ye[o]);l.unlocked.role.includes(o)||(r.detail=`解锁条件：${r.unlock}`),a(e).with(r),e&&(e.onclick=e=>{l.unlocked.role.includes(o)&&n(2,s=o)})}))})),D((e=>{for(let e in p)p[e]&&n(8,p[e].ontouchstart=function(t){let l=t.touches[0].pageX,a=p[e].scrollTop;n(8,p[e].ontouchmove=function(t){let o=t.touches[0].pageX;n(8,p[e].scrollTop=a+o-l,p)},p)},p)}));return[o,r,s,c,u,f,m,h,p,l,i,g,e=>g("role"),e=>g("collection"),e=>g("equipment"),e=>g("souvenir"),e=>g("basecard"),e=>g("consumable"),(e,t)=>n(1,r=e),function(e,t){Y[e?"unshift":"push"]((()=>{c[t]=e,n(3,c)}))},(e,t)=>n(1,r=e),function(e,t){Y[e?"unshift":"push"]((()=>{f[t]=e,n(5,f)}))},(e,t)=>n(1,r=e),function(e,t){Y[e?"unshift":"push"]((()=>{u[t]=e,n(4,u)}))},(e,t)=>n(1,r=e),function(e,t){Y[e?"unshift":"push"]((()=>{m[t]=e,n(6,m)}))},function(e,t){Y[e?"unshift":"push"]((()=>{h[t]=e,n(7,h)}))},e=>Qe[e].role==s,e=>Qe[e].role==s,function(e){Y[e?"unshift":"push"]((()=>{p.spellcard=e,n(8,p)}))},function(e){Y[e?"unshift":"push"]((()=>{p.basecard=e,n(8,p)}))},function(e){Y[e?"unshift":"push"]((()=>{p.detail=e,n(8,p)}))}]}class ro extends _e{constructor(e){super(),ke(this,e,oo,lo,s,{},null,[-1,-1])}}function so(e,t,n){const l=e.slice();return l[32]=t[n],l[33]=t,l[34]=n,l}function io(e){let t,n,l,o,r,s,i,c,d,u,f,m,h=[],p=new Map,g=e[4];const y=e=>e[34];for(let t=0;t<g.length;t+=1){let n=so(e,g,t),l=y(n);p.set(l,h[t]=fo(l,n))}function v(e,t){return e[5]>0?ho:mo}let k=v(e),_=k(e);return{c(){t=j("div"),n=j("div");for(let e=0;e<h.length;e+=1)h[e].c();l=T(),o=j("div"),r=j("div"),r.textContent="确定",s=T(),i=j("div"),_.c(),A(n,"class","selections container svelte-1f4objy"),A(r,"class","btn svelte-1f4objy"),A(i,"class","btn svelte-1f4objy"),A(o,"class","btns svelte-1f4objy"),A(t,"class","body svelte-1f4objy")},m(a,c){x(a,t,c),b(t,n);for(let e=0;e<h.length;e+=1)h[e]&&h[e].m(n,null);e[12](n),b(t,l),b(t,o),b(o,r),b(o,s),b(o,i),_.m(i,null),u=!0,f||(m=[C(r,"click",e[9]),C(i,"click",e[10])],f=!0)},p(e,t){219&t[0]&&(g=e[4],re(),h=pe(h,t,y,1,e,g,p,n,he,fo,null,so),se()),k===(k=v(e))&&_?_.p(e,t):(_.d(1),_=k(e),_&&(_.c(),_.m(i,null)))},i(e){if(!u){for(let e=0;e<g.length;e+=1)ie(h[e]);Z((()=>{u&&(d&&d.end(1),c=ue(t,we,{duration:250}),c.start())})),u=!0}},o(e){for(let e=0;e<h.length;e+=1)ce(h[e]);c&&c.invalidate(),d=fe(t,we,{duration:250}),u=!1},d(n){n&&w(t);for(let e=0;e<h.length;e+=1)h[e].d();e[12](null),_.d(),n&&d&&d.end(),f=!1,a(m)}}}function co(e){let t,n;return t=new at({props:{key:e[32]}}),{c(){ge(t.$$.fragment)},m(e,l){ye(t,e,l),n=!0},p(e,n){const l={};16&n[0]&&(l.key=e[32]),t.$set(l)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){ce(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function uo(e){let t,n,l,a,o,r,s,i,c,d=e[6][e[0]][e[32]].name+"";return{c(){t=j("div"),n=j("icon"),a=T(),o=j("txt"),r=O(d),A(n,"class",l="icon-"+e[32]+" svelte-1f4objy"),A(o,"class","svelte-1f4objy"),A(t,"class","item svelte-1f4objy"),H(t,"background-color","var(--"+("collection"==e[0]?e[6][e[0]][e[32]].type:e[1])+")")},m(e,l){x(e,t,l),b(t,n),b(t,a),b(t,o),b(o,r),c=!0},p(e,a){(!c||16&a[0]&&l!==(l="icon-"+e[32]+" svelte-1f4objy"))&&A(n,"class",l),(!c||81&a[0])&&d!==(d=e[6][e[0]][e[32]].name+"")&&E(r,d),(!c||83&a[0])&&H(t,"background-color","var(--"+("collection"==e[0]?e[6][e[0]][e[32]].type:e[1])+")")},i(e){c||(Z((()=>{c&&(i&&i.end(1),s=ue(t,$e,{duration:250}),s.start())})),c=!0)},o(e){s&&s.invalidate(),i=fe(t,$e,{duration:250}),c=!1},d(e){e&&w(t),e&&i&&i.end()}}}function fo(e,t){let n,l,a,o,r,s,i=t[34];const c=[uo,co],d=[];function u(e,t){return"spellcard"!=e[0]&&"basecard"!=e[0]&&"forget"!=e[0]&&"card"!=e[0]?0:1}l=u(t),a=d[l]=c[l](t);const f=()=>t[11](n,i),m=()=>t[11](null,i);return{key:e,first:null,c(){n=j("div"),a.c(),o=T(),A(n,"class",r="box "+t[0]+" "+(t[3]==t[34]&&"selected")+" svelte-1f4objy"),this.first=n},m(e,t){x(e,n,t),d[l].m(n,null),b(n,o),f(),s=!0},p(e,h){let p=l;l=u(t=e),l===p?d[l].p(t,h):(re(),ce(d[p],1,1,(()=>{d[p]=null})),se(),a=d[l],a?a.p(t,h):(a=d[l]=c[l](t),a.c()),ie(a,1),a.m(n,o)),(!s||25&h[0]&&r!==(r="box "+t[0]+" "+(t[3]==t[34]&&"selected")+" svelte-1f4objy"))&&A(n,"class",r),i!==t[34]&&(m(),i=t[34],f())},i(e){s||(ie(a),s=!0)},o(e){ce(a),s=!1},d(e){e&&w(n),d[l].d(),m()}}}function mo(t){let n;return{c(){n=O("跳过")},m(e,t){x(e,n,t)},p:e,d(e){e&&w(n)}}}function ho(e){let t,n,l;return{c(){t=O("跳过并获得"),n=O(e[5]),l=j("icon"),A(l,"class","icon-coin svelte-1f4objy")},m(e,a){x(e,t,a),x(e,n,a),x(e,l,a)},p(e,t){32&t[0]&&E(n,e[5])},d(e){e&&w(t),e&&w(n),e&&w(l)}}}function po(e){let t,n,l=e[2]&&io(e);return{c(){l&&l.c(),t=M()},m(e,a){l&&l.m(e,a),x(e,t,a),n=!0},p(e,n){e[2]?l?(l.p(e,n),4&n[0]&&ie(l,1)):(l=io(e),l.c(),ie(l,1),l.m(t.parentNode,t)):l&&(re(),ce(l,1,1,(()=>{l=null})),se())},i(e){n||(ie(l),n=!0)},o(e){ce(l),n=!1},d(e){l&&l.d(e),e&&w(t)}}}function go(e,t,n){let l,a;d(e,ze,(e=>n(15,l=e))),d(e,Me,(e=>n(16,a=e)));let o,r,s="collection",i="blue",c=!1,u=[],m=100,h={},p={};const g=[];let y;N((function(){g.forEach(((e,t)=>{if(e&&u[t]){e.onclick=e=>n(3,o=o==t?null:t);let l="collection"==s?p.collection[u[t]].type:i;"forget"!=s&&a(e).color(l).with(p[s][u[t]])}}))})),D((e=>{y&&n(8,y.ontouchstart=function(e){let t=e.touches[0].pageX,l=y.scrollTop;n(8,y.ontouchmove=function(e){let a=e.touches[0].pageX;n(8,y.scrollTop=l+a-t,y)},y)},y)})),f(ze,l.event.getCollection=function(e,t){b(),n(0,s="collection"),n(4,u=Object.keys(p.collection).filter((t=>p.collection[t].type==e)).rd()),t||n(4,u=u.splice(0,l.data.sugar));n(2,c=!0),"blue"==e&&n(5,m=100);"green"==e&&n(5,m=300);"red"==e&&n(5,m=750)},l),f(ze,l.event.getEquipment=function(e){b(),n(0,s="equipment"),n(1,i="gold"),n(4,u=Object.keys(p.equipment).rd().splice(0,l.data.sugar)),n(2,c=!0),n(5,m=250)},l),f(ze,l.event.getSouvenir=function(e){b(),n(0,s="souvenir"),n(1,i="purple"),n(4,u=Object.keys(p.souvenir).rd().splice(0,l.data.sugar)),n(2,c=!0),n(5,m=200)},l),f(ze,l.event.getSpellcard=function(e){b(),n(0,s="spellcard"),n(4,u=Object.keys(p.spellcard).filter((e=>p.spellcard[e].role==l.data.role)).rd().splice(0,e?15:l.data.sugar)),n(2,c=!0),n(5,m=250)},l),f(ze,l.event.getBasecard=function(e){b(),n(0,s="basecard"),n(4,u=Object.keys(p.basecard).rd().splice(0,l.data.sugar)),n(2,c=!0),n(5,m=200)},l),f(ze,l.event.heal=function(e,t){let n,a=Xe.role[l.data.role].health,o=l.data.health;n=t?Math.min(a-o,a*e/100):Math.min(a-o,e);f(ze,l.data.health+=n,l)},l),f(ze,l.event.loseHealth=function(e,t){let n=Xe.role[l.data.role].health,a=l.data.health,o=e;t&&(o=n*e/100);return!(o>a)&&(f(ze,l.data.health-=o,l),!0)},l),f(ze,l.event.forgetCard=function(e){n(0,s="forget"),n(4,u=Object.unCount(l.data.card)),n(2,c=!0),n(5,m=0)},l),f(ze,l.event.copy=function(e){b(),n(0,s=e),n(4,u=Object.keys(l.data[s])),n(2,c=!0),n(5,m=100)},l),f(ze,l.event.change=function(e){b(),n(0,s=e),r="change",n(4,u=Object.keys(l.data[s])),n(2,c=!0),n(5,m=20)},l),f(ze,l.event.sellCollection=function(e){n(0,s="collection"),r="sellCollection",h.sellCollection=e,n(4,u=Object.keys(l.data.collection).filter((t=>!e.includes(t)))),n(2,c=!0),n(5,m=0)},l),f(ze,l.event.getCoin=function(e){f(ze,l.data.coin+=e,l),msg({content:`获得${e}硬币`}),f(ze,l.data.coin_reward_total+=e,l)},l);const v={change(){let e;if(u[o].decreaseOf(l.data[s]),"card"==s&&(e=p.keys().card.filter((e=>["base",l.data.role].includes(p.card[e].role))).rd()[0]),"collection"==s){let t=p.collection[u[o]].type;Math.random()>.7&&(t={blue:"green",green:Math.random()>.5?"red":"blue",red:"green"}[t]),e=p.keys().collection.filter((e=>ln.collection[e].type==t)),e=e.rd()[0]}e.increaseOf(l.data[s]),msg({content:`获得[${p[s][e].name}]`})},sellCollection(){u[o].decreaseOf(l.data.collection),h.sellCollection.push(u[o]);let e={blue:100,green:300,red:750}[p.collection[u[o]].type];l.event.getCoin(e)}};function b(){let e=deepCopy(ln);for(let t in e)for(let n in e[t])l.data.blackList.includes(n)&&delete e[t][n];n(6,p=e)}function k(){n(2,c=!1),n(1,i=null),n(3,o=null),n(4,u=[]),r=null}return[s,i,c,o,u,m,p,g,y,function(){let e=s;if(null!=o){if("forget"==s){let e={};Object.assign(e,p.spellcard),Object.assign(e,p.basecard),msg({content:`忘却[${e[u[o]].name}]`}),u[o].decreaseOf(l.data.card)}else r?v[r]():(msg({content:`获得[${p[s][u[o]].name}]`}),"equipment"!=s&&"souvenir"!=s?("spellcard"!=s&&"basecard"!=s||(e="card"),u[o].increaseOf(l.data[e])):f(ze,l.data[s]=u[o],l));k()}else msg({content:"请选择一个"})},function(){0!=m&&l.event.getCoin(m),k()},function(e,t){Y[e?"unshift":"push"]((()=>{g[t]=e,n(7,g)}))},function(e){Y[e?"unshift":"push"]((()=>{y=e,n(8,y)}))}]}class yo extends _e{constructor(e){super(),ke(this,e,go,po,s,{},null,[-1,-1])}}function vo(e,t,n){const l=e.slice();return l[10]=t[n],l[12]=n,l}function bo(e,t){let n,l,a,o,r,s,i,c=t[3][t[10]]+"",d=window.retain(t[2][t[10]],0)+"";return{key:e,first:null,c(){n=j("div"),l=j("txt"),a=O(c),o=T(),r=j("txt"),s=O(d),i=T(),A(n,"class","svelte-rav0lz"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,a),b(n,o),b(n,r),b(r,s),b(n,i)},p(e,n){t=e},d(e){e&&w(n)}}}function ko(e){let t,n,l,a,o,r,s,i,d,u,f,m,h,p,g,y,v,k=e[0].data.chance.amount<0?"惨败":"通关",_=[],$=new Map,M=Object.keys(e[3]);const H=e=>e[12];for(let t=0;t<M.length;t+=1){let n=vo(e,M,t),l=H(n);$.set(l,_[t]=bo(l,n))}return{c(){t=j("div"),n=j("div"),l=j("txt"),a=O(k),o=T(),r=j("img"),i=T(),d=j("div"),u=j("div");for(let e=0;e<_.length;e+=1)_[e].c();f=T(),m=j("div"),m.textContent="回到标题界面",A(l,"class","title svelte-rav0lz"),c(r.src,s="/img/role/"+e[1].resource+"/"+(e[0].data.chance.amount<0?"dead":"win")+"/"+e[0].data.role+".webp")||A(r,"src",s),A(r,"class","svelte-rav0lz"),A(n,"class","left svelte-rav0lz"),A(u,"class","statistics svelte-rav0lz"),A(m,"class","btn svelte-rav0lz"),A(d,"class","right svelte-rav0lz"),A(t,"class","body epilog svelte-rav0lz")},m(s,c){x(s,t,c),b(t,n),b(n,l),b(l,a),b(n,o),b(n,r),b(t,i),b(t,d),b(d,u);for(let e=0;e<_.length;e+=1)_[e]&&_[e].m(u,null);b(d,f),b(d,m),g=!0,y||(v=C(m,"click",e[4]),y=!0)},p(e,[t]){(!g||1&t)&&k!==(k=e[0].data.chance.amount<0?"惨败":"通关")&&E(a,k),(!g||3&t&&!c(r.src,s="/img/role/"+e[1].resource+"/"+(e[0].data.chance.amount<0?"dead":"win")+"/"+e[0].data.role+".webp"))&&A(r,"src",s),12&t&&(M=Object.keys(e[3]),_=pe(_,t,H,1,e,M,$,u,me,bo,null,vo))},i(e){g||(Z((()=>{g&&(p&&p.end(1),h=ue(t,we,{duration:250}),h.start())})),g=!0)},o(e){h&&h.invalidate(),p=fe(t,we,{duration:250}),g=!1},d(e){e&&w(t);for(let e=0;e<_.length;e+=1)_[e].d();e&&p&&p.end(),y=!1,v()}}}function _o(e,t,n){let l,a,o,r,s;d(e,Ce,(e=>n(5,l=e))),d(e,ze,(e=>n(0,a=e))),d(e,Te,(e=>n(6,o=e))),d(e,He,(e=>n(7,r=e))),d(e,Ee,(e=>n(1,s=e)));const i=function(){let e=a.data.statistics;a.data.chance.amount<0&&e.pop();let t={};for(let n in e[0]){let l=n.split("_");l.shift(),t[l.join("_")]=e.map((e=>e[n])).sum()}return t.max_damage=Math.max(...e.map((e=>e.battle_max_damage))),t.max_hurt=Math.max(...e.map((e=>e.battle_max_hurt))),t.coin_reward_total=a.data.coin_reward_total,t.battle_count=e.length,t.max_lv=r.lv,t.collection_reward_total=Object.unCount(a.data.collection).length,function(e){let t={battle_data:e,player_data:deepCopy(a.data),time:(n=new Date,n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+" "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()),id:retain(1e5*Math.random(),0),color:["red","green","blue","purple","gold","orange","pink"].rd()[0]};var n;t.name=`${a.data.chance.amount<0?"惨败":"通关"}档案-${t.id}`,l.record.push(t),localStorage.setItem("archive",JSON.stringify(l))}(t),t}();return[a,s,i,{damage_total:"造成伤害总量",damage_frequency:"造成伤害总次数",max_damage:"造成的最高伤害",hurt_total:"受到伤害总量",hurt_frequency:"受到伤害总次数",max_hurt:"受到的最高伤害",cost_total:"消耗灵力总数",punch_count:"打出手牌总数",battle_count:"战斗总次数",round_total:"回合总数",defeat_total:"击败敌人总数",max_lv:"敌人最高等级",coin_reward_total:"获得硬币总数",collection_reward_total:"获得收藏品总数"},function(){f(He,r={},r),localStorage.removeItem("explore"),f(Te,o="Index",o)}]}class xo extends _e{constructor(e){super(),ke(this,e,_o,ko,s,{})}}function wo(e,t,n){const l=e.slice();return l[20]=t[n],l[22]=n,l}function $o(e,t,n){const l=e.slice();return l[23]=t[n],l[24]=t,l[22]=n,l}function jo(e,t,n){const l=e.slice();return l[23]=t[n],l[22]=n,l}function Oo(e,t,n){const l=e.slice();return l[26]=t[n],l[22]=n,l}function To(e){let t,n,l,o,r,s,i,c,d,f,m,h,p,g,y,v,k,_,$,M,H,q,L,z,S,I,R,B=e[5].record[e[1]].name+"",P=e[5].record[e[1]].player_data.sugar+"",N="statistics"==e[2]&&Mo(e),K="card"==e[2]&&Ao(e),D="item"==e[2]&&Ho(e);return{c(){t=j("div"),n=j("txt"),l=O(B),o=T(),r=j("span"),s=O(" 选项个数: "),i=O(P),c=T(),d=j("div"),f=j("div"),m=j("txt"),h=O("统计"),g=T(),y=j("txt"),v=O("牌库"),_=T(),$=j("txt"),M=O("物品"),q=T(),N&&N.c(),L=T(),K&&K.c(),z=T(),D&&D.c(),A(r,"class","svelte-15aej55"),A(t,"class","title svelte-15aej55"),A(m,"class",p=u("statistics"==e[2]&&"selected")+" svelte-15aej55"),A(y,"class",k=u("card"==e[2]&&"selected")+" svelte-15aej55"),A($,"class",H=u("item"==e[2]&&"selected")+" svelte-15aej55"),A(f,"class","record_index svelte-15aej55"),A(d,"class","record_body svelte-15aej55")},m(a,u){x(a,t,u),b(t,n),b(n,l),b(t,o),b(t,r),b(r,s),b(r,i),x(a,c,u),x(a,d,u),b(d,f),b(f,m),b(m,h),b(f,g),b(f,y),b(y,v),b(f,_),b(f,$),b($,M),b(d,q),N&&N.m(d,null),b(d,L),K&&K.m(d,null),b(d,z),D&&D.m(d,null),S=!0,I||(R=[C(m,"click",e[10]),C(y,"click",e[11]),C($,"click",e[12])],I=!0)},p(e,t){(!S||34&t)&&B!==(B=e[5].record[e[1]].name+"")&&E(l,B),(!S||34&t)&&P!==(P=e[5].record[e[1]].player_data.sugar+"")&&E(i,P),(!S||4&t&&p!==(p=u("statistics"==e[2]&&"selected")+" svelte-15aej55"))&&A(m,"class",p),(!S||4&t&&k!==(k=u("card"==e[2]&&"selected")+" svelte-15aej55"))&&A(y,"class",k),(!S||4&t&&H!==(H=u("item"==e[2]&&"selected")+" svelte-15aej55"))&&A($,"class",H),"statistics"==e[2]?N?N.p(e,t):(N=Mo(e),N.c(),N.m(d,L)):N&&(N.d(1),N=null),"card"==e[2]?K?(K.p(e,t),4&t&&ie(K,1)):(K=Ao(e),K.c(),ie(K,1),K.m(d,z)):K&&(re(),ce(K,1,1,(()=>{K=null})),se()),"item"==e[2]?D?D.p(e,t):(D=Ho(e),D.c(),D.m(d,null)):D&&(D.d(1),D=null)},i(e){S||(ie(K),S=!0)},o(e){ce(K),S=!1},d(e){e&&w(t),e&&w(c),e&&w(d),N&&N.d(),K&&K.d(),D&&D.d(),I=!1,a(R)}}}function Mo(e){let t,n=[],l=new Map,a=Object.keys(e[6]);const o=e=>e[22];for(let t=0;t<a.length;t+=1){let r=Oo(e,a,t),s=o(r);l.set(s,n[t]=Co(s,r))}return{c(){t=j("div");for(let e=0;e<n.length;e+=1)n[e].c();A(t,"class","statistics svelte-15aej55")},m(e,l){x(e,t,l);for(let e=0;e<n.length;e+=1)n[e]&&n[e].m(t,null)},p(e,r){98&r&&(a=Object.keys(e[6]),n=pe(n,r,o,1,e,a,l,t,me,Co,null,Oo))},d(e){e&&w(t);for(let e=0;e<n.length;e+=1)n[e].d()}}}function Co(e,t){let n,l,a,o,r,s,i,c=t[6][t[26]]+"",d=window.retain(t[5].record[t[1]].battle_data[t[26]],0)+"";return{key:e,first:null,c(){n=j("div"),l=j("txt"),a=O(c),o=T(),r=j("txt"),s=O(d),i=T(),A(n,"class","svelte-15aej55"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(l,a),b(n,o),b(n,r),b(r,s),b(n,i)},p(e,n){t=e,34&n&&d!==(d=window.retain(t[5].record[t[1]].battle_data[t[26]],0)+"")&&E(s,d)},d(e){e&&w(n)}}}function Ao(e){let t,n,l=[],a=new Map,o=Object.unCount(e[5].record[e[1]].player_data.card);const r=e=>e[22];for(let t=0;t<o.length;t+=1){let n=jo(e,o,t),s=r(n);a.set(s,l[t]=Eo(s,n))}return{c(){t=j("div");for(let e=0;e<l.length;e+=1)l[e].c();A(t,"class","card container svelte-15aej55")},m(a,o){x(a,t,o);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);e[13](t),n=!0},p(e,n){34&n&&(o=Object.unCount(e[5].record[e[1]].player_data.card),re(),l=pe(l,n,r,1,e,o,a,t,he,Eo,null,jo),se())},i(e){if(!n){for(let e=0;e<o.length;e+=1)ie(l[e]);n=!0}},o(e){for(let e=0;e<l.length;e+=1)ce(l[e]);n=!1},d(n){n&&w(t);for(let e=0;e<l.length;e+=1)l[e].d();e[13](null)}}}function Eo(e,t){let n,l,a;return l=new at({props:{key:t[23]}}),{key:e,first:null,c(){n=M(),ge(l.$$.fragment),this.first=n},m(e,t){x(e,n,t),ye(l,e,t),a=!0},p(e,n){t=e;const a={};34&n&&(a.key=t[23]),l.$set(a)},i(e){a||(ie(l.$$.fragment,e),a=!0)},o(e){ce(l.$$.fragment,e),a=!1},d(e){e&&w(n),ve(l,e)}}}function Ho(e){let t,n,l,a=[],o=new Map,r=Object.keys(e[5].record[e[1]].player_data.collection);const s=e=>e[22];for(let t=0;t<r.length;t+=1){let n=$o(e,r,t),l=s(n);o.set(l,a[t]=Lo(l,n))}let i=e[5].record[e[1]].player_data.equipment&&zo(e),c=e[5].record[e[1]].player_data.souvenir&&So(e);return{c(){t=j("div");for(let e=0;e<a.length;e+=1)a[e].c();n=T(),i&&i.c(),l=T(),c&&c.c(),A(t,"class","item container svelte-15aej55")},m(o,r){x(o,t,r);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,null);b(t,n),i&&i.m(t,null),b(t,l),c&&c.m(t,null),e[17](t)},p(e,d){170&d&&(r=Object.keys(e[5].record[e[1]].player_data.collection),a=pe(a,d,s,1,e,r,o,t,me,Lo,n,$o)),e[5].record[e[1]].player_data.equipment?i?i.p(e,d):(i=zo(e),i.c(),i.m(t,l)):i&&(i.d(1),i=null),e[5].record[e[1]].player_data.souvenir?c?c.p(e,d):(c=So(e),c.c(),c.m(t,null)):c&&(c.d(1),c=null)},d(n){n&&w(t);for(let e=0;e<a.length;e+=1)a[e].d();i&&i.d(),c&&c.d(),e[17](null)}}}function qo(e){let t,n,l=e[5].record[e[1]].player_data.collection[e[23]]+"";return{c(){t=j("txt"),n=O(l),A(t,"class","svelte-15aej55")},m(e,l){x(e,t,l),b(t,n)},p(e,t){34&t&&l!==(l=e[5].record[e[1]].player_data.collection[e[23]]+"")&&E(n,l)},d(e){e&&w(t)}}}function Lo(e,t){let n,l,a,o,r=t[22],s=t[5].record[t[1]].player_data.collection[t[23]]>1&&qo(t);const i=()=>t[14](n,r),c=()=>t[14](null,r);return{key:e,first:null,c(){n=j("div"),l=j("icon"),o=T(),s&&s.c(),A(l,"class",a="icon-"+t[23]+" svelte-15aej55"),H(n,"background-color","var(--"+t[7][t[23]].type+")"),A(n,"class","svelte-15aej55"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),s&&s.m(n,null),i()},p(e,o){t=e,34&o&&a!==(a="icon-"+t[23]+" svelte-15aej55")&&A(l,"class",a),t[5].record[t[1]].player_data.collection[t[23]]>1?s?s.p(t,o):(s=qo(t),s.c(),s.m(n,null)):s&&(s.d(1),s=null),34&o&&H(n,"background-color","var(--"+t[7][t[23]].type+")"),r!==t[22]&&(c(),r=t[22],i())},d(e){e&&w(n),s&&s.d(),c()}}}function zo(e){let t,n,l;return{c(){t=j("div"),n=j("icon"),A(n,"class",l="icon-"+e[5].record[e[1]].player_data.equipment+" svelte-15aej55"),H(t,"background-color","var(--"+e[7][e[5].record[e[1]].player_data.equipment].type+")"),A(t,"class","svelte-15aej55")},m(l,a){x(l,t,a),b(t,n),e[15](t)},p(e,a){34&a&&l!==(l="icon-"+e[5].record[e[1]].player_data.equipment+" svelte-15aej55")&&A(n,"class",l),34&a&&H(t,"background-color","var(--"+e[7][e[5].record[e[1]].player_data.equipment].type+")")},d(n){n&&w(t),e[15](null)}}}function So(e){let t,n,l;return{c(){t=j("div"),n=j("icon"),A(n,"class",l="icon-"+e[5].record[e[1]].player_data.souvenir+" svelte-15aej55"),H(t,"background-color","var(--"+e[7][e[5].record[e[1]].player_data.souvenir].type+")"),A(t,"class","svelte-15aej55")},m(l,a){x(l,t,a),b(t,n),e[16](t)},p(e,a){34&a&&l!==(l="icon-"+e[5].record[e[1]].player_data.souvenir+" svelte-15aej55")&&A(n,"class",l),34&a&&H(t,"background-color","var(--"+e[7][e[5].record[e[1]].player_data.souvenir].type+")")},d(n){n&&w(t),e[16](null)}}}function Io(e){let t;return{c(){t=j("txt"),t.textContent="尚无游玩记录",H(t,"font-size","30px"),H(t,"font-family","remark"),H(t,"color","#555")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Ro(e,t){let n,l,a,o,r,s,i,d,u,f,m,h,p,g,y,v=t[20].name+"",k=t[20].player_data.chance.name+"",_=t[20].time+"";function $(...e){return t[19](t[22],...e)}return{key:e,first:null,c(){n=j("div"),l=j("img"),o=T(),r=j("div"),s=j("txt"),i=O(v),d=T(),u=j("txt"),f=O(k),m=O(" • "),h=O(_),p=T(),c(l.src,a="/img/role/dairi/"+t[20].player_data.role+".webp")||A(l,"src",a),A(l,"class","svelte-15aej55"),A(u,"class","time svelte-15aej55"),A(n,"class","tip svelte-15aej55"),this.first=n},m(e,t){x(e,n,t),b(n,l),b(n,o),b(n,r),b(r,s),b(s,i),b(r,d),b(r,u),b(u,f),b(u,m),b(u,h),b(n,p),g||(y=C(n,"click",$),g=!0)},p(e,n){t=e,32&n&&!c(l.src,a="/img/role/dairi/"+t[20].player_data.role+".webp")&&A(l,"src",a),32&n&&v!==(v=t[20].name+"")&&E(i,v),32&n&&k!==(k=t[20].player_data.chance.name+"")&&E(f,k),32&n&&_!==(_=t[20].time+"")&&E(h,_)},d(e){e&&w(n),g=!1,y()}}}function Bo(e){let t,n,l,o,r,s,i,c,d,u,f,m,h,p,g,y,v,k,_=[],$=new Map,O="number"==typeof e[1]&&To(e),M=0==e[5].record.length&&Io(),E=window.deepCopy(e[5].record).reverse();const q=e=>e[22];for(let t=0;t<E.length;t+=1){let n=wo(e,E,t),l=q(n);$.set(l,_[t]=Ro(l,n))}return{c(){t=j("div"),n=j("div"),l=T(),o=j("div"),r=j("div"),r.textContent="×",s=T(),O&&O.c(),i=T(),c=j("div"),M&&M.c(),d=T();for(let e=0;e<_.length;e+=1)_[e].c();u=T(),f=j("div"),m=T(),h=j("div"),h.textContent="右键回到标题界面",A(n,"class","paper_close svelte-15aej55"),H(n,"z-index","number"==typeof e[1]?1:-1),A(r,"class","event_fold svelte-15aej55"),A(o,"class","paper svelte-15aej55"),A(c,"class","records"),A(f,"class","achievements"),A(h,"class","remind svelte-15aej55"),A(t,"class","body archive svelte-15aej55")},m(a,p){x(a,t,p),b(t,n),b(t,l),b(t,o),b(o,r),b(o,s),O&&O.m(o,null),e[18](o),b(t,i),b(t,c),M&&M.m(c,null),b(c,d);for(let e=0;e<_.length;e+=1)_[e]&&_[e].m(c,null);b(t,u),b(t,f),b(t,m),b(t,h),y=!0,v||(k=[C(n,"click",e[8]),C(r,"click",e[8])],v=!0)},p(e,[t]){(!y||2&t)&&H(n,"z-index","number"==typeof e[1]?1:-1),"number"==typeof e[1]?O?(O.p(e,t),2&t&&ie(O,1)):(O=To(e),O.c(),ie(O,1),O.m(o,null)):O&&(re(),ce(O,1,1,(()=>{O=null})),se()),0==e[5].record.length?M||(M=Io(),M.c(),M.m(c,d)):M&&(M.d(1),M=null),544&t&&(E=window.deepCopy(e[5].record).reverse(),_=pe(_,t,q,1,e,E,$,c,me,Ro,null,wo))},i(e){y||(ie(O),Z((()=>{y&&(g&&g.end(1),p=ue(t,we,{duration:250}),p.start())})),y=!0)},o(e){ce(O),p&&p.invalidate(),g=fe(t,we,{duration:250}),y=!1},d(n){n&&w(t),O&&O.d(),e[18](null),M&&M.d();for(let e=0;e<_.length;e+=1)_[e].d();n&&g&&g.end(),v=!1,a(k)}}}function Po(e,t,n){let l;d(e,Ce,(e=>n(5,l=e)));let a,o,r="statistics";const s=[],i={},c={};function u(e){n(0,a.style.top=document.body.clientHeight-640+"px",a),n(1,o=e)}Object.assign(c,ln.collection),Object.assign(c,ln.equipment),Object.assign(c,ln.souvenir),K((function(){n(0,a.style.top=`${document.body.clientHeight}px`,a),n(0,a.style.transition="0.3s",a)})),D((e=>{for(let e in i)i[e]&&n(4,i[e].ontouchstart=function(t){let l=t.touches[0].pageX,a=i[e].scrollTop;n(4,i[e].ontouchmove=function(t){let o=t.touches[0].pageX;n(4,i[e].scrollTop=a+o-l,i)},i)},i)}));return[a,o,r,s,i,l,{damage_total:"造成伤害总量",damage_frequency:"造成伤害总次数",max_damage:"造成的最高伤害",hurt_total:"受到伤害总量",hurt_frequency:"受到伤害总次数",max_hurt:"受到的最高伤害",cost_total:"消耗灵力总数",punch_count:"打出手牌总数",battle_count:"战斗总次数",round_total:"回合总数",defeat_total:"击败敌人总数",max_lv:"敌人最高等级",coin_reward_total:"获得硬币总数",collection_reward_total:"获得收藏品总数"},c,function(){n(0,a.style.top=`${document.body.clientHeight}px`,a),n(1,o=null)},u,e=>n(2,r="statistics"),e=>n(2,r="card"),e=>n(2,r="item"),function(e){Y[e?"unshift":"push"]((()=>{i.card=e,n(4,i)}))},function(e,t){Y[e?"unshift":"push"]((()=>{s[t]=e,n(3,s)}))},function(e){Y[e?"unshift":"push"]((()=>{s[Object.keys(l.record[o].player_data.collection).length]=e,n(3,s)}))},function(e){Y[e?"unshift":"push"]((()=>{s[Object.keys(l.record[o].player_data.collection).length+1]=e,n(3,s)}))},function(e){Y[e?"unshift":"push"]((()=>{i.item=e,n(4,i)}))},function(e){Y[e?"unshift":"push"]((()=>{a=e,n(0,a)}))},(e,t)=>u(e)]}class No extends _e{constructor(e){super(),ke(this,e,Po,Bo,s,{})}}function Ko(t){let n;return{c(){n=j("icon"),A(n,"class","icon-menu menu svelte-te9i3z")},m(e,l){x(e,n,l),t[5](n)},p:e,d(e){e&&w(n),t[5](null)}}}function Do(e){let t,n,l,a,r,s,i,c,d,u,f,m,h,p;var g=e[4][e[2]];g&&(n=q(g,{})),a=new Pe({}),s=new Mt({}),c=new Ht({}),u=new yo({});let y="Index"!=e[2]&&Ko(e);return{c(){t=j("div"),n&&ge(n.$$.fragment),l=T(),ge(a.$$.fragment),r=T(),ge(s.$$.fragment),i=T(),ge(c.$$.fragment),d=T(),ge(u.$$.fragment),f=T(),y&&y.c(),A(t,"id","root"),A(t,"class","svelte-te9i3z")},m(g,v){x(g,t,v),n&&ye(n,t,null),b(t,l),ye(a,t,null),b(t,r),ye(s,t,null),b(t,i),ye(c,t,null),b(t,d),ye(u,t,null),b(t,f),y&&y.m(t,null),e[6](t),m=!0,h||(p=C(t,"contextmenu",(function(){o(e[3].menu)&&e[3].menu.apply(this,arguments)})),h=!0)},p(a,[o]){if(e=a,4&o&&g!==(g=e[4][e[2]])){if(n){re();const e=n;ce(e.$$.fragment,1,0,(()=>{ve(e,1)})),se()}g?(n=q(g,{}),ge(n.$$.fragment),ie(n.$$.fragment,1),ye(n,t,l)):n=null}"Index"!=e[2]?y?y.p(e,o):(y=Ko(e),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i(e){m||(n&&ie(n.$$.fragment,e),ie(a.$$.fragment,e),ie(s.$$.fragment,e),ie(c.$$.fragment,e),ie(u.$$.fragment,e),m=!0)},o(e){n&&ce(n.$$.fragment,e),ce(a.$$.fragment,e),ce(s.$$.fragment,e),ce(c.$$.fragment,e),ce(u.$$.fragment,e),m=!1},d(l){l&&w(t),n&&ve(n),ve(a),ve(s),ve(c),ve(u),y&&y.d(),e[6](null),h=!1,p()}}}function Fo(e,t,n){let l,a,o,r,s,i;d(e,He,(e=>n(7,l=e))),d(e,Ae,(e=>n(8,a=e))),d(e,Te,(e=>n(2,o=e))),d(e,ze,(e=>n(3,r=e))),d(e,Le,(e=>n(9,s=e))),d(e,Ce,(e=>n(10,i=e))),f(ze,r.data=a,r),f(ze,r.save=p,r),null==localStorage.getItem("archive")?localStorage.setItem("archive",JSON.stringify(i)):f(Ce,i=JSON.parse(localStorage.getItem("archive")),i);const c={Index:Ft,Foreword:un,Explore:Hl,Battle:La,Afflatus:ro,Reward:yo,Epilog:xo,Archive:No};window.deepCopy=e=>{if(Array.isArray(e)){let a=e;for(var t=[],n=0;n<a.length;n++)if(Array.isArray(a[n])){var l=deepCopy(a[n]);t.push(l)}else t.push(a[n]);return t}{let t=e.constructor===Array?[]:{};for(let n in e)t[n]="object"==typeof e[n]?deepCopy(e[n]):e[n];return t}},window.retain=function(e,t){if("null"===t||"undefined"===t||0===t)return parseInt(e);let n=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();n.indexOf(".")<0&&(n+=".");for(let e=n.length-n.indexOf(".");e<=t;e++)n+="0";return n},window._void=function(){},String.prototype.getByteLen=function(){let e=0;for(let t=0;t<this.length;t++)this.charCodeAt(t)<256?e+=1:e+=2;return e},String.prototype.increaseOf=function(e){this in e?e[this]++:e[this]=1},String.prototype.decreaseOf=function(e){1==e[this]?delete e[this]:e[this]--},Array.prototype.isIncludedBy=function(e){return this.filter((t=>e.includes(t))).length==this.length},Array.prototype.index=function(e){this.forEach(((t,n)=>e(n)))},Array.prototype.set=function(e){this.index((t=>this[t]=e))},Array.prototype.rd=function(){for(var e,t,n=this.length;n;e=parseInt(Math.random()*n),t=this[--n],this[n]=this[e],this[e]=t);return this},Array.prototype.sum=function(){let e=0;for(let t of this)e+=t;return e},Array.prototype.count=function(){let e={};for(let t of this)t.increaseOf(e);return e},Object.unCount=function(e){let t=[];return Object.keys(e).forEach((n=>[...Array(e[n]).keys()].forEach((e=>t.push(n))))),t},window.r=Math.random;let u,m;window.RAF=class{constructor(){this.init()}init(){this._timerIdMap={timeout:{},interval:{}}}run(e="interval",t,n=16.7){const l=Date.now;let a=l(),o=a;const r=Symbol(),s=()=>{this.setIdMap(r,e,s),o=l(),o-a>=n&&("interval"===e&&(a=l(),o=a),t(),"timeout"===e&&this.clearTimeout(r))};return this.setIdMap(r,e,s),r}setIdMap(e,t,n){const l=requestAnimationFrame(n);this._timerIdMap[t][e]=l}setTimeout(e,t){return this.run("timeout",e,t)}clearTimeout(e){cancelAnimationFrame(this._timerIdMap.timeout[e])}setInterval(e,t){return this.run("interval",e,t)}clearInterval(e){cancelAnimationFrame(this._timerIdMap.interval[e])}},Le.set({list:{},add(e,t,n){this.list[e]={handle:t,time:n,left:n,pause:!1}},clear(e){e?delete this.list[e]:this.list={}},pause(e){}}),setInterval((e=>{let t=s.list;for(let e in t)1==t[e].left?(t[e].left=t[e].time,t[e].handle()):t[e].left--}),16),window.onclick=p;let h=navigator.userAgent;function p(){"Index"!=o&&(localStorage.setItem("data",JSON.stringify(a)),localStorage.setItem("explore",JSON.stringify(l)))}return f(ze,r.mobile=h.indexOf("Android")>-1||h.indexOf("iPhone")>-1||h.indexOf("iPad")>-1||h.indexOf("iPod")>-1||h.indexOf("Symbian")>-1,r),K((function(){if(r.mobile){let e=document.body.clientWidth/700;f(ze,r.mobile=e,r),n(1,m.style.transform=`rotate(90deg)scale(${e})`,m),n(1,m.style.width=document.body.clientHeight/e+"px",m),n(1,m.style.height="700px",m),n(1,m.style.overflow="visible",m),s.add("mobile",(function(){for(let t of document.getElementsByClassName("body"))t.style.width=document.body.clientHeight/e+"px"}),5)}})),D((function(){u&&(n(0,u.onclick=r.menu,u),n(0,u.ontouchstart=r.menu,u))})),window.Admin=r,[u,m,o,r,c,function(e){Y[e?"unshift":"push"]((()=>{u=e,n(0,u)}))},function(e){Y[e?"unshift":"push"]((()=>{m=e,n(1,m)}))}]}return new class extends _e{constructor(e){super(),ke(this,e,Fo,Do,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
